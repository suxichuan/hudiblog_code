<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>FlumeåŸºç¡€å­¦ä¹ ï¼ˆä¸€ï¼‰</title>
      <link href="/posts/1e46a8be/"/>
      <url>/posts/1e46a8be/</url>
      
        <content type="html"><![CDATA[<h1 id="FlumeåŸºç¡€å­¦ä¹ ï¼ˆä¸€ï¼‰"><a href="#FlumeåŸºç¡€å­¦ä¹ ï¼ˆä¸€ï¼‰" class="headerlink" title="FlumeåŸºç¡€å­¦ä¹ ï¼ˆä¸€ï¼‰"></a>FlumeåŸºç¡€å­¦ä¹ ï¼ˆä¸€ï¼‰</h1><h1 id="ğŸ””ç¢ç¢å¿µï¼š"><a href="#ğŸ””ç¢ç¢å¿µï¼š" class="headerlink" title="ğŸ””ç¢ç¢å¿µï¼š"></a>ğŸ””ç¢ç¢å¿µï¼š</h1><p>â€‹ä¹‹å‰ä»…ä»…åœ¨æ¯•ä¸šè®¾è®¡ä¸­ç”¨åˆ°äº†è¿™ä¸ªå·¥å…·ï¼Œåšä¸ºæ•°æ®åˆ†æçš„è¡Œä¸ºæ—¥å¿—é‡‡é›†å·¥å…·ï¼Œåˆ°ç›®å‰ä¸ºæ­¢åœ¨å·¥ä½œä¸­ä¹Ÿæ²¡æœ‰ä½¿ç”¨åˆ°å’Œæ¶‰åŠåˆ°ã€‚å½“æ—¶åœ¨ä½¿ç”¨è¿™ä¸ªå·¥å…·æ—¶ï¼Œå­¦ä¹ çš„å†…å®¹çš„æ·±åº¦ç›¸å¯¹æ¥è¯´ä¹Ÿæ¯”è¾ƒæµ…è–„ã€‚åç»­ä¼šæ ¹æ®å­¦ä¹ å†…å®¹å’Œè§„åˆ’åšç›¸åº”çš„è°ƒæ•´ï¼Œå®Œå–„ç›¸å…³çš„å­¦ä¹ ç¬”è®°ã€‚æœ¬æ–‡ä¸»è¦ä»‹ç»äº†Flumeå·¥å…·çš„åŸºæœ¬é…ç½®ä½¿ç”¨ã€å„ä¸ªç»„ä»¶åœ¨å…¶ä¸­å‘æŒ¥çš„ä½œç”¨ã€å†…éƒ¨æ¶æ„ç­‰ã€‚</p><h2 id="ä¸€ã€Flumeæ¦‚è¿°ï¼š"><a href="#ä¸€ã€Flumeæ¦‚è¿°ï¼š" class="headerlink" title="ä¸€ã€Flumeæ¦‚è¿°ï¼š"></a>ä¸€ã€Flumeæ¦‚è¿°ï¼š</h2><h3 id="1ã€å®šä¹‰ï¼š"><a href="#1ã€å®šä¹‰ï¼š" class="headerlink" title="1ã€å®šä¹‰ï¼š"></a>1ã€å®šä¹‰ï¼š</h3><p>Flumeæ˜¯Clouderaæä¾›çš„ä¸€ä¸ªé«˜å¯ç”¨çš„ï¼Œé«˜å¯é çš„ï¼Œåˆ†å¸ƒå¼çš„æµ·é‡æ—¥å¿—é‡‡é›†ã€èšåˆå’Œä¼ è¾“çš„ç³»ç»Ÿã€‚FlumeåŸºäºæµå¼æ¶æ„ï¼Œçµæ´»ç®€å•ã€‚</p><h3 id="2ã€Flumeæ¶æ„"><a href="#2ã€Flumeæ¶æ„" class="headerlink" title="2ã€Flumeæ¶æ„"></a>2ã€Flumeæ¶æ„</h3><img src="https://s2.loli.net/2024/10/28/nSDZrgUNuvHshA7.jpg" style="zoom:150%;" /><ul><li><p>agentï¼š</p><ul><li>Agentæ˜¯ä¸€ä¸ªJVMè¿›ç¨‹ï¼Œå®ƒä»¥äº‹ä»¶çš„å½¢å¼å°†æ•°æ®ä»æºå¤´é€è‡³ç›®çš„ã€‚</li><li>Agentä¸»è¦æœ‰3ä¸ªéƒ¨åˆ†ç»„æˆï¼ŒSourceã€Channelã€Sinkã€‚</li></ul></li><li><p>source</p><p>Sourceæ˜¯è´Ÿè´£æ¥æ”¶æ•°æ®åˆ°Flume Agentçš„ç»„ä»¶ã€‚Sourceç»„ä»¶å¯ä»¥å¤„ç†å„ç§ç±»å‹ã€å„ç§æ ¼å¼çš„æ—¥å¿—æ•°æ®ï¼ŒåŒ…æ‹¬<strong>avro</strong>ã€thriftã€<strong>exec</strong>ã€jmsã€<strong>spooling directory</strong>ã€<strong>netcat</strong>ã€ <strong>taildir</strong> ã€sequence generatorã€syslogã€httpã€legacyã€‚</p></li><li><p>sink</p><ul><li>Sinkä¸æ–­åœ°è½®è¯¢Channelä¸­çš„äº‹ä»¶ä¸”æ‰¹é‡åœ°ç§»é™¤å®ƒä»¬ï¼Œå¹¶å°†è¿™äº›äº‹ä»¶æ‰¹é‡å†™å…¥åˆ°å­˜å‚¨æˆ–ç´¢å¼•ç³»ç»Ÿã€æˆ–è€…è¢«å‘é€åˆ°å¦ä¸€ä¸ªFlume Agentã€‚</li><li>Sinkç»„ä»¶ç›®çš„åœ°åŒ…æ‹¬<strong>hdfs</strong>ã€<strong>logger</strong>ã€<strong>avro</strong>ã€thriftã€ipcã€<strong>file</strong>ã€<strong>HBase</strong>ã€solrã€è‡ªå®šä¹‰ã€‚</li></ul></li><li><p>channel</p><ul><li>Channelæ˜¯ä½äºSourceå’ŒSinkä¹‹é—´çš„ç¼“å†²åŒºã€‚å› æ­¤ï¼ŒChannelå…è®¸Sourceå’ŒSinkè¿ä½œåœ¨ä¸åŒçš„é€Ÿç‡ä¸Šã€‚Channelæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥åŒæ—¶å¤„ç†å‡ ä¸ªSourceçš„å†™å…¥æ“ä½œå’Œå‡ ä¸ªSinkçš„è¯»å–æ“ä½œã€‚</li><li>Flumeè‡ªå¸¦ä¸¤ç§Channelï¼šMemory Channelå’ŒFile Channelã€‚</li><li>Memory Channelæ˜¯å†…å­˜ä¸­çš„é˜Ÿåˆ—ã€‚Memory Channelåœ¨ä¸éœ€è¦å…³å¿ƒæ•°æ®ä¸¢å¤±çš„æƒ…æ™¯ä¸‹é€‚ç”¨ã€‚å¦‚æœéœ€è¦å…³å¿ƒæ•°æ®ä¸¢å¤±ï¼Œé‚£ä¹ˆMemory Channelå°±ä¸åº”è¯¥ä½¿ç”¨ï¼Œå› ä¸ºç¨‹åºæ­»äº¡ã€æœºå™¨å®•æœºæˆ–è€…é‡å¯éƒ½ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚</li><li>File Channelå°†æ‰€æœ‰äº‹ä»¶å†™åˆ°ç£ç›˜ã€‚å› æ­¤åœ¨ç¨‹åºå…³é—­æˆ–æœºå™¨å®•æœºçš„æƒ…å†µä¸‹ä¸ä¼šä¸¢å¤±æ•°æ®ã€‚</li></ul></li><li><p>event</p><p>ä¼ è¾“å•å…ƒï¼ŒFlumeæ•°æ®ä¼ è¾“çš„åŸºæœ¬å•å…ƒï¼Œä»¥Eventçš„å½¢å¼å°†æ•°æ®ä»æºå¤´é€è‡³ç›®çš„åœ°ã€‚Eventç”±<strong>Header</strong>å’Œ<strong>Body</strong>ä¸¤éƒ¨åˆ†ç»„æˆï¼ŒHeaderç”¨æ¥å­˜æ”¾è¯¥eventçš„ä¸€äº›å±æ€§ï¼Œä¸ºK-Vç»“æ„ï¼ŒBodyç”¨æ¥å­˜æ”¾è¯¥æ¡æ•°æ®ï¼Œå½¢å¼ä¸ºå­—èŠ‚æ•°ç»„ã€‚</p><table><thead><tr><th>header(k,v)</th><th>body(byte array)</th></tr></thead></table></li></ul><h2 id="äºŒã€Flumeå…¥é—¨"><a href="#äºŒã€Flumeå…¥é—¨" class="headerlink" title="äºŒã€Flumeå…¥é—¨"></a>äºŒã€Flumeå…¥é—¨</h2><h3 id="1ã€å®‰è£…Flumeåœ°å€"><a href="#1ã€å®‰è£…Flumeåœ°å€" class="headerlink" title="1ã€å®‰è£…Flumeåœ°å€"></a>1ã€å®‰è£…Flumeåœ°å€</h3><ul><li>å®˜ç½‘åœ°å€ï¼š<a href="http://flume.apache.org/">http://flume.apache.org/</a></li><li>æ–‡æ¡£åœ°å€ï¼š<a href="http://flume.apache.org/FlumeUserGuide.html">http://flume.apache.org/FlumeUserGuide.html</a></li></ul><h3 id="2ã€å®‰è£…éƒ¨ç½²"><a href="#2ã€å®‰è£…éƒ¨ç½²" class="headerlink" title="2ã€å®‰è£…éƒ¨ç½²"></a>2ã€å®‰è£…éƒ¨ç½²</h3><p>hadoopç‰ˆæœ¬3.xè¦åˆ é™¤libæ–‡ä»¶å¤¹ä¸‹çš„guava-11.0.2.jaråŒ…ä»¥å…¼å®¹Hadoop 3.x</p><h3 id="3ã€å®˜æ–¹å…¥é—¨æ¡ˆä¾‹"><a href="#3ã€å®˜æ–¹å…¥é—¨æ¡ˆä¾‹" class="headerlink" title="3ã€å®˜æ–¹å…¥é—¨æ¡ˆä¾‹"></a>3ã€å®˜æ–¹å…¥é—¨æ¡ˆä¾‹</h3><ol><li><p>éœ€æ±‚ï¼šä½¿ç”¨Flumeç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œæ”¶é›†è¯¥ç«¯å£æ•°æ®ï¼Œå¹¶æ‰“å°åˆ°æ§åˆ¶å°ã€‚</p></li><li><p>å®‰è£…netcatå·¥å…·</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yun install -y nc</span><br></pre></td></tr></table></figure></li><li><p>åˆ›å»ºFlume Agenté…ç½®æ–‡ä»¶flume-netcat-logger.conf</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">æ·»åŠ å†…å®¹å¦‚ä¸‹ï¼š</span><br><span class="line"># Name the components on this agent    #a1è¡¨ç¤ºagentçš„åå­—</span><br><span class="line">a1.sources = r1  ##r1è¡¨ç¤ºa1 agentä¸€ä¸ªsourceçš„åå­—</span><br><span class="line">a1.sinks = k1    ##k1è¡¨ç¤ºa1 agentä¸€ä¸ªsinkçš„åå­—</span><br><span class="line">a1.channels = c1 ##c1è¡¨ç¤ºa1 agentä¸€ä¸ªchannelçš„åå­—</span><br><span class="line"></span><br><span class="line"># Describe/configure the source</span><br><span class="line">a1.sources.r1.type = netcat   ##è¡¨ç¤ºr1 sourceçš„ç±»å‹ä¹Ÿå°±æ˜¯è¾“å…¥æºçš„ç±»å‹</span><br><span class="line">a1.sources.r1.bind = localhost  ##è¦ç›‘å¬çš„ä¸»æœºçš„IP </span><br><span class="line">a1.sources.r1.port = 44444  ###è¦ç›‘å¬çš„ç«¯å£å·æ˜¯å¤šå°‘</span><br><span class="line"></span><br><span class="line"># Describe the sink</span><br><span class="line">a1.sinks.k1.type = logger   ##a1çš„æ•°æ®è¾“å‡ºçš„ç›®çš„åœ°æ˜¯æ§åˆ¶å°</span><br><span class="line"></span><br><span class="line"># Use a channel which buffers events in memory</span><br><span class="line">a1.channels.c1.type = memory   ##è¡¨ç¤ºa1 channelçš„ç±»å‹æ˜¯memoryå†…å­˜å‹</span><br><span class="line">a1.channels.c1.capacity = 1000 ##è¡¨ç¤ºa1 channelçš„äº‹ä»¶å®¹é‡æ˜¯1000æ¡</span><br><span class="line">a1.channels.c1.transactionCapacity = 100  ##è¡¨ç¤ºa1çš„channelæ”¶é›†åˆ°100æ¡eventåå†å»æäº¤äº‹åŠ¡</span><br><span class="line"></span><br><span class="line"># Bind the source and sink to the channel</span><br><span class="line">a1.sources.r1.channels = c1   ##è¡¨ç¤ºå§r1å’Œc1è¿æ¥èµ·æ¥</span><br><span class="line">a1.sinks.k1.channel = c1      ##è¡¨ç¤ºæŠŠk1å’Œc1è¿æ¥èµ·æ¥</span><br></pre></td></tr></table></figure></li><li><p>å¯åŠ¨flume</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/flume-ng agent --conf conf/ --name a1 --conf-file job/flume-netcat-logger.conf -Dflume.root.logger=INFO,console</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/flume-ng agent -c conf/ -n a1 -f job/flume-netcat-logger.conf -Dflume.root.logger=INFO,console</span><br></pre></td></tr></table></figure><p>å‚æ•°è¯´æ˜ï¼š</p><p>â€‹    â€“conf&#x2F;-cï¼šè¡¨ç¤ºé…ç½®æ–‡ä»¶å­˜å‚¨åœ¨conf&#x2F;ç›®å½•</p><p>â€‹    â€“name&#x2F;-nï¼šè¡¨ç¤ºç»™agentèµ·åä¸ºa1</p><p>â€‹    â€“conf-file&#x2F;-fï¼šflumeæœ¬æ¬¡å¯åŠ¨è¯»å–çš„é…ç½®æ–‡ä»¶æ˜¯åœ¨jobæ–‡ä»¶å¤¹ä¸‹çš„flume-telnet.confæ–‡ä»¶ã€‚</p><p>â€‹    -Dflume.root.logger&#x3D;INFO,console ï¼š-Dè¡¨ç¤ºflumeè¿è¡Œæ—¶åŠ¨æ€ä¿®æ”¹flume.root.loggerå‚æ•°å±æ€§å€¼ï¼Œå¹¶å°†æ§åˆ¶å°æ—¥å¿—æ‰“å°çº§åˆ«è®¾ç½®ä¸ºINFOçº§åˆ«ã€‚æ—¥å¿—çº§åˆ«åŒ…æ‹¬:logã€infoã€warnã€errorã€‚</p></li></ol><p><strong>#å®æ—¶ç›‘æ§å•ä¸ªè¿½åŠ æ–‡ä»¶æ¡ˆä¾‹</strong>ã€‚</p><ol><li><p>éœ€æ±‚è¯´æ˜ï¼šå®æ—¶ç›‘æ§Hiveæ—¥å¿—ï¼Œå¹¶ä¸Šä¼ åˆ°HDFSä¸­</p></li><li><p>é…ç½®æ–‡ä»¶ç¼–å†™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">##è‡ªå·±ç¼–å†™çš„é…ç½®</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.channels = c1</span><br><span class="line">a1.sinks=k1</span><br><span class="line"></span><br><span class="line">a1.sources.r1.type = TAILDIR</span><br><span class="line">a1.sources.r1.positionFile =/home/hdfs/flume/taildir_position.json</span><br><span class="line">a1.sources.r1.filegroups = f1</span><br><span class="line">a1.sources.r1.filegroups.f1 = /home/hdfs/flume/data/.*\.txt</span><br><span class="line"></span><br><span class="line">a1.sinks.k1.type=hdfs</span><br><span class="line">a1.sinks.k1.hdfs.path = hdfs://master:8020/flume/events/%Y-%m-%d/%H%M/%S</span><br><span class="line">a1.sinks.k1.hdfs.filePrefix = events-</span><br><span class="line">a1.sinks.k1.hdfs.round = true</span><br><span class="line">a1.sinks.k1.hdfs.roundValue = 10</span><br><span class="line">a1.sinks.k1.hdfs.roundUnit = minute</span><br><span class="line">a1.sinks.k1.hdfs.useLocalTimeStamp=true</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 10000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">a1.sinks.k1.channel = c1</span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line"></span><br><span class="line">#####################################################################################################</span><br><span class="line">#####################################################################################################</span><br><span class="line">#æ¡ˆä¾‹</span><br><span class="line"># Name the components on this agent</span><br><span class="line">a2.sources = r2</span><br><span class="line">a2.sinks = k2</span><br><span class="line">a2.channels = c2</span><br><span class="line"></span><br><span class="line"># Describe/configure the source</span><br><span class="line">a2.sources.r2.type = exec</span><br><span class="line">a2.sources.r2.command = tail -F /opt/module/hive/logs/hive.log</span><br><span class="line"></span><br><span class="line"># Describe the sink</span><br><span class="line">a2.sinks.k2.type = hdfs</span><br><span class="line">a2.sinks.k2.hdfs.path = hdfs://master:8020/flume/%Y%m%d/%H</span><br><span class="line">#ä¸Šä¼ æ–‡ä»¶çš„å‰ç¼€</span><br><span class="line">a2.sinks.k2.hdfs.filePrefix = logs-</span><br><span class="line">#æ˜¯å¦æŒ‰ç…§æ—¶é—´æ»šåŠ¨æ–‡ä»¶å¤¹</span><br><span class="line">a2.sinks.k2.hdfs.round = true</span><br><span class="line">#å¤šå°‘æ—¶é—´å•ä½åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹</span><br><span class="line">a2.sinks.k2.hdfs.roundValue = 1</span><br><span class="line">#é‡æ–°å®šä¹‰æ—¶é—´å•ä½</span><br><span class="line">a2.sinks.k2.hdfs.roundUnit = hour</span><br><span class="line">#æ˜¯å¦ä½¿ç”¨æœ¬åœ°æ—¶é—´æˆ³</span><br><span class="line">a2.sinks.k2.hdfs.useLocalTimeStamp = true</span><br><span class="line">#ç§¯æ”’å¤šå°‘ä¸ªEventæ‰flushåˆ°HDFSä¸€æ¬¡</span><br><span class="line">a2.sinks.k2.hdfs.batchSize = 100</span><br><span class="line">#è®¾ç½®æ–‡ä»¶ç±»å‹ï¼Œå¯æ”¯æŒå‹ç¼©</span><br><span class="line">a2.sinks.k2.hdfs.fileType = DataStream</span><br><span class="line">#å¤šä¹…ç”Ÿæˆä¸€ä¸ªæ–°çš„æ–‡ä»¶</span><br><span class="line">a2.sinks.k2.hdfs.rollInterval = 60</span><br><span class="line">#è®¾ç½®æ¯ä¸ªæ–‡ä»¶çš„æ»šåŠ¨å¤§å°</span><br><span class="line">a2.sinks.k2.hdfs.rollSize = 134217700</span><br><span class="line">#æ–‡ä»¶çš„æ»šåŠ¨ä¸Eventæ•°é‡æ— å…³</span><br><span class="line">a2.sinks.k2.hdfs.rollCount = 0</span><br><span class="line"></span><br><span class="line"># Use a channel which buffers events in memory</span><br><span class="line">a2.channels.c2.type = memory</span><br><span class="line">a2.channels.c2.capacity = 1000</span><br><span class="line">a2.channels.c2.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line"># Bind the source and sink to the channel</span><br><span class="line">a2.sources.r2.channels = c2</span><br><span class="line">a2.sinks.k2.channel = c2</span><br><span class="line"></span><br><span class="line">##########################################################################################################################################################################################################</span><br><span class="line">#æ¡ˆä¾‹ï¼š</span><br><span class="line">2. å…¥é—¨æ¡ˆä¾‹ 2.1  å®æ—¶ç›‘æ§å•ä¸ªè¿½åŠ æ–‡ä»¶,å°†å†…å®¹æ‰“å°åˆ°æ§åˆ¶å°</span><br><span class="line">é…ç½®æ–‡ä»¶åå­—: exec-flume-logger.conf</span><br><span class="line">##name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.channels = c1</span><br><span class="line">a1.sinks = k1</span><br><span class="line"></span><br><span class="line">##source</span><br><span class="line">a1.sources.r1.type = exec</span><br><span class="line">a1.sources.r1.command = tail -F /home/hdfs/test/data.txt</span><br><span class="line"></span><br><span class="line">##channel</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 10000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">###sink</span><br><span class="line">a1.sinks.k1.type = logger</span><br><span class="line"></span><br><span class="line">##bind</span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line">a1.sinks.k1.channel = c1 </span><br></pre></td></tr></table></figure></li></ol><p><strong>ï¼ƒå®æ—¶ç›‘æ§ç›®å½•ä¸‹å¤šä¸ªæ–°æ–‡ä»¶</strong></p><ol><li><p>æ¡ˆä¾‹éœ€æ±‚ï¼šä½¿ç”¨Flumeç›‘å¬æ•´ä¸ªç›®å½•çš„æ–‡ä»¶ï¼Œå¹¶ä¸Šä¼ è‡³HDFS</p></li><li><p>é…ç½®æ–‡ä»¶ç¼–å†™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">###æˆ‘é…ç½®å†™çš„Spooling Directory Source</span><br><span class="line">spooling-flume-hdfs.conf é…ç½®æ–‡ä»¶å¦‚ä¸‹</span><br><span class="line">#name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1</span><br><span class="line">a1.channels = c1 </span><br><span class="line">#sources</span><br><span class="line">a1.sources.r1.type = spooldir</span><br><span class="line">a1.sources.r1.spoolDir = /home/hdfs/test/spoolDir </span><br><span class="line">a1.sources.r1.fileHeader = true</span><br><span class="line">#sinks</span><br><span class="line">a1.sinks.k1.type = hdfs</span><br><span class="line">a1.sinks.k1.hdfs.path =  hdfs://master:8020/flume/events/%Y-%m-%d</span><br><span class="line">a1.sinks.k1.hdfs.filePrefix = logs-</span><br><span class="line">a1.sinks.k1.hdfs.round = true</span><br><span class="line">a1.sinks.k1.hdfs.roundValue = 10</span><br><span class="line">a1.sinks.k1.hdfs.roundUnit = second</span><br><span class="line">a1.sinks.k1.hdfs.useLocalTimeStamp = true</span><br><span class="line">##channels</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 10000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line">##bind</span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line">a1.sinks.k1.channel = c1</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">4. å…¥é—¨æ¡ˆä¾‹ 3  å®æ—¶ç›‘æ§ç›®å½•ä¸‹çš„æ–°æ–‡ä»¶,å°†å†…å®¹ä¸Šä¼ åˆ°HDFSä¸­</span><br><span class="line">é…ç½®æ–‡ä»¶åå­—: spooling-flume-hdfs.conf</span><br><span class="line"></span><br><span class="line">#Named</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.channels = c1</span><br><span class="line">a1.sinks = k1 </span><br><span class="line"></span><br><span class="line">#Source</span><br><span class="line">a1.sources.r1.type = spooldir</span><br><span class="line">a1.sources.r1.spoolDir = /opt/module/flume-1.9.0/jobs/spooling</span><br><span class="line">a1.sources.r1.fileSuffix = .COMPLETED</span><br><span class="line">a1.sources.r1.ignorePattern = .*\.tmp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#Channel</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 10000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">#Sink</span><br><span class="line">a1.sinks.k1.type = hdfs</span><br><span class="line">a1.sinks.k1.hdfs.path = hdfs://hadoop102:8020/flume/%Y%m%d/%H</span><br><span class="line">#ä¸Šä¼ æ–‡ä»¶çš„å‰ç¼€</span><br><span class="line">a1.sinks.k1.hdfs.filePrefix = logs-</span><br><span class="line">#æ˜¯å¦æŒ‰ç…§æ—¶é—´æ»šåŠ¨æ–‡ä»¶å¤¹</span><br><span class="line">a1.sinks.k1.hdfs.round = true</span><br><span class="line">#å¤šå°‘æ—¶é—´å•ä½åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹</span><br><span class="line">a1.sinks.k1.hdfs.roundValue = 1</span><br><span class="line">#é‡æ–°å®šä¹‰æ—¶é—´å•ä½</span><br><span class="line">a1.sinks.k1.hdfs.roundUnit = hour</span><br><span class="line">#æ˜¯å¦ä½¿ç”¨æœ¬åœ°æ—¶é—´æˆ³</span><br><span class="line">a1.sinks.k1.hdfs.useLocalTimeStamp = true</span><br><span class="line">#ç§¯æ”’å¤šå°‘ä¸ªEventæ‰flushåˆ°HDFSä¸€æ¬¡</span><br><span class="line">a1.sinks.k1.hdfs.batchSize = 100</span><br><span class="line">#è®¾ç½®æ–‡ä»¶ç±»å‹ï¼Œå¯æ”¯æŒå‹ç¼©</span><br><span class="line">a1.sinks.k1.hdfs.fileType = DataStream</span><br><span class="line">#å¤šä¹…ç”Ÿæˆä¸€ä¸ªæ–°çš„æ–‡ä»¶</span><br><span class="line">a1.sinks.k1.hdfs.rollInterval = 60</span><br><span class="line">#è®¾ç½®æ¯ä¸ªæ–‡ä»¶çš„æ»šåŠ¨å¤§å°</span><br><span class="line">a1.sinks.k1.hdfs.rollSize = 134217700</span><br><span class="line">#æ–‡ä»¶çš„æ»šåŠ¨ä¸Eventæ•°é‡æ— å…³</span><br><span class="line">a1.sinks.k1.hdfs.rollCount = 0</span><br><span class="line"></span><br><span class="line">#Bind</span><br><span class="line">a1.sources.r1.channels = c1 </span><br><span class="line">a1.sinks.k1.channel = c1 </span><br></pre></td></tr></table></figure></li></ol><p><strong>ï¼ƒå®æ—¶ç›‘æ§å¤šä¸ªç›®å½•ä¸‹çš„å¤šä¸ªè¿½åŠ æ–‡ä»¶</strong></p><p>Exec sourceé€‚ç”¨äºç›‘æ§ä¸€ä¸ªå®æ—¶è¿½åŠ çš„æ–‡ä»¶ï¼Œä¸èƒ½å®ç°æ–­ç‚¹ç»­ä¼ ï¼›Spooldir Sourceé€‚åˆç”¨äºåŒæ­¥æ–°æ–‡ä»¶ï¼Œä½†ä¸é€‚åˆå¯¹å®æ—¶è¿½åŠ æ—¥å¿—çš„æ–‡ä»¶è¿›è¡Œç›‘å¬å¹¶åŒæ­¥ï¼›è€ŒTaildir Sourceé€‚åˆç”¨äºç›‘å¬å¤šä¸ªå®æ—¶è¿½åŠ çš„æ–‡ä»¶ï¼Œå¹¶ä¸”èƒ½å¤Ÿå®ç°æ–­ç‚¹ç»­ä¼ ã€‚</p><blockquote><p>æ¡ˆä¾‹éœ€æ±‚:ä½¿ç”¨Flumeç›‘å¬æ•´ä¸ªç›®å½•çš„å®æ—¶è¿½åŠ æ–‡ä»¶ï¼Œå¹¶ä¸Šä¼ è‡³HDFS</p></blockquote><ul><li><p>é…ç½®æ–‡ä»¶ç¼–å†™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1</span><br><span class="line">a1.channels = c1</span><br><span class="line"></span><br><span class="line">#sources</span><br><span class="line">a1.sources.r1.type = TAILDIR</span><br><span class="line">a1.sources.r1.positionFile = /home/hdfs/flume/taildir_position.json</span><br><span class="line">a1.sources.r1.filegroups = f1 f2</span><br><span class="line">a1.sources.r1.filegroups.f1 = /home/hdfs/test/data/.*\.txt</span><br><span class="line">a1.sources.r1.filegroups.f2 = /home/hdfs/test/data/.*\.log</span><br><span class="line"></span><br><span class="line">#sinks</span><br><span class="line">a1.sinks.k1.type = hdfs</span><br><span class="line">a1.sinks.k1.hdfs.path =  hdfs://master:8020/flume/tail/%Y-%m-%d</span><br><span class="line">a1.sinks.k1.hdfs.filePrefix = tail-</span><br><span class="line">a1.sinks.k1.hdfs.round = true</span><br><span class="line">a1.sinks.k1.hdfs.roundValue = 10</span><br><span class="line">a1.sinks.k1.hdfs.roundUnit = second</span><br><span class="line">a1.sinks.k1.hdfs.useLocalTimeStamp = true</span><br><span class="line"></span><br><span class="line">##channels</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 10000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">#bind</span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line">a1.sinks.k1.channel = c1</span><br></pre></td></tr></table></figure></li></ul><h2 id="ä¸‰ã€Flumeè¿›é˜¶"><a href="#ä¸‰ã€Flumeè¿›é˜¶" class="headerlink" title="ä¸‰ã€Flumeè¿›é˜¶"></a>ä¸‰ã€Flumeè¿›é˜¶</h2><h3 id="1ã€Flumeäº‹åŠ¡"><a href="#1ã€Flumeäº‹åŠ¡" class="headerlink" title="1ã€Flumeäº‹åŠ¡"></a>1ã€Flumeäº‹åŠ¡</h3><p><img src="https://s2.loli.net/2024/10/28/mY5EwISqi26ryAW.jpg"></p><h3 id="2ã€Agentå†…éƒ¨åŸç†"><a href="#2ã€Agentå†…éƒ¨åŸç†" class="headerlink" title="2ã€Agentå†…éƒ¨åŸç†"></a>2ã€Agentå†…éƒ¨åŸç†</h3><p><img src="https://s2.loli.net/2024/10/28/R3uIcG52YTfvw9W.jpg"></p><ul><li>sourceé‡‡é›†åˆ°æ—¥å¿—æœåŠ¡å™¨æˆ–è€…æ˜¯ç«¯å£ç­‰çš„æ•°æ®æ—¶ï¼ŒæŠ¥æ•°æ®åŒ…è£…æˆevent</li><li>åœ¨æ‰¹é‡çš„æ”¾å…¥ä¸´æ—¶ç¼“å­˜putlistï¼Œå¹¶é€šè¿‡channel processorå¤„ç†äº‹ä»¶</li><li>channel processorå°†äº‹ä»¶ä¼ é€’ç»™æ‹¦æˆªå™¨é“¾ï¼Œå¯¹äº‹ä»¶è¿›è¡Œè¿‡æ»¤</li><li>å†æŠŠäº‹ä»¶è¿˜å›channel processorå¹¶å°†æ¯ä¸ªäº‹ä»¶ç»™channel selector</li><li>è¿”å›å†™å…¥äº‹ä»¶çš„channel åˆ—è¡¨</li><li>æ ¹æ®channelé€‰æ‹©å™¨çš„ç»“æœï¼Œå°†äº‹ä»¶å†™å…¥å¯¹åº”å¾—channelä¸­</li><li>doTakeå°†äº‹ä»¶æ‰¹é‡çš„å–åˆ°sink processorä¸­å†é€šè¿‡äº‹åŠ¡å†™å…¥åˆ°ç›¸åº”çš„ç›®æ ‡ä¸­</li></ul><ol><li><p>ChannelSelector</p><p>ChannelSelectorçš„ä½œç”¨å°±æ˜¯é€‰å‡ºEventå°†è¦è¢«å‘å¾€å“ªä¸ªChannelã€‚å…¶å…±æœ‰ä¸¤ç§ç±»å‹ï¼Œåˆ†åˆ«æ˜¯Replicatingï¼ˆå¤åˆ¶ï¼‰å’ŒMultiplexingï¼ˆå¤šè·¯å¤ç”¨ï¼‰ã€‚</p><p>ReplicatingSelectorä¼šå°†åŒä¸€ä¸ªEventå‘å¾€æ‰€æœ‰çš„Channelï¼ŒMultiplexingä¼šæ ¹æ®ç›¸åº”çš„åŸåˆ™ï¼Œå°†ä¸åŒçš„Eventå‘å¾€ä¸åŒçš„Channelã€‚</p></li><li><p>SinkProcessor</p><p>SinkProcessorå…±æœ‰ä¸‰ç§ç±»å‹ï¼Œåˆ†åˆ«æ˜¯DefaultSinkProcessorã€LoadBalancingSinkProcessorå’ŒFailoverSinkProcessor</p><p>DefaultSinkProcessorå¯¹åº”çš„æ˜¯å•ä¸ªçš„Sinkï¼ŒLoadBalancingSinkProcessorå’ŒFailoverSinkProcessorå¯¹åº”çš„æ˜¯Sink Groupï¼ŒLoadBalancingSinkProcessorå¯ä»¥å®ç°è´Ÿè½½å‡è¡¡çš„åŠŸèƒ½ï¼ŒFailoverSinkProcessorå¯ä»¥é”™è¯¯æ¢å¤çš„åŠŸèƒ½ã€‚</p></li></ol><h3 id="3ã€Flumeçš„æ‹“æ‰‘ç»“æ„"><a href="#3ã€Flumeçš„æ‹“æ‰‘ç»“æ„" class="headerlink" title="3ã€Flumeçš„æ‹“æ‰‘ç»“æ„"></a>3ã€Flumeçš„æ‹“æ‰‘ç»“æ„</h3><ol><li><p>ç®€å•ä¸²è”ï¼šè¿™ç§æ¨¡å¼æ˜¯å°†å¤šä¸ªflumeé¡ºåºè¿æ¥èµ·æ¥äº†ï¼Œä»æœ€åˆçš„sourceå¼€å§‹åˆ°æœ€ç»ˆsinkä¼ é€çš„ç›®çš„å­˜å‚¨ç³»ç»Ÿã€‚æ­¤æ¨¡å¼ä¸å»ºè®®æ¡¥æ¥è¿‡å¤šçš„flumeæ•°é‡ï¼Œ flumeæ•°é‡è¿‡å¤šä¸ä»…ä¼šå½±å“ä¼ è¾“é€Ÿç‡ï¼Œè€Œä¸”ä¸€æ—¦ä¼ è¾“è¿‡ç¨‹ä¸­æŸä¸ªèŠ‚ç‚¹flumeå®•æœºï¼Œä¼šå½±å“æ•´ä¸ªä¼ è¾“ç³»ç»Ÿã€‚</p><p>å³ï¼Œä¸€ä¸ªagentçš„sinkè¿æ¥å¦ä¸ªagentçš„source</p></li><li><p>å¤åˆ¶å’Œå¤šè™‘å¤ç”¨ï¼šFlumeæ”¯æŒå°†äº‹ä»¶æµå‘ä¸€ä¸ªæˆ–è€…å¤šä¸ªç›®çš„åœ°ã€‚è¿™ç§æ¨¡å¼å¯ä»¥å°†ç›¸åŒæ•°æ®å¤åˆ¶åˆ°å¤šä¸ªchannelä¸­ï¼Œæˆ–è€…å°†ä¸åŒæ•°æ®åˆ†å‘åˆ°ä¸åŒçš„channelä¸­ï¼Œsinkå¯ä»¥é€‰æ‹©ä¼ é€åˆ°ä¸åŒçš„ç›®çš„åœ°ã€‚</p></li><li><p>è´Ÿè½½å‡è¡¡å’Œæ•…éšœè½¬ç§»ï¼šFlumeæ”¯æŒä½¿ç”¨å°†å¤šä¸ªsinké€»è¾‘ä¸Šåˆ†åˆ°ä¸€ä¸ªsinkç»„ï¼Œsinkç»„é…åˆä¸åŒçš„SinkProcessorå¯ä»¥å®ç°è´Ÿè½½å‡è¡¡å’Œé”™è¯¯æ¢å¤çš„åŠŸèƒ½ã€‚</p></li><li><p>èšåˆï¼š</p><p>è¿™ç§æ¨¡å¼æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„ï¼Œä¹Ÿéå¸¸å®ç”¨ï¼Œæ—¥å¸¸webåº”ç”¨é€šå¸¸åˆ†å¸ƒåœ¨ä¸Šç™¾ä¸ªæœåŠ¡å™¨ï¼Œå¤§è€…ç”šè‡³ä¸Šåƒä¸ªã€ä¸Šä¸‡ä¸ªæœåŠ¡å™¨ã€‚äº§ç”Ÿçš„æ—¥å¿—ï¼Œå¤„ç†èµ·æ¥ä¹Ÿéå¸¸éº»çƒ¦ã€‚ç”¨flumeçš„è¿™ç§ç»„åˆæ–¹å¼èƒ½å¾ˆå¥½çš„è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæ¯å°æœåŠ¡å™¨éƒ¨ç½²ä¸€ä¸ªflumeé‡‡é›†æ—¥å¿—ï¼Œä¼ é€åˆ°ä¸€ä¸ªé›†ä¸­æ”¶é›†æ—¥å¿—çš„flumeï¼Œå†ç”±æ­¤flumeä¸Šä¼ åˆ°hdfsã€hiveã€hbaseç­‰ï¼Œè¿›è¡Œæ—¥å¿—åˆ†æã€‚</p></li></ol><h3 id="4ã€Flumeå¼€å‘æ¡ˆä¾‹"><a href="#4ã€Flumeå¼€å‘æ¡ˆä¾‹" class="headerlink" title="4ã€Flumeå¼€å‘æ¡ˆä¾‹"></a>4ã€Flumeå¼€å‘æ¡ˆä¾‹</h3><blockquote><p>æ¡ˆä¾‹éœ€æ±‚ï¼šä½¿ç”¨Flume-1ç›‘æ§æ–‡ä»¶å˜åŠ¨ï¼ŒFlume-1å°†å˜åŠ¨å†…å®¹ä¼ é€’ç»™Flume-2ï¼ŒFlume-2è´Ÿè´£å­˜å‚¨åˆ°HDFSã€‚åŒæ—¶Flume-1å°†å˜åŠ¨å†…å®¹ä¼ é€’ç»™Flume-3ï¼ŒFlume-3è´Ÿè´£è¾“å‡ºåˆ°Local FileSystemã€‚</p></blockquote><ul><li><p>é…ç½®æ–‡ä»¶ç¼–å†™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">Flume-1</span><br><span class="line">#name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1 k2</span><br><span class="line">a1.channels = c1 c2</span><br><span class="line"></span><br><span class="line">#sources</span><br><span class="line">a1.sources.r1.type = TAILDIR</span><br><span class="line">a1.sources.r1.positionFile = /home/hdfs/flume/taildir_position.json</span><br><span class="line">a1.sources.r1.filegroups = f1</span><br><span class="line">a1.sources.r1.filegroups.f1 = /home/hdfs/test/data/log.log</span><br><span class="line"></span><br><span class="line">a1.sources.r1.selector.type = replicating</span><br><span class="line"></span><br><span class="line">##sinks</span><br><span class="line">a1.sinks.k1.type = avro</span><br><span class="line">a1.sinks.k1.hostname = 192.168.157.10</span><br><span class="line">a1.sinks.k1.port = 6666</span><br><span class="line"></span><br><span class="line">a1.sinks.k2.type = avro</span><br><span class="line">a1.sinks.k2.hostname = 192.168.157.10</span><br><span class="line">a1.sinks.k2.port = 7777</span><br><span class="line"></span><br><span class="line">##channels</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 10000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">a1.channels.c2.type = memory</span><br><span class="line">a1.channels.c2.capacity = 10000</span><br><span class="line">a1.channels.c2.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">##bind</span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line">a1.sinks.k1.channel = c1</span><br><span class="line"></span><br><span class="line">a1.sources.r1.channels = c2</span><br><span class="line">a1.sinks.k2.channel = c2</span><br><span class="line"></span><br><span class="line">flume-ng agent -c $FLUME_HOME/conf -n a1 -f ~/confs/flume-01.conf -Dflume.root.logger=INFO,console</span><br><span class="line">#############################################################################################</span><br><span class="line">Flume-2</span><br><span class="line">#name</span><br><span class="line">a2.sources = r2</span><br><span class="line">a2.sinks = k2</span><br><span class="line">a2.channels = c2</span><br><span class="line"></span><br><span class="line">#sources</span><br><span class="line">a2.sources.r2.type = avro</span><br><span class="line">a2.sources.r2.bind = localhost</span><br><span class="line">a2.sources.r2.port = 6666</span><br><span class="line"></span><br><span class="line">##sinks</span><br><span class="line">a2.sinks.k2.type = hdfs</span><br><span class="line">a2.sinks.k2.hdfs.path =  hdfs://master:8020/flume/threeflume/%Y-%m-%d</span><br><span class="line">a2.sinks.k2.hdfs.filePrefix = log-</span><br><span class="line">a2.sinks.k2.hdfs.round = true</span><br><span class="line">a2.sinks.k2.hdfs.roundValue = 10</span><br><span class="line">a2.sinks.k2.hdfs.roundUnit = second</span><br><span class="line">a2.sinks.k2.hdfs.useLocalTimeStamp = true</span><br><span class="line"></span><br><span class="line">##channels</span><br><span class="line">a2.channels.c2.type = memory</span><br><span class="line">a2.channels.c2.capacity = 10000</span><br><span class="line">a2.channels.c2.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">##bind</span><br><span class="line">a2.sources.r2.channels = c2</span><br><span class="line">a2.sinks.k2.channel = c2</span><br><span class="line"></span><br><span class="line">flume-ng agent -c $FLUME_HOME/conf -n a2 -f ~/confs/flume-02.conf -Dflume.root.logger=INFO,console</span><br><span class="line">################################################################################################</span><br><span class="line">Flume-3</span><br><span class="line">#name</span><br><span class="line">a3.sources = r3</span><br><span class="line">a3.sinks = k3</span><br><span class="line">a3.channels = c3</span><br><span class="line"></span><br><span class="line">#sources</span><br><span class="line">a3.sources.r3.type = avro</span><br><span class="line">a3.sources.r3.bind = localhost</span><br><span class="line">a3.sources.r3.port = 7777</span><br><span class="line"></span><br><span class="line">##sinks</span><br><span class="line">a3.sinks.k3.type = file_roll   ##é‡‡é›†åˆ°çš„æ•°æ®æ”¾åˆ°æœ¬åœ°Stores events on the local filesystem. </span><br><span class="line">a3.sinks.k3.sink.directory = /opt/module/flume-1.9.0/jobs/fileroll</span><br><span class="line"></span><br><span class="line">##channels</span><br><span class="line">a3.channels.c3.type = memory</span><br><span class="line">a3.channels.c3.capacity = 10000</span><br><span class="line">a3.channels.c3.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">##bind</span><br><span class="line">a3.sources.r3.channels = c3</span><br><span class="line">a3.sinks.k3.channel = c3</span><br><span class="line"></span><br><span class="line">flume-ng agent -c $FLUME_HOME/conf -n a3 -f ~/confs/flume-03.conf -Dflume.root.logger=INFO,console</span><br></pre></td></tr></table></figure></li><li><p>è¾“å‡ºçš„æœ¬åœ°ç›®å½•å¿…é¡»æ˜¯å·²ç»å­˜åœ¨çš„ç›®å½•ï¼Œå¦‚æœè¯¥ç›®å½•ä¸å­˜åœ¨ï¼Œå¹¶ä¸ä¼šåˆ›å»ºæ–°çš„ç›®å½•ã€‚</p></li></ul><p><strong>#è´Ÿè½½å‡è¡¡å’Œæ•…éšœè½¬ç§»</strong></p><ul><li><h5 id="æ•…éšœè½¬ç§»ï¼šæ¡ˆä¾‹åˆ†æ"><a href="#æ•…éšœè½¬ç§»ï¼šæ¡ˆä¾‹åˆ†æ" class="headerlink" title="æ•…éšœè½¬ç§»ï¼šæ¡ˆä¾‹åˆ†æ"></a>æ•…éšœè½¬ç§»ï¼šæ¡ˆä¾‹åˆ†æ</h5></li></ul><p>ä½¿ç”¨Flume1ç›‘æ§ä¸€ä¸ªç«¯å£ï¼Œå…¶sinkç»„ä¸­çš„sinkåˆ†åˆ«å¯¹æ¥Flume2å’ŒFlume3ï¼Œé‡‡ç”¨FailoverSinkProcessorï¼Œå®ç°æ•…éšœè½¬ç§»çš„åŠŸèƒ½ã€‚</p><p><strong>ä½¿ç”¨jps -mlæŸ¥çœ‹Flumeè¿›ç¨‹ã€‚</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">flume01-failover.conf</span><br><span class="line"></span><br><span class="line">#name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinkgroups = g1</span><br><span class="line">a1.sinks = k1 k2</span><br><span class="line">a1.channels = c1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#sources</span><br><span class="line">a1.sources.r1.type = netcat</span><br><span class="line">a1.sources.r1.bind = localhost</span><br><span class="line">a1.sources.r1.port = 44444</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a1.sinkgroups.g1.processor.type = failover</span><br><span class="line">a1.sinkgroups.g1.processor.priority.k1 = 5</span><br><span class="line">a1.sinkgroups.g1.processor.priority.k2 = 10</span><br><span class="line">a1.sinkgroups.g1.processor.maxpenalty = 10000</span><br><span class="line"></span><br><span class="line">##sinks</span><br><span class="line">a1.sinks.k1.type = avro</span><br><span class="line">a1.sinks.k1.hostname = localhost</span><br><span class="line">a1.sinks.k1.port = 6666</span><br><span class="line"></span><br><span class="line">a1.sinks.k2.type = avro</span><br><span class="line">a1.sinks.k2.hostname = localhost</span><br><span class="line">a1.sinks.k2.port = 7777</span><br><span class="line"></span><br><span class="line">##channels</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 10000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">##bind</span><br><span class="line">a1.sinkgroups.g1.sinks = k1 k2</span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line">a1.sinks.k1.channel = c1</span><br><span class="line">a1.sinks.k2.channel = c1</span><br><span class="line"></span><br><span class="line">flume-ng agent -c $FLUME_HOME/conf -n a1 -f ~/confs/flume01-failover.conf -Dflume.root.logger=INFO,console</span><br><span class="line">################################################################################################</span><br><span class="line">flume02-failover.conf</span><br><span class="line">#name</span><br><span class="line">a2.sources = r2</span><br><span class="line">a2.sinks = k2</span><br><span class="line">a2.channels = c2</span><br><span class="line"></span><br><span class="line">#sources</span><br><span class="line">a2.sources.r2.type = avro</span><br><span class="line">a2.sources.r2.bind = localhost</span><br><span class="line">a2.sources.r2.port = 6666</span><br><span class="line"></span><br><span class="line">##sinks</span><br><span class="line">a2.sinks.k2.type = logger</span><br><span class="line"></span><br><span class="line">##channels</span><br><span class="line">a2.channels.c2.type = memory</span><br><span class="line">a2.channels.c2.capacity = 10000</span><br><span class="line">a2.channels.c2.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">##bind</span><br><span class="line">a2.sources.r2.channels = c2</span><br><span class="line">a2.sinks.k2.channel = c2</span><br><span class="line"></span><br><span class="line">flume-ng agent -c $FLUME_HOME/conf -n a2 -f ~/confs/flume02-failover.conf -Dflume.root.logger=INFO,console</span><br><span class="line"></span><br><span class="line">################################################################################################</span><br><span class="line"></span><br><span class="line">flume03-failover.conf</span><br><span class="line">#name</span><br><span class="line">a3.sources = r3</span><br><span class="line">a3.sinks = k3</span><br><span class="line">a3.channels = c3</span><br><span class="line"></span><br><span class="line">#sources</span><br><span class="line">a3.sources.r3.type = avro</span><br><span class="line">a3.sources.r3.bind = localhost</span><br><span class="line">a3.sources.r3.port = 7777</span><br><span class="line"></span><br><span class="line">##sinks</span><br><span class="line">a3.sinks.k3.type = logger</span><br><span class="line"></span><br><span class="line">##channels</span><br><span class="line">a3.channels.c3.type = memory</span><br><span class="line">a3.channels.c3.capacity = 10000</span><br><span class="line">a3.channels.c3.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">##bind</span><br><span class="line">a3.sources.r3.channels = c3</span><br><span class="line">a3.sinks.k3.channel = c3</span><br><span class="line"></span><br><span class="line">flume-ng agent -c $FLUME_HOME/conf -n a3 -f ~/confs/flume03-failover.conf -Dflume.root.logger=INFO,console</span><br></pre></td></tr></table></figure><ul><li>è´Ÿè½½å‡è¡¡</li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">flume01-balance.conf</span><br><span class="line"></span><br><span class="line">#name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1 k2</span><br><span class="line">a1.channels = c1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#sources</span><br><span class="line">a1.sources.r1.type = netcat</span><br><span class="line">a1.sources.r1.bind = localhost</span><br><span class="line">a1.sources.r1.port = 44444</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a1.sinkgroups.g1.processor.type = load_balance</span><br><span class="line">a1.sinkgroups.g1.processor.backoff = true</span><br><span class="line">a1.sinkgroups.g1.processor.selector = random</span><br><span class="line"></span><br><span class="line">##sinks</span><br><span class="line">a1.sinks.k1.type = avro</span><br><span class="line">a1.sinks.k1.hostname = localhost</span><br><span class="line">a1.sinks.k1.port = 6666</span><br><span class="line"></span><br><span class="line">a1.sinks.k2.type = avro</span><br><span class="line">a1.sinks.k2.hostname = localhost</span><br><span class="line">a1.sinks.k2.port = 7777</span><br><span class="line"></span><br><span class="line">##channels</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 10000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">##bind</span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line">a1.sinks.k1.channel = c1</span><br><span class="line">a1.sinks.k2.channel = c1</span><br><span class="line"></span><br><span class="line">flume-ng agent -c $FLUME_HOME/conf -n a1 -f ~/confs/flume01-balance.conf -Dflume.root.logger=INFO,console</span><br><span class="line"></span><br><span class="line">################################################################################################</span><br><span class="line"></span><br><span class="line">flume02-balance.conf</span><br><span class="line">#name</span><br><span class="line">a2.sources = r2</span><br><span class="line">a2.sinks = k2</span><br><span class="line">a2.channels = c2</span><br><span class="line"></span><br><span class="line">#sources</span><br><span class="line">a2.sources.r2.type = avro</span><br><span class="line">a2.sources.r2.bind = localhost</span><br><span class="line">a2.sources.r2.port = 6666</span><br><span class="line"></span><br><span class="line">##sinks</span><br><span class="line">a2.sinks.k2.type = logger</span><br><span class="line"></span><br><span class="line">##channels</span><br><span class="line">a2.channels.c2.type = memory</span><br><span class="line">a2.channels.c2.capacity = 10000</span><br><span class="line">a2.channels.c2.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">##bind</span><br><span class="line">a2.sources.r2.channels = c2</span><br><span class="line">a2.sinks.k2.channel = c2</span><br><span class="line"></span><br><span class="line">flume-ng agent -c $FLUME_HOME/conf -n a2 -f ~/confs/flume02-balance.conf -Dflume.root.logger=INFO,console</span><br><span class="line"></span><br><span class="line">################################################################################################</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flume03-balance.conf</span><br><span class="line">#name</span><br><span class="line">a3.sources = r3</span><br><span class="line">a3.sinks = k3</span><br><span class="line">a3.channels = c3</span><br><span class="line"></span><br><span class="line">#sources</span><br><span class="line">a3.sources.r3.type = avro</span><br><span class="line">a3.sources.r3.bind = localhost</span><br><span class="line">a3.sources.r3.port = 7777</span><br><span class="line"></span><br><span class="line">##sinks</span><br><span class="line">a3.sinks.k3.type = logger</span><br><span class="line"></span><br><span class="line">##channels</span><br><span class="line">a3.channels.c3.type = memory</span><br><span class="line">a3.channels.c3.capacity = 10000</span><br><span class="line">a3.channels.c3.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">##bind</span><br><span class="line">a3.sources.r3.channels = c3</span><br><span class="line">a3.sinks.k3.channel = c3</span><br><span class="line"></span><br><span class="line">flume-ng agent -c $FLUME_HOME/conf -n a3 -f ~/confs/flume03-balance.conf -Dflume.root.logger=INFO,console</span><br></pre></td></tr></table></figure><ul><li>èšåˆ</li></ul><blockquote><p>æ¡ˆä¾‹éœ€æ±‚ï¼šhadoop102ä¸Šçš„Flume-1ç›‘æ§æ–‡ä»¶&#x2F;opt&#x2F;module&#x2F;group.logï¼Œhadoop103ä¸Šçš„Flume-2ç›‘æ§æŸä¸€ä¸ªç«¯å£çš„æ•°æ®æµï¼ŒFlume-1ä¸Flume-2å°†æ•°æ®å‘é€ç»™hadoop104ä¸Šçš„Flume-3ï¼ŒFlume-3å°†æœ€ç»ˆæ•°æ®æ‰“å°åˆ°æ§åˆ¶å°ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">flume01-aggre.conf</span><br><span class="line"></span><br><span class="line">#name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1</span><br><span class="line">a1.channels = c1</span><br><span class="line"></span><br><span class="line">#sources</span><br><span class="line">a1.sources.r1.type = TAILDIR</span><br><span class="line">a1.sources.r1.positionFile = /home/hdfs/flume/taildir_position.json</span><br><span class="line">a1.sources.r1.filegroups = f1</span><br><span class="line">a1.sources.r1.filegroups.f1 = /home/hdfs/test/data/log.log</span><br><span class="line"></span><br><span class="line">a1.sources.r1.selector.type = replicating</span><br><span class="line"></span><br><span class="line">##sinks</span><br><span class="line">a1.sinks.k1.type = avro</span><br><span class="line">a1.sinks.k1.hostname = slave-02</span><br><span class="line">a1.sinks.k1.port = 6666</span><br><span class="line"></span><br><span class="line">##channels</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 10000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">##bind</span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line">a1.sinks.k1.channel = c1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flume-ng agent -c $FLUME_HOME/conf -n a1 -f ~/confs/flume01-aggre.conf -Dflume.root.logger=INFO,console</span><br><span class="line"></span><br><span class="line">###############################################################################################</span><br><span class="line"></span><br><span class="line">flume02-aggre.conf</span><br><span class="line"></span><br><span class="line">#name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1</span><br><span class="line">a1.channels = c1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#sources</span><br><span class="line">a1.sources.r1.type = netcat</span><br><span class="line">a1.sources.r1.bind = localhost</span><br><span class="line">a1.sources.r1.port = 44444</span><br><span class="line"></span><br><span class="line">##sinks</span><br><span class="line">a1.sinks.k1.type = avro</span><br><span class="line">a1.sinks.k1.hostname = slave-02</span><br><span class="line">a1.sinks.k1.port = 6666</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">##channels</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 10000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">##bind</span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line">a1.sinks.k1.channel = c1</span><br><span class="line"></span><br><span class="line">flume-ng agent -c $FLUME_HOME/conf -n a1 -f ~/confs/flume02-aggre.conf -Dflume.root.logger=INFO,console</span><br><span class="line"></span><br><span class="line">################################################################################################</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flume03-aggre.conf</span><br><span class="line">#name</span><br><span class="line">a2.sources = r2</span><br><span class="line">a2.sinks = k2</span><br><span class="line">a2.channels = c2</span><br><span class="line"></span><br><span class="line">#sources</span><br><span class="line">a2.sources.r2.type = avro</span><br><span class="line">a2.sources.r2.bind = slave-02  ##æ­¤å¤„ä¸èƒ½å†™localhost</span><br><span class="line">a2.sources.r2.port = 6666</span><br><span class="line"></span><br><span class="line">##sinks</span><br><span class="line">a2.sinks.k2.type = logger</span><br><span class="line"></span><br><span class="line">##channels</span><br><span class="line">a2.channels.c2.type = memory</span><br><span class="line">a2.channels.c2.capacity = 10000</span><br><span class="line">a2.channels.c2.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">##bind</span><br><span class="line">a2.sources.r2.channels = c2</span><br><span class="line">a2.sinks.k2.channel = c2</span><br><span class="line"></span><br><span class="line">flume-ng agent -c $FLUME_HOME/conf -n a2 -f ~/confs/flume03-aggre.conf -Dflume.root.logger=INFO,console</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>è‡ªå®šä¹‰interceptor</li></ul><blockquote><p>éœ€æ±‚ï¼šä½¿ç”¨Flumeé‡‡é›†æœåŠ¡å™¨æœ¬åœ°æ—¥å¿—ï¼Œéœ€è¦æŒ‰ç…§æ—¥å¿—ç±»å‹çš„ä¸åŒï¼Œå°†ä¸åŒç§ç±»çš„æ—¥å¿—å‘å¾€ä¸åŒçš„åˆ†æç³»ç»Ÿã€‚</p></blockquote><ol><li><p>æ·»åŠ mavenä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.flume<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>flume-ng-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>ç¼–å†™interceptor</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyInterceptor</span>  <span class="keyword">implements</span> <span class="title class_">Interceptor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">()</span> &#123; &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Event <span class="title function_">intercept</span><span class="params">(Event event)</span> &#123;</span><br><span class="line">        <span class="type">byte</span>[] body = event.getBody();</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(body, StandardCharsets.UTF_8);</span><br><span class="line">        <span class="keyword">if</span> (s.contains(<span class="string">&quot;#&quot;</span>) || s.contains(<span class="string">&quot;*&quot;</span>)) &#123;</span><br><span class="line">            event.getHeaders().put(<span class="string">&quot;type&quot;</span>,<span class="string">&quot;char&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (s.contains(<span class="string">&quot;1&quot;</span>))&#123;</span><br><span class="line">            event.getHeaders().put(<span class="string">&quot;type&quot;</span>,<span class="string">&quot;num&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            event.getHeaders().put(<span class="string">&quot;type&quot;</span>,<span class="string">&quot;word&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> event;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Event&gt; <span class="title function_">intercept</span><span class="params">(List&lt;Event&gt; list)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (Event event : list) &#123;</span><br><span class="line">            intercept(event);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> &#123; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">build</span> <span class="keyword">implements</span> <span class="title class_">Interceptor</span>.Builder&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Interceptor <span class="title function_">build</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyInterceptor</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(Context context)</span> &#123; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ç¼–å†™flumeé…ç½®æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line">flume01-interceptor.conf</span><br><span class="line"></span><br><span class="line">#name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1 k2 k3</span><br><span class="line">a1.channels = c1 c2 c3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#sources</span><br><span class="line">a1.sources.r1.type = netcat</span><br><span class="line">a1.sources.r1.bind = localhost</span><br><span class="line">a1.sources.r1.port = 44444</span><br><span class="line">a1.sources.r1.interceptors = i1</span><br><span class="line">a1.sources.r1.interceptors.i1.type = com.suhe.interceptor.MyInterceptor$Builder</span><br><span class="line">a1.sources.r1.selector.type = multiplexing</span><br><span class="line">a1.sources.r1.selector.header = type</span><br><span class="line">a1.sources.r1.selector.mapping.char = c1</span><br><span class="line">a1.sources.r1.selector.mapping.num = c2</span><br><span class="line">a1.sources.r1.selector.mapping.word = c3</span><br><span class="line"></span><br><span class="line">##sinks</span><br><span class="line">a1.sinks.k1.type = avro</span><br><span class="line">a1.sinks.k1.hostname = localhost</span><br><span class="line">a1.sinks.k1.port = 6666</span><br><span class="line"></span><br><span class="line">a1.sinks.k2.type = avro</span><br><span class="line">a1.sinks.k2.hostname = localhost</span><br><span class="line">a1.sinks.k2.port = 7777</span><br><span class="line"></span><br><span class="line">a1.sinks.k3.type = avro</span><br><span class="line">a1.sinks.k3.hostname = localhost</span><br><span class="line">a1.sinks.k3.port = 8888</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">##channels</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 10000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">a1.channels.c2.type = memory</span><br><span class="line">a1.channels.c2.capacity = 10000</span><br><span class="line">a1.channels.c2.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">a1.channels.c3.type = memory</span><br><span class="line">a1.channels.c3.capacity = 10000</span><br><span class="line">a1.channels.c3.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">##bind</span><br><span class="line">a1.sources.r1.channels = c1 c2 c3</span><br><span class="line">a1.sinks.k1.channel = c1</span><br><span class="line">a1.sinks.k2.channel = c2</span><br><span class="line">a1.sinks.k3.channel = c3</span><br><span class="line"></span><br><span class="line">flume-ng agent -c $FLUME_HOME/conf -n a1 -f ~/confs/flume01-interceptor.conf -Dflume.root.logger=INFO,console</span><br><span class="line">#############################################################################################</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flume02-interceptor.conf</span><br><span class="line">#name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1</span><br><span class="line">a1.channels = c1</span><br><span class="line"></span><br><span class="line">#sources</span><br><span class="line">a1.sources.r1.type = avro</span><br><span class="line">a1.sources.r1.bind = localhost</span><br><span class="line">a1.sources.r1.port = 6666</span><br><span class="line"></span><br><span class="line">##sinks</span><br><span class="line">a1.sinks.k1.type = logger</span><br><span class="line"></span><br><span class="line">##channels</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 10000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">##bind</span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line">a1.sinks.k1.channel = c1</span><br><span class="line"></span><br><span class="line">flume-ng agent -c $FLUME_HOME/conf -n a1 -f ~/confs/flume02-interceptor.conf -Dflume.root.logger=INFO,console</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#############################################################################################</span><br><span class="line"></span><br><span class="line">flume03-interceptor.conf</span><br><span class="line">#name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1</span><br><span class="line">a1.channels = c1</span><br><span class="line"></span><br><span class="line">#sources</span><br><span class="line">a1.sources.r1.type = avro</span><br><span class="line">a1.sources.r1.bind = localhost</span><br><span class="line">a1.sources.r1.port = 7777</span><br><span class="line"></span><br><span class="line">##sinks</span><br><span class="line">a1.sinks.k1.type = logger</span><br><span class="line"></span><br><span class="line">##channels</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 10000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">##bind</span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line">a1.sinks.k1.channel = c1</span><br><span class="line"></span><br><span class="line">flume-ng agent -c $FLUME_HOME/conf -n a1 -f ~/confs/flume03-interceptor.conf -Dflume.root.logger=INFO,console</span><br><span class="line"></span><br><span class="line">#############################################################################################</span><br><span class="line"></span><br><span class="line">flume04-interceptor.conf</span><br><span class="line"></span><br><span class="line">#name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1</span><br><span class="line">a1.channels = c1</span><br><span class="line"></span><br><span class="line">#sources</span><br><span class="line">a1.sources.r1.type = avro</span><br><span class="line">a1.sources.r1.bind = localhost</span><br><span class="line">a1.sources.r1.port = 8888</span><br><span class="line"></span><br><span class="line">##sinks</span><br><span class="line">a1.sinks.k1.type = logger</span><br><span class="line"></span><br><span class="line">##channels</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 10000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">##bind</span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line">a1.sinks.k1.channel = c1</span><br><span class="line"></span><br><span class="line">flume-ng agent -c $FLUME_HOME/conf -n a1 -f ~/confs/flume04-interceptor.conf -Dflume.root.logger=INFO,console</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.channels = c1</span><br><span class="line">#sources</span><br><span class="line">a1.sources.r1.type = TAILDIR</span><br><span class="line">a1.sources.r1.positionFile = /home/suxichuan/flume/taildir_position.json</span><br><span class="line">a1.sources.r1.filegroups = f1</span><br><span class="line">a1.sources.r1.filegroups.f1 = /home/suxichuan/behavior/log</span><br><span class="line">#channels</span><br><span class="line">a1.channels.channel1.type = org.apache.flume.channel.kafka.KafkaChannel</span><br><span class="line">a1.channels.channel1.kafka.bootstrap.servers = hadoop102:9092,hadoop103:9092,hadoop104:9092</span><br><span class="line">a1.channels.channel1.kafka.topic = ods_behavor_log</span><br><span class="line">a1.channels.channel1.kafka.consumer.group.id = ods_behavor_group_1</span><br></pre></td></tr></table></figure></li></ol><p>ä»¥ä¸Šå°±æ˜¯ï¼ŒFlumeåŸºç¡€å­¦ä¹ å†…å®¹ï¼Œåç»­ä¼šæ ¹æ®å­¦ä¹ çš„è§„åˆ’è°ƒæ•´ç¬”è®°æ›´æ–°çš„å†…å®¹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
          <category> æ•°æ®é‡‡é›† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
            <tag> Flume </tag>
            
            <tag> æ•°æ®é‡‡é›† </tag>
            
            <tag> åˆ†å¸ƒå¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Oracleå­¦ä¹ åŸºç¡€ç¬”è®°(ä¸€)</title>
      <link href="/posts/7b34242e/"/>
      <url>/posts/7b34242e/</url>
      
        <content type="html"><![CDATA[<h2 id="PL-SQL-developerå®‰è£…"><a href="#PL-SQL-developerå®‰è£…" class="headerlink" title="PL&#x2F;SQL developerå®‰è£…"></a>PL&#x2F;SQL developerå®‰è£…</h2><p>1ã€å®‰è£…PL&#x2F;SQL developerç¨‹åºï¼Œå®‰è£…ç›®å½•ä¸è¦å‡ºç°ä¸­æ–‡ã€‚</p><p>2ã€é…ç½®å®¢æˆ·ç«¯è·¯å¾„ï¼šç‚¹å‡»PL&#x2F;SQL developerç•Œé¢çš„Configure-&gt;Preferences-&gt;oracleé…ç½®çš„connectå±æ€§é…ç½®ã€‚ï¼Œå’Œ</p><p>æŒ‡å®šOracle Home è·¯å¾„ï¼šD:\BaiduNetdiskDownload\client\instantclient_12_1</p><p>æŒ‡å®šOCI libraryè·¯å¾„ï¼šD:\BaiduNetdiskDownload\client\instantclient_12_1\oci.dll</p><p><img src="https://s2.loli.net/2024/10/19/cpLkrysu8OPBWn3.png" alt="image-20230714112548602"></p><p>3ã€åœ¨ ORACLE çš„ä»¥ä¸‹å®‰è£…ç›®å½•ä¸­æ‰¾åˆ° tnsnames.ora æ–‡ä»¶ï¼Œæ‹·è´åˆ°æœ¬åœ°ç”µè„‘çš„ Dç›˜æ ¹ç›®å½•ã€‚æ‰“å¼€ tnsnames.ora æ–‡ä»¶ç¼–è¾‘é…ç½®oracleæ‰€åœ¨çš„æœåŠ¡å™¨IPåœ°å€ï¼Œè®¾ç½®ç¯å¢ƒå˜é‡ TNS_ADMIN ä¸º D ç›˜æ ¹ç›®å½•( tnsnames.ora æ‰€åœ¨ç›®å½• )</p><p><img src="https://s2.loli.net/2024/10/19/3moA91eZRBKpDIG.png" alt="image-20230714113841909"></p><p>4ã€ä¸­æ–‡ç¼–ç è®¾ç½®æŸ¥çœ‹æœåŠ¡å™¨ç«¯ç¼–ç  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SQL</span>:<span class="keyword">select</span> userenv(<span class="string">&#x27;language&#x27;</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure><p>æˆ‘å®é™…æŸ¥åˆ°çš„ç»“æœä¸º:AMERICAN_AMERICA.ZHS16GBK<br>5ã€é…ç½®ç¯å¢ƒå˜é‡ï¼Œè®¡ç®—æœº-&gt;å±æ€§-&gt;é«˜çº§ç³»ç»Ÿè®¾ç½®-&gt;ç¯å¢ƒå˜é‡-&gt;æ–°å»ºï¼Œè®¾ç½®å˜é‡å:NLS_LANG,å˜é‡å€¼:ç¬¬ 1 æ­¥æŸ¥åˆ°çš„å€¼ï¼Œ<br>AMERICAN_AMERICA.ZHS16GBK</p><h2 id="1ã€æ•°æ®ç±»å‹"><a href="#1ã€æ•°æ®ç±»å‹" class="headerlink" title="1ã€æ•°æ®ç±»å‹"></a>1ã€æ•°æ®ç±»å‹</h2><h4 id="number-æ•°å€¼ç±»å‹"><a href="#number-æ•°å€¼ç±»å‹" class="headerlink" title="number æ•°å€¼ç±»å‹"></a>number æ•°å€¼ç±»å‹</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">numberï¼ˆ<span class="number">5</span>ï¼‰ æœ€å¤§å€¼<span class="number">99999</span> </span><br><span class="line">number(<span class="number">5</span>,<span class="number">2</span>) æœ€å¤§å€¼<span class="number">999.99</span></span><br></pre></td></tr></table></figure><h4 id="å­—ç¬¦ä¸²ç±»å‹"><a href="#å­—ç¬¦ä¸²ç±»å‹" class="headerlink" title="å­—ç¬¦ä¸²ç±»å‹"></a>å­—ç¬¦ä¸²ç±»å‹</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">char å›ºå®šé•¿åº¦çš„å­—ç¬¦ç±»å‹ï¼Œæœ€å¤šå­˜å‚¨2000ä¸ªå­—èŠ‚</span><br><span class="line">varchar2 å¯å˜é•¿åº¦çš„å­—ç¬¦ç±»å‹ï¼Œæœ€å¤šå­˜å‚¨4000ä¸ªå­—èŠ‚</span><br><span class="line">long  å¤§æ–‡æœ¬ç±»å‹ã€‚æœ€å¤§å¯ä»¥å­˜å‚¨2ä¸ªG</span><br></pre></td></tr></table></figure><h4 id="æ—¥æœŸç±»å‹"><a href="#æ—¥æœŸç±»å‹" class="headerlink" title="æ—¥æœŸç±»å‹"></a>æ—¥æœŸç±»å‹</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sysdate æ—¥æœŸæ—¶é—´å‹ï¼Œç²¾ç¡®åˆ°ç§’</span><br><span class="line"><span class="type">timestamp</span> ç²¾ç¡®åˆ°ç§’çš„å°æ•°ç‚¹å<span class="number">9</span>ä½</span><br></pre></td></tr></table></figure><h4 id="äºŒè¿›åˆ¶ç±»å‹"><a href="#äºŒè¿›åˆ¶ç±»å‹" class="headerlink" title="äºŒè¿›åˆ¶ç±»å‹"></a>äºŒè¿›åˆ¶ç±»å‹</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">clob</span> å­˜å‚¨å­—ç¬¦,æœ€å¤§å¯ä»¥å­˜<span class="number">4</span>ä¸ªG</span><br><span class="line"><span class="type">blob</span> å­˜å‚¨å›¾åƒã€å£°éŸ³ã€è§†é¢‘ç­‰äºŒè¿›åˆ¶æ•°æ®,æœ€å¤šå¯ä»¥å­˜<span class="number">4</span>ä¸ªG</span><br></pre></td></tr></table></figure><h2 id="2ã€DDLæ“ä½œ"><a href="#2ã€DDLæ“ä½œ" class="headerlink" title="2ã€DDLæ“ä½œ"></a>2ã€DDLæ“ä½œ</h2><h4 id="ç”¨SQLPLUSè¿æ¥Oracleçš„è¿æ¥å­—ç¬¦ä¸²"><a href="#ç”¨SQLPLUSè¿æ¥Oracleçš„è¿æ¥å­—ç¬¦ä¸²" class="headerlink" title="ç”¨SQLPLUSè¿æ¥Oracleçš„è¿æ¥å­—ç¬¦ä¸²"></a>ç”¨SQLPLUSè¿æ¥Oracleçš„è¿æ¥å­—ç¬¦ä¸²</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqlplus <span class="keyword">system</span><span class="operator">/</span>local123<span class="variable">@192</span><span class="number">.168</span><span class="number">.157</span><span class="number">.129</span>:<span class="number">1521</span><span class="operator">/</span>orcl</span><br><span class="line">sqlplus    è´¦æˆ·å<span class="operator">/</span>å¯†ç @æ‰€åœ¨ä¸»æœº:ç«¯å£å·</span><br><span class="line">sqlplus <span class="keyword">system</span><span class="operator">/</span>local123 <span class="keyword">as</span> sysdba</span><br></pre></td></tr></table></figure><h4 id="åˆ›å»ºè¡¨ç©ºé—´"><a href="#åˆ›å»ºè¡¨ç©ºé—´" class="headerlink" title="åˆ›å»ºè¡¨ç©ºé—´"></a>åˆ›å»ºè¡¨ç©ºé—´</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span>space xxxx</span><br><span class="line">datafile <span class="string">&#x27;c:\xxxx.dbf&#x27;</span></span><br><span class="line">size <span class="number">100</span>m autoextend <span class="keyword">on</span> next <span class="number">10</span>m</span><br><span class="line">xxxè¡¨ç¤ºè¡¨ç©ºé—´å</span><br><span class="line">datafile è¡¨ç¤ºæ•°æ®å‚¨å­˜çš„ç‰©ç†æ–‡ä»¶å</span><br><span class="line">size ç”¨äºè®¾ç½®è¡¨çš„åˆå§‹å¤§å°</span><br><span class="line">autoextend <span class="keyword">on</span> ç”¨äºè®¾ç½®è‡ªåŠ¨å¢é•¿ï¼Œå¦‚æœå­˜å‚¨é‡è¶…è¿‡åˆå§‹å¤§å°ï¼Œåˆ™å¼€å§‹è‡ªåŠ¨æ‰©å®¹</span><br><span class="line">next ç”¨äºè®¾ç½®æ‰©å®¹çš„ç©ºé—´å¤§å°</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span>space test;</span><br><span class="line">datafile <span class="string">&#x27;c:\test.dbf&#x27;</span></span><br><span class="line">size <span class="number">100</span>m autoextend <span class="keyword">on</span> next <span class="number">10</span>m</span><br></pre></td></tr></table></figure><h4 id="åˆ›å»ºç”¨æˆ·"><a href="#åˆ›å»ºç”¨æˆ·" class="headerlink" title="åˆ›å»ºç”¨æˆ·"></a>åˆ›å»ºç”¨æˆ·</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> ç”¨æˆ·å</span><br><span class="line">identified <span class="keyword">by</span> å¯†ç </span><br><span class="line"><span class="keyword">default</span> tablespace è¡¨ç©ºé—´å</span><br></pre></td></tr></table></figure><h4 id="ç”¨æˆ·èµ‹äºˆæƒé™"><a href="#ç”¨æˆ·èµ‹äºˆæƒé™" class="headerlink" title="ç”¨æˆ·èµ‹äºˆæƒé™"></a>ç”¨æˆ·èµ‹äºˆæƒé™</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grant dba to ç”¨æˆ·å  ç»™xxxç”¨æˆ·æˆäºˆDBAæƒé™</span><br></pre></td></tr></table></figure><h4 id="è¡¨çš„åˆ›å»º"><a href="#è¡¨çš„åˆ›å»º" class="headerlink" title="è¡¨çš„åˆ›å»º"></a>è¡¨çš„åˆ›å»º</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> è¡¨åï¼ˆ</span><br><span class="line">å­—æ®µå  å­—æ®µç±»å‹[é•¿åº¦] [çº¦æŸ],</span><br><span class="line">....</span><br><span class="line">ï¼‰</span><br><span class="line">ä¾‹å¦‚</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> users(</span><br><span class="line">userid number <span class="keyword">primary</span> key,</span><br><span class="line">name varchar2(<span class="number">50</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_owners(</span><br><span class="line">id number <span class="keyword">primary</span> key,</span><br><span class="line">name varchar2(<span class="number">30</span>),</span><br><span class="line">addressid number,</span><br><span class="line">housenumber varchar2(<span class="number">30</span>),</span><br><span class="line">watermeter varchar2(<span class="number">30</span>),</span><br><span class="line">adddate <span class="type">date</span>,</span><br><span class="line">ownertypeid number</span><br><span class="line">)</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_ownertype(id number  <span class="keyword">primary</span> key,name varchar2(<span class="number">30</span>));</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_pricetable(id number <span class="keyword">primary</span> key,price number(<span class="number">10</span>,<span class="number">2</span>),ownertypeid number,minnum number(<span class="number">10</span>,<span class="number">2</span>),maxnum number(<span class="number">10</span>,<span class="number">2</span>));</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_area(id number <span class="keyword">primary</span> key,name varchar2(<span class="number">30</span>));</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_operator(id number prmary key,name varchar2(<span class="number">30</span>));</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_address(id number,name varchar2(<span class="number">30</span>),areaid number,operatorid number);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_account(id number,ownerid number,ownertypeid number,areaid number,<span class="keyword">year</span> <span class="type">char</span>(<span class="number">4</span>),<span class="keyword">month</span> <span class="type">char</span>(<span class="number">2</span>),num0 number,num1 number,usenum number,meteruserid number,meterdate <span class="type">date</span>,money number(<span class="number">10</span>,<span class="number">2</span>),isfee <span class="type">char</span>(<span class="number">1</span>),feedate <span class="type">date</span>,feeuserid number);</span><br></pre></td></tr></table></figure><h4 id="è¡¨çš„ä¿®æ”¹"><a href="#è¡¨çš„ä¿®æ”¹" class="headerlink" title="è¡¨çš„ä¿®æ”¹"></a>è¡¨çš„ä¿®æ”¹</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">desc</span> tablename æŸ¥çœ‹è¡¨çš„è¯¦æƒ…</span><br><span class="line">#<span class="number">1</span>ã€å¢åŠ å­—æ®µè¯­æ³•</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tablename <span class="keyword">add</span> ( å­—æ®µå  å­—æ®µç±»å‹ [<span class="keyword">default</span> é»˜è®¤å€¼ ],å­—æ®µå  å­—æ®µç±»å‹ [<span class="keyword">default</span> é»˜è®¤å€¼ ] );</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> t_owners <span class="keyword">add</span> ( level number <span class="keyword">default</span> <span class="number">1</span>,email varchar2(<span class="number">255</span>) );</span><br><span class="line">#<span class="number">2</span>ã€ä¿®æ”¹å­—æ®µè¯­æ³•</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tablename modify(å­—æ®µå å­—æ®µç±»å‹[<span class="keyword">default</span> é»˜è®¤å€¼],å­—æ®µå å­—æ®µç±»å‹[<span class="keyword">default</span> é»˜è®¤å€¼]);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> t_owners modify(email varchar2(<span class="number">50</span>));</span><br><span class="line">#<span class="number">3</span>ã€ä¿®æ”¹å­—æ®µå</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tablename rename <span class="keyword">column</span> åŸå­—æ®µå <span class="keyword">to</span> æ–°çš„å­—æ®µå</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> t_owners rename <span class="keyword">column</span> email <span class="keyword">to</span> mail;</span><br><span class="line">#<span class="number">4</span>ã€åˆ é™¤å­—æ®µå</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tablename <span class="keyword">drop</span> <span class="keyword">column</span> å­—æ®µåï¼›</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> t_owners <span class="keyword">drop</span> tel</span><br><span class="line">#<span class="number">5</span>ã€åˆ é™¤å¤šä¸ªå­—æ®µå</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tablename <span class="keyword">drop</span> (å­—æ®µ<span class="number">1</span>,å­—æ®µ<span class="number">2</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="æ¸…ç©ºè¡¨"><a href="#æ¸…ç©ºè¡¨" class="headerlink" title="æ¸…ç©ºè¡¨"></a>æ¸…ç©ºè¡¨</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">truncate</span> <span class="keyword">table</span> tablename; åˆ é™¤è¡¨å†é‡æ„è¡¨</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> tablename <span class="keyword">where</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span>; è¡¨ç»“æ„è¿˜åœ¨ ä¸»é”®è‡ªå¢çš„åºåˆ—ä¾ç„¶å­˜åœ¨</span><br></pre></td></tr></table></figure><h4 id="åˆ é™¤è¡¨"><a href="#åˆ é™¤è¡¨" class="headerlink" title="åˆ é™¤è¡¨"></a>åˆ é™¤è¡¨</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> tablename;</span><br></pre></td></tr></table></figure><h2 id="3ã€DMLæ“ä½œ"><a href="#3ã€DMLæ“ä½œ" class="headerlink" title="3ã€DMLæ“ä½œ"></a>3ã€DMLæ“ä½œ</h2><h4 id="insertæ“ä½œ"><a href="#insertæ“ä½œ" class="headerlink" title="insertæ“ä½œ"></a>insertæ“ä½œ</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_owners(</span><br><span class="line">id number <span class="keyword">primary</span> key,</span><br><span class="line">name varchar2(<span class="number">30</span>),</span><br><span class="line">addressid number,</span><br><span class="line">housenumber varchar2(<span class="number">30</span>),</span><br><span class="line">watermeter varchar2(<span class="number">30</span>),</span><br><span class="line">adddate <span class="type">date</span>,</span><br><span class="line">ownertypeid number</span><br><span class="line">)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> T_OWNERS <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="string">&#x27;å¼ ä¸‰ä¸°&#x27;</span>,<span class="number">1001</span>,<span class="string">&#x27;2-2&#x27;</span>,<span class="string">&#x27;5678&#x27;</span>,sysdate,<span class="number">1001</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> T_OWNERS <span class="keyword">VALUES</span> (<span class="number">2</span>,<span class="string">&#x27;è‹èµ«&#x27;</span>,<span class="number">1002</span>,<span class="string">&#x27;15-2&#x27;</span>,<span class="string">&#x27;8975&#x27;</span>,sysdate,<span class="number">1001</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> T_OWNERS <span class="keyword">VALUES</span> (<span class="number">3</span>,<span class="string">&#x27;æ¶‚å±±çº¢çº¢&#x27;</span>,<span class="number">1002</span>,<span class="string">&#x27;6-2&#x27;</span>,<span class="string">&#x27;3456&#x27;</span>,sysdate,<span class="number">1001</span>);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line">#<span class="keyword">create</span> <span class="keyword">table</span> t_ownertype(id number  <span class="keyword">primary</span> key,name varchar2(<span class="number">30</span>));</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_ownertype(id,name)<span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">&#x27;master&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_ownertype(id,name)<span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">&#x27;levelmaster&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_ownertype(id,name)<span class="keyword">values</span>(<span class="number">1003</span>,<span class="string">&#x27;supermaster&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_ownertype(id,name)<span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">&#x27;å±…æ°‘&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_ownertype(id,name)<span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">&#x27;ç‰©ä¸š&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_ownertype(id,name)<span class="keyword">values</span>(<span class="number">1003</span>,<span class="string">&#x27;æ¥å…µ&#x27;</span>);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line">#<span class="keyword">create</span> <span class="keyword">table</span> t_pricetable(id number <span class="keyword">primary</span> key,price number(<span class="number">10</span>,<span class="number">2</span>),ownertypeid number,minnum #number(<span class="number">10</span>,<span class="number">2</span>),maxnum number(<span class="number">10</span>,<span class="number">2</span>));</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_pricetable <span class="keyword">values</span>(<span class="number">3</span>,<span class="number">2.45</span>,<span class="number">1001</span>,<span class="number">0</span>,<span class="number">5</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_pricetable <span class="keyword">values</span>(<span class="number">4</span>,<span class="number">3.45</span>,<span class="number">1001</span>,<span class="number">5</span>,<span class="number">10</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_pricetable <span class="keyword">values</span>(<span class="number">5</span>,<span class="number">4.45</span>,<span class="number">1001</span>,<span class="number">10</span>,<span class="keyword">null</span>);</span><br><span class="line"><span class="keyword">commit</span></span><br><span class="line">#<span class="keyword">create</span> <span class="keyword">table</span> t_area(id number <span class="keyword">primary</span> key,name varchar2(<span class="number">30</span>));</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_area <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">&#x27;East China&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_area <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">&#x27;North China&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_area <span class="keyword">values</span>(<span class="number">1003</span>,<span class="string">&#x27;NorthEast&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_area <span class="keyword">values</span>(<span class="number">1004</span>,<span class="string">&#x27;SouthWest&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_area <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">&#x27;åŒæµåŒº&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_area <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">&#x27;æ¸©æ±ŸåŒº&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_area <span class="keyword">values</span>(<span class="number">1003</span>,<span class="string">&#x27;é’ç¾ŠåŒº&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_area <span class="keyword">values</span>(<span class="number">1004</span>,<span class="string">&#x27;é’ç™½æ±ŸåŒº&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_area <span class="keyword">values</span>(<span class="number">1005</span>,<span class="string">&#x27;æ­¦ä¾¯åŒº&#x27;</span>);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line">#<span class="keyword">create</span> <span class="keyword">table</span> t_operator(id number <span class="keyword">primary</span> key,name varchar2(<span class="number">30</span>));</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_operator <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">&#x27;mary&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_operator <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">&#x27;sueh&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_operator <span class="keyword">values</span>(<span class="number">1003</span>,<span class="string">&#x27;lili&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_operator <span class="keyword">values</span>(<span class="number">1004</span>,<span class="string">&#x27;harry&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_operator <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">&#x27;å°æ˜&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_operator <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">&#x27;å°ä½•&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_operator <span class="keyword">values</span>(<span class="number">1003</span>,<span class="string">&#x27;å°è‹&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_operator <span class="keyword">values</span>(<span class="number">1004</span>,<span class="string">&#x27;å°çº¢&#x27;</span>);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line">#<span class="keyword">create</span> <span class="keyword">table</span> t_address(id number <span class="keyword">primary</span> key,name varchar2(<span class="number">30</span>),areaid number,operatorid number);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_address <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">&#x27;quhouqu&#x27;</span>,<span class="number">1004</span>,<span class="number">1001</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_address <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">&#x27;qingyangqu&#x27;</span>,<span class="number">1004</span>,<span class="number">1002</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_address <span class="keyword">values</span>(<span class="number">1003</span>,<span class="string">&#x27;shuangliuqu&#x27;</span>,<span class="number">1004</span>,<span class="number">1003</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_address <span class="keyword">values</span>(<span class="number">1004</span>,<span class="string">&#x27;wenjiangqu&#x27;</span>,<span class="number">1004</span>,<span class="number">1004</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_address <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">&#x27;è‰é‡‘è·¯&#x27;</span>,<span class="number">1004</span>,<span class="number">1001</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_address <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">&#x27;å°šæ¥ æ¹¾&#x27;</span>,<span class="number">1004</span>,<span class="number">1002</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_address <span class="keyword">values</span>(<span class="number">1003</span>,<span class="string">&#x27;æ±Ÿå®‰æ²³å¤§æ¡¥&#x27;</span>,<span class="number">1004</span>,<span class="number">1003</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_address <span class="keyword">values</span>(<span class="number">1004</span>,<span class="string">&#x27;å´‡æ•™è·¯&#x27;</span>,<span class="number">1004</span>,<span class="number">1004</span>);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line">#<span class="keyword">create</span> <span class="keyword">table</span> t_account(id number,ownerid number,ownertypeid number,areaid number,<span class="keyword">year</span> <span class="type">char</span>(<span class="number">4</span>),<span class="keyword">month</span> #<span class="type">char</span>(<span class="number">2</span>),num0 number,num1 number,usenum number,meteruserid number,meterdate <span class="type">date</span>,money number(<span class="number">10</span>,<span class="number">2</span>),isfee #<span class="type">char</span>(<span class="number">1</span>),feedate <span class="type">date</span>,feeuserid number);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_account <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">1001</span>,<span class="number">1001</span>,<span class="number">1001</span>,<span class="number">2023</span>,<span class="number">06</span>,<span class="number">43543</span>,<span class="number">46456</span>,<span class="number">3000</span>,<span class="number">1001</span>,sysdate,<span class="number">3232</span>,<span class="number">0</span>,sysdate,<span class="number">1001</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_account <span class="keyword">values</span>(<span class="number">2</span>,<span class="number">1002</span>,<span class="number">1001</span>,<span class="number">1002</span>,<span class="number">2023</span>,<span class="number">06</span>,<span class="number">46456</span>,<span class="number">50020</span>,<span class="number">3564</span>,<span class="number">1002</span>,sysdate,<span class="number">3755</span>,<span class="number">0</span>,sysdate,<span class="number">1001</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_account <span class="keyword">values</span>(<span class="number">3</span>,<span class="number">1003</span>,<span class="number">1002</span>,<span class="number">1003</span>,<span class="number">2023</span>,<span class="number">06</span>,<span class="number">82122</span>,<span class="number">92131</span>,<span class="number">10009</span>,<span class="number">1003</span>,sysdate,<span class="number">12000</span>,<span class="number">0</span>,sysdate,<span class="number">1001</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_account <span class="keyword">values</span>(<span class="number">4</span>,<span class="number">1001</span>,<span class="number">1001</span>,<span class="number">1001</span>,<span class="number">2023</span>,<span class="number">07</span>,<span class="number">46456</span>,<span class="number">50000</span>,<span class="number">3544</span>,<span class="number">1004</span>,sysdate,<span class="number">3232</span>,<span class="number">0</span>,sysdate,<span class="number">1001</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_account <span class="keyword">values</span>(<span class="number">5</span>,<span class="number">1004</span>,<span class="number">1001</span>,<span class="number">1004</span>,<span class="number">2023</span>,<span class="number">06</span>,<span class="number">60000</span>,<span class="number">80000</span>,<span class="number">20000</span>,<span class="number">1001</span>,sysdate,<span class="number">3232</span>,<span class="number">0</span>,sysdate,<span class="number">1001</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_account <span class="keyword">values</span>(<span class="number">6</span>,<span class="number">1003</span>,<span class="number">1001</span>,<span class="number">1003</span>,<span class="number">2023</span>,<span class="number">07</span>,<span class="number">92131</span>,<span class="number">100000</span>,<span class="number">7869</span>,<span class="number">1001</span>,sysdate,<span class="number">3232</span>,<span class="number">0</span>,sysdate,<span class="number">1001</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_account <span class="keyword">values</span>(<span class="number">7</span>,<span class="number">1001</span>,<span class="number">1001</span>,<span class="number">1001</span>,<span class="number">2023</span>,<span class="number">08</span>,<span class="number">50000</span>,<span class="number">70000</span>,<span class="number">20000</span>,<span class="number">1003</span>,sysdate,<span class="number">3232</span>,<span class="number">0</span>,sysdate,<span class="number">1001</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_account <span class="keyword">values</span>(<span class="number">8</span>,<span class="number">1002</span>,<span class="number">1001</span>,<span class="number">1002</span>,<span class="number">2023</span>,<span class="number">07</span>,<span class="number">50020</span>,<span class="number">70020</span>,<span class="number">20000</span>,<span class="number">1003</span>,sysdate,<span class="number">20000</span>,<span class="number">0</span>,sysdate,<span class="number">1001</span>);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line">#å…³è”æŸ¥è¯¢</span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">  tad.id <span class="keyword">as</span> addressid,</span><br><span class="line">  tad.name <span class="keyword">as</span> addressname,</span><br><span class="line">  ta.name <span class="keyword">as</span> areaname,</span><br><span class="line">  top.name <span class="keyword">as</span> operatorname</span><br><span class="line"><span class="keyword">from</span> t_address tad,t_area ta,t_operator top</span><br><span class="line"><span class="keyword">where</span> tad.areaid<span class="operator">=</span>ta.id <span class="keyword">and</span> tad.operatorid<span class="operator">=</span>top.id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">t1.addressid,</span><br><span class="line">   t1.addressname,</span><br><span class="line">    t2.name <span class="keyword">as</span> operatoname,</span><br><span class="line">   t1.areaname</span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line">   <span class="keyword">select</span> </span><br><span class="line">   tad.id <span class="keyword">as</span> addressid,</span><br><span class="line">   tad.name <span class="keyword">as</span> addressname,</span><br><span class="line">    tad.operatorid <span class="keyword">as</span> operatorid,</span><br><span class="line">   ta.name <span class="keyword">as</span> areaname</span><br><span class="line">   <span class="keyword">from</span> t_address tad <span class="keyword">left</span>  <span class="keyword">join</span> t_area ta <span class="keyword">on</span> tad.areaid<span class="operator">=</span>ta.id</span><br><span class="line">) t1 <span class="keyword">left</span> <span class="keyword">join</span> t_operator t2 <span class="keyword">on</span> t1.operatorid<span class="operator">=</span> t2.id;</span><br></pre></td></tr></table></figure><h4 id="updateæ•°æ®ä¿®æ”¹"><a href="#updateæ•°æ®ä¿®æ”¹" class="headerlink" title="updateæ•°æ®ä¿®æ”¹"></a>updateæ•°æ®ä¿®æ”¹</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> è¡¨å <span class="keyword">set</span> å­—æ®µ<span class="operator">=</span>æ–°å€¼ï¼Œå­—æ®µ<span class="operator">=</span>æ–°å€¼ <span class="keyword">where</span> æ¡ä»¶;</span><br><span class="line"><span class="keyword">update</span> t_ownertype <span class="keyword">set</span> id<span class="operator">=</span><span class="number">1004</span>,name<span class="operator">=</span><span class="string">&#x27;level1master&#x27;</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1001</span>;</span><br><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure><h4 id="deleteåˆ é™¤æ•°æ®"><a href="#deleteåˆ é™¤æ•°æ®" class="headerlink" title="deleteåˆ é™¤æ•°æ®"></a>deleteåˆ é™¤æ•°æ®</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">delete</span> <span class="keyword">from</span> tablename <span class="keyword">where</span> æ¡ä»¶</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> t_ownertype <span class="keyword">where</span> id <span class="operator">=</span><span class="number">1004</span>;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> t_ownertype <span class="keyword">where</span> id <span class="operator">&gt;</span><span class="number">1001</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> t_ownertype <span class="keyword">where</span> id <span class="keyword">in</span> (<span class="number">1001</span>,<span class="number">1002</span>,<span class="number">1003</span>);</span><br><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„å¢åˆ æ”¹æŸ¥æ“ä½œå®Œæˆåè®°å¾—commitæäº¤äº‹åŠ¡</p></blockquote><h4 id="å¯¼å…¥å¯¼å‡º"><a href="#å¯¼å…¥å¯¼å‡º" class="headerlink" title="å¯¼å…¥å¯¼å‡º"></a>å¯¼å…¥å¯¼å‡º</h4><p>æ•°æ®çš„å¯¼å‡º</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">expdp(impdp) ç”¨æˆ·å<span class="operator">/</span>å¯†ç @è¿æ¥åœ°å€:ç«¯å£<span class="operator">/</span>æœåŠ¡å [schemas<span class="operator">|</span>owner]<span class="operator">=</span>ç”¨æˆ·å [dumpfile<span class="operator">|</span>file]<span class="operator">=</span>file1.dmp logfile<span class="operator">=</span>file1.log directory<span class="operator">=</span>testdata1 remap_schema<span class="operator">=</span>test:test;</span><br><span class="line">exp:å¯¼å‡ºå‘½ä»¤ï¼Œå¯¼å‡ºæ—¶å¿…å†™ã€‚</span><br><span class="line">imp:å¯¼å…¥å‘½ä»¤ï¼Œå¯¼å…¥æ—¶å¿…å†™,æ¯æ¬¡æ“ä½œï¼ŒäºŒè€…åªèƒ½é€‰æ‹©ä¸€ä¸ªæ‰§è¡Œã€‚</span><br><span class="line">username:å¯¼å‡ºæ•°æ®çš„ç”¨æˆ·åï¼Œå¿…å†™;</span><br><span class="line">password:å¯¼å‡ºæ•°æ®çš„å¯†ç ï¼Œå¿…å†™;</span><br><span class="line">@:åœ°å€ç¬¦å·ï¼Œå¿…å†™;</span><br><span class="line">SERVICENAME:Oracleçš„æœåŠ¡åï¼Œå¿…å†™;</span><br><span class="line"><span class="number">1521</span>:ç«¯å£å·ï¼Œ<span class="number">1521</span>æ˜¯é»˜è®¤çš„å¯ä»¥ä¸å†™,éé»˜è®¤è¦å†™;</span><br><span class="line">schemasï¼šå¯¼å‡ºæ“ä½œçš„ç”¨æˆ·å;</span><br><span class="line">dumpfileï¼šå¯¼å‡ºçš„æ–‡ä»¶;</span><br><span class="line">logfile:å¯¼å‡ºçš„æ—¥å¿—æ–‡ä»¶,å¯ä»¥ä¸å†™ï¼›</span><br><span class="line">directory: å¦‚æœæ‰‹å·¥åˆ›å»ºäº†è½¬å‚¨æ–‡ä»¶å’Œæ—¥å¿—æ–‡ä»¶ï¼Œé€šè¿‡æœ¬å‘½ä»¤æŒ‡å®šå¯¼å‡ºä½ç½®</span><br><span class="line">remap_schema<span class="operator">=</span>æºæ•°æ®åº“ç”¨æˆ·å:ç›®æ ‡æ•°æ®åº“ç”¨æˆ·å,äºŒè€…ä¸åŒæ—¶å¿…å†™ï¼Œç›¸åŒå¯ä»¥çœç•¥;</span><br><span class="line"></span><br><span class="line">#ä¾‹å¦‚</span><br><span class="line">exp <span class="keyword">system</span><span class="operator">/</span>local123 <span class="keyword">full</span><span class="operator">=</span>y æ•´ä¸ªæ•°æ®åº“å…¨éƒ¨å¯¼å‡º</span><br><span class="line">exp <span class="keyword">system</span><span class="operator">/</span>local123 <span class="keyword">full</span><span class="operator">=</span>y [dumpfile<span class="operator">|</span>file]<span class="operator">=</span>a.dmp</span><br><span class="line">exp lili<span class="operator">/</span>lili123 file<span class="operator">=</span>lili.dmp owner<span class="operator">=</span>lili;</span><br><span class="line">æŒ‰ç”¨æˆ·å¯¼å…¥</span><br><span class="line">imp lili<span class="operator">/</span>lili123 file<span class="operator">=</span>lili.dmp fromuserlili;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é€šè¿‡<span class="variable">@F</span>:\website\oraok\ot\<span class="number">11</span>g\ot_drop.sql å¯¼å…¥Fç›˜ä¸‹çš„\website\oraok\ot\<span class="number">11</span>g\ç›®å½•ä¸‹çš„ot_drop.sqlæ–‡ä»¶</span><br></pre></td></tr></table></figure><h2 id="4ã€DMLç»ƒä¹ "><a href="#4ã€DMLç»ƒä¹ " class="headerlink" title="4ã€DMLç»ƒä¹ "></a>4ã€DMLç»ƒä¹ </h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> tac.areaid,<span class="built_in">sum</span>(tac.money),ta.name <span class="keyword">from</span> t_account tac,t_area ta <span class="keyword">where</span> tac.areaid<span class="operator">=</span>ta.id <span class="keyword">group</span> <span class="keyword">by</span> tac.areaid,ta.name;</span><br></pre></td></tr></table></figure><h4 id="ç®€å•æŸ¥è¯¢"><a href="#ç®€å•æŸ¥è¯¢" class="headerlink" title="ç®€å•æŸ¥è¯¢"></a>ç®€å•æŸ¥è¯¢</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_owners;</span><br><span class="line">#ç²¾ç¡®æŸ¥è¯¢</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_owners <span class="keyword">where</span> watermeter<span class="operator">=</span><span class="number">5678</span>;</span><br><span class="line">#æ¨¡ç³ŠæŸ¥è¯¢</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_owners <span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;%å¼ %&#x27;</span>;</span><br><span class="line">#<span class="keyword">and</span>çš„è¿ç®—ç¬¦ <span class="keyword">or</span>è¿ç®—ç¬¦</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_owners <span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;å¼ %&#x27;</span> <span class="keyword">or</span> name <span class="keyword">like</span> <span class="string">&#x27;%å±±%&#x27;</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_owners <span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;_å±±__&#x27;</span> <span class="keyword">or</span> watermeter<span class="operator">&gt;</span><span class="number">5678</span>;</span><br><span class="line">#<span class="keyword">and</span>è¿ç®—ç¬¦ <span class="keyword">or</span>è¿ç®—ç¬¦æ··åˆä½¿ç”¨</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_owners <span class="keyword">where</span> (name <span class="keyword">like</span> <span class="string">&#x27;%è‹%&#x27;</span> <span class="keyword">or</span> name <span class="keyword">like</span> <span class="string">&#x27;%å±±%&#x27;</span> ) <span class="keyword">and</span> addressid <span class="operator">=</span><span class="number">1002</span>;</span><br><span class="line">#èŒƒå›´æŸ¥è¯¢</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_account <span class="keyword">where</span> num0<span class="operator">&gt;=</span><span class="number">50000</span> <span class="keyword">and</span> num0<span class="operator">&lt;=</span><span class="number">70000</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_account <span class="keyword">where</span> num0 <span class="keyword">between</span> <span class="number">50000</span> <span class="keyword">and</span> <span class="number">70000</span>;</span><br><span class="line">#ç©ºå€¼æŸ¥è¯¢</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span>  <span class="keyword">from</span> t_account isfee <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line">#æŸ¥è¯¢éç©ºå€¼</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_account isfee <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br><span class="line">#å»é‡æŸ¥è¯¢</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> addressid <span class="keyword">from</span> t_owners ; </span><br><span class="line">#æ’åº é»˜è®¤å‡åº<span class="keyword">asc</span> <span class="keyword">desc</span>é™åº</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_account <span class="keyword">order</span> <span class="keyword">by</span> usenum <span class="keyword">desc</span>;</span><br><span class="line">#åŸºäºä¼ªåˆ—çš„æŸ¥è¯¢rowid rowidæ˜¯ä¿å­˜æ•°æ®åœ¨ç£ç›˜ä¸Šçš„ç‰©ç†åœ°å€</span><br><span class="line"><span class="keyword">select</span> rowid,t.<span class="operator">*</span> <span class="keyword">from</span> t_owners t;</span><br><span class="line">#å¯ä»¥é€šè¿‡rowidæ¥æŒ‡å®šæŸ¥è¯¢çš„æŸæ¡æ•°æ®</span><br><span class="line"><span class="keyword">select</span> rowid,t.<span class="operator">*</span> <span class="keyword">from</span> t_owners t <span class="keyword">where</span> rowid<span class="operator">=</span><span class="string">&#x27;AAASNcAABAAAVJpAAD&#x27;</span>;</span><br><span class="line">#åŸºäºä¼ªåˆ—çš„æŸ¥è¯¢rownum rownumæ˜¯åŸºäºæŸ¥è¯¢å‡ºçš„ç»“æœé›†çš„åºå·</span><br><span class="line"><span class="keyword">select</span> rownum,t.<span class="operator">*</span> <span class="keyword">from</span> t_owners t;</span><br><span class="line">#èšåˆç»Ÿè®¡sum</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(usenum) <span class="keyword">from</span> t_account <span class="keyword">where</span> <span class="keyword">year</span><span class="operator">=</span><span class="string">&#x27;2023&#x27;</span>;</span><br><span class="line">#å¹³å‡å€¼</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(usenum) <span class="keyword">from</span> t_account <span class="keyword">where</span> <span class="keyword">year</span><span class="operator">=</span><span class="string">&#x27;2023&#x27;</span>;</span><br><span class="line">#æœ€å°å€¼</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(usenum) <span class="keyword">from</span> t_account <span class="keyword">where</span> <span class="keyword">year</span><span class="operator">=</span><span class="string">&#x27;2023&#x27;</span>;</span><br><span class="line">#æœ€å¤§å€¼</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(usenum) <span class="keyword">from</span> t_account <span class="keyword">where</span> <span class="keyword">year</span><span class="operator">=</span><span class="string">&#x27;2023&#x27;</span>;</span><br><span class="line">#ç»Ÿè®¡ä¸ªæ•°</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(id) <span class="keyword">from</span> t_account <span class="keyword">where</span> <span class="keyword">year</span><span class="operator">=</span><span class="string">&#x27;2023&#x27;</span>;</span><br><span class="line">#åˆ†ç»„æŸ¥è¯¢</span><br><span class="line"><span class="keyword">select</span> areaid,<span class="built_in">sum</span>(usenum) <span class="keyword">from</span> t_account <span class="keyword">group</span> <span class="keyword">by</span> areaid;</span><br><span class="line">#åˆ†ç»„ååœ¨æŒ‡å®šæ¡ä»¶çš„æŸ¥è¯¢</span><br><span class="line"><span class="keyword">select</span> areaid,<span class="built_in">sum</span>(usenum) <span class="keyword">from</span> t_account <span class="keyword">group</span> <span class="keyword">by</span> areaid <span class="keyword">having</span> <span class="built_in">sum</span>(usenum)<span class="operator">&gt;</span><span class="number">20000</span>;</span><br></pre></td></tr></table></figure><h4 id="è¿æ¥æŸ¥è¯¢"><a href="#è¿æ¥æŸ¥è¯¢" class="headerlink" title="è¿æ¥æŸ¥è¯¢"></a>è¿æ¥æŸ¥è¯¢</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#å¤šè¡¨å†…è¿æ¥</span><br><span class="line"><span class="keyword">select</span> twn.<span class="operator">*</span>,ta.name addressname <span class="keyword">from</span> t_owners twn,t_address ta <span class="keyword">where</span> twn.addressid<span class="operator">=</span>ta.id;</span><br><span class="line"></span><br><span class="line">#æŸ¥è¯¢æ˜¾ç¤ºä¸šä¸»ç¼–å·ï¼Œä¸šä¸»åç§°ã€åœ°å€å’Œä¸šä¸»ç±»å‹</span><br><span class="line"><span class="keyword">select</span> twn.id,twn.name,ta.name addressname,tt.name ownertype <span class="keyword">from</span> t_owners twn,t_ownertype tt,t_address ta <span class="keyword">where</span> twn.ownertypeid<span class="operator">=</span>tt.id <span class="keyword">and</span> twn.addressid<span class="operator">=</span>ta.id; </span><br><span class="line"></span><br><span class="line">#æŸ¥è¯¢æ˜¾ç¤ºä¸šä¸»ç¼–å·ã€ä¸šä¸»åç§°ã€åœ°å€ã€æ‰€å±åŒºåŸŸã€ä¸šä¸»åˆ†ç±»</span><br><span class="line"><span class="keyword">select</span> twn.id,twn.name,ta.name addressname,t1.name areaname,tt.name ownername <span class="keyword">from</span> t_owners twn, t_area t1,t_address ta,t_ownertype tt <span class="keyword">where</span> twn.addressid<span class="operator">=</span>ta.id <span class="keyword">and</span> twn.ownertypeid<span class="operator">=</span>tt.id <span class="keyword">and</span> ta.areaid<span class="operator">=</span>t1.id;</span><br><span class="line"></span><br><span class="line">#æŸ¥è¯¢æ˜¾ç¤ºä¸šä¸»ç¼–å·ã€ä¸šä¸»åç§°ã€åœ°å€ã€æ‰€å±åŒºåŸŸã€æ”¶è´¹å‘˜ã€ä¸šä¸»åˆ†ç±»</span><br><span class="line"><span class="keyword">select</span> twn.id,twn.name,ta.name addressname,t1.name areaname,top.name operatorname,tt.name ownertypename <span class="keyword">from</span> t_owners twn,t_address ta,t_area t1,t_operator top,t_ownertype tt</span><br><span class="line"><span class="keyword">where</span> twn.addressid<span class="operator">=</span>ta.id <span class="keyword">and</span> twn.ownertypeid<span class="operator">=</span>tt.id <span class="keyword">and</span> ta.areaid<span class="operator">=</span>t1.id <span class="keyword">and</span> ta.operatorid<span class="operator">=</span>top.id;</span><br><span class="line"></span><br><span class="line">#æŸ¥è¯¢ä¸šä¸»çš„è´¦åŠ¡è®°å½•ï¼Œæ˜¾ç¤ºä¸šä¸»ç¼–å·ã€åç§°ã€å¹´ã€æœˆã€é‡‘é¢ã€‚å¦‚æœæ­¤ä¸šä¸»æ²¡æœ‰è´¦åŠ¡è®°å½•ä¹Ÿè¦åˆ—å‡ºå§“åã€‚</span><br><span class="line"><span class="keyword">select</span> twn.id,twn.name,tacc.year,tacc.month,tacc.money <span class="keyword">from</span> t_owners twn <span class="keyword">left</span> <span class="keyword">join</span> t_account tacc <span class="keyword">on</span> twn.id<span class="operator">=</span>tacc.ownerid; </span><br><span class="line"></span><br><span class="line">#å·¦å¤–è¿æ¥</span><br><span class="line"><span class="keyword">select</span> twn.id,twn.name,tacc.year,tacc.month,tacc.money <span class="keyword">from</span> t_owners twn,t_account tacc <span class="keyword">where</span> twn.id<span class="operator">=</span>tacc.ownerid(<span class="operator">+</span>);</span><br><span class="line"></span><br><span class="line">#å³å¤–è¿æ¥</span><br><span class="line"><span class="keyword">select</span> twn.id,twn.name,tacc.year,tacc.month,tacc.money <span class="keyword">from</span> t_owners twn,t_account tacc <span class="keyword">where</span> twn.id(<span class="operator">+</span>)<span class="operator">=</span>tacc.ownerid;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="å­æŸ¥è¯¢"><a href="#å­æŸ¥è¯¢" class="headerlink" title="å­æŸ¥è¯¢"></a>å­æŸ¥è¯¢</h4><ol><li><p>whereå­å¥ä¸­çš„å­æŸ¥è¯¢</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#å•è¡Œå­æŸ¥è¯¢</span><br><span class="line">#æŸ¥è¯¢ <span class="number">2023</span> å¹´ <span class="number">6</span> æœˆç”¨æ°´é‡å¤§äºå¹³å‡å€¼çš„å°è´¦è®°å½•</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(usenum) <span class="keyword">from</span> t_account <span class="keyword">where</span> <span class="keyword">month</span><span class="operator">=</span><span class="number">6</span>;</span><br><span class="line"><span class="keyword">select</span> usenum <span class="keyword">from</span> t_account <span class="keyword">where</span> usenum<span class="operator">&gt;</span>(<span class="keyword">select</span> <span class="built_in">avg</span>(usenum) <span class="keyword">from</span> t_account <span class="keyword">where</span> <span class="keyword">month</span><span class="operator">=</span><span class="number">6</span>) <span class="keyword">and</span> <span class="keyword">month</span><span class="operator">=</span><span class="number">6</span>;</span><br><span class="line">#å¤šè¡Œå­æŸ¥è¯¢</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_address <span class="keyword">where</span> id <span class="keyword">in</span> (<span class="number">1001</span>,<span class="number">1002</span>);</span><br><span class="line">#æŸ¥è¯¢åœ°å€å«æœ‰â€œè‰â€çš„ä¸šä¸»çš„ä¿¡æ¯</span><br><span class="line"><span class="keyword">select</span> id <span class="keyword">from</span> t_address <span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;%è‰%&#x27;</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_owners <span class="keyword">where</span> addressid <span class="keyword">in</span> (<span class="keyword">select</span> id <span class="keyword">from</span> t_address <span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;%æ±Ÿå®‰æ²³%&#x27;</span>);</span><br><span class="line"></span><br><span class="line">#æŸ¥è¯¢åœ°å€ä¸å«æœ‰â€œè‰â€çš„ä¸šä¸»çš„ä¿¡æ¯</span><br><span class="line"><span class="keyword">select</span> id <span class="keyword">from</span> t_address <span class="keyword">where</span> name <span class="keyword">not</span> <span class="keyword">like</span> <span class="string">&#x27;%è‰%&#x27;</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_owners <span class="keyword">where</span> addressid <span class="keyword">in</span> (<span class="keyword">select</span> id <span class="keyword">from</span> t_address <span class="keyword">where</span> name <span class="keyword">not</span> <span class="keyword">like</span> <span class="string">&#x27;%è‰%&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_onwers <span class="keyword">where</span> addressid <span class="keyword">not</span> <span class="keyword">in</span>(<span class="keyword">select</span> id <span class="keyword">from</span> t_address <span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;%è‰%&#x27;</span>);</span><br><span class="line">#</span><br></pre></td></tr></table></figure></li><li><p>fromå­å¥ä¸­çš„å­æŸ¥è¯¢</p><p>fromå­æŸ¥è¯¢ä¸ºå¤šè¡Œå­æŸ¥è¯¢</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#æŸ¥è¯¢æ˜¾ç¤ºä¸šä¸»ç¼–å·ï¼Œä¸šä¸»åç§°ï¼Œä¸šä¸»ç±»å‹åç§°ï¼Œæ¡ä»¶ä¸ºä¸šä¸»ç±»å‹ä¸ºâ€å±…æ°‘â€ï¼Œä½¿ç”¨å­æŸ¥è¯¢å®ç°ã€‚</span><br><span class="line"><span class="keyword">select</span> id,name,ownertypename <span class="keyword">from</span> (<span class="keyword">select</span> twn.<span class="operator">*</span>,tt.name ownertypename  <span class="keyword">from</span> t_owners twn,t_ownertype tt  <span class="keyword">where</span> twn.ownertypeid<span class="operator">=</span>tt.id <span class="keyword">and</span> tt.name<span class="operator">=</span><span class="string">&#x27;å±…æ°‘&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>select å­å¥ä¸­çš„å­æŸ¥è¯¢</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#åˆ—å‡ºä¸šä¸»ä¿¡æ¯ï¼ŒåŒ…æ‹¬ IDï¼Œåç§°ï¼Œæ‰€å±åœ°å€ã€‚</span><br><span class="line"><span class="keyword">select</span> id,name,(<span class="keyword">select</span> name <span class="keyword">from</span> t_address <span class="keyword">where</span> id<span class="operator">=</span>addressid) addressname <span class="keyword">from</span> t_owners;</span><br><span class="line">#åˆ—å‡ºä¸šä¸»ä¿¡æ¯ï¼ŒåŒ…æ‹¬ IDï¼Œåç§°ï¼Œæ‰€å±åœ°å€ï¼Œæ‰€å±åŒºåŸŸ</span><br><span class="line"><span class="keyword">select</span> id,name,</span><br><span class="line">(<span class="keyword">select</span> name <span class="keyword">from</span> t_address <span class="keyword">where</span> id<span class="operator">=</span>addressid) addressname,</span><br><span class="line">(<span class="keyword">select</span> (<span class="keyword">select</span> name <span class="keyword">from</span> t_area <span class="keyword">where</span> id<span class="operator">=</span>areaid) <span class="keyword">from</span> t_address <span class="keyword">where</span> id<span class="operator">=</span>addressid) areaname</span><br><span class="line"><span class="keyword">from</span> t_owners;</span><br></pre></td></tr></table></figure></li><li><p>åˆ†é¡µæŸ¥è¯¢</p><p>ä½¿ç”¨rownumä¼ªåˆ—æ¥å®Œæˆåˆ†é¡µæŸ¥è¯¢çš„åŠŸèƒ½ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#åˆ†é¡µæŸ¥è¯¢å°è´¦è¡¨ T_ACCOUNTï¼Œæ¯é¡µ <span class="number">10</span> æ¡è®°å½•</span><br><span class="line"><span class="keyword">select</span> rownum,t.<span class="operator">*</span> <span class="keyword">from</span> t_account t <span class="keyword">where</span> rownum<span class="operator">&lt;=</span><span class="number">5</span>; </span><br><span class="line">#æŸ¥è¯¢<span class="number">5</span>åˆ°<span class="number">10</span>çš„æ•°æ®</span><br><span class="line">#å­æŸ¥è¯¢é‡Œrownumå°äºè¾ƒå¤§å€¼,å¤–é¢rownumå¤§äºè¾ƒå°å€¼</span><br><span class="line"><span class="keyword">select</span> rownum,t.<span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> rownum r,t.<span class="operator">*</span> <span class="keyword">from</span> t_account t <span class="keyword">where</span> rownum<span class="operator">&lt;=</span><span class="number">20</span>) t <span class="keyword">where</span> r<span class="operator">&lt;=</span><span class="number">5</span>;</span><br></pre></td></tr></table></figure></li></ol><h2 id="5ã€å‡½æ•°"><a href="#5ã€å‡½æ•°" class="headerlink" title="5ã€å‡½æ•°"></a>5ã€å‡½æ•°</h2><h4 id="å­—ç¬¦å‡½æ•°"><a href="#å­—ç¬¦å‡½æ•°" class="headerlink" title="å­—ç¬¦å‡½æ•°"></a>å­—ç¬¦å‡½æ•°</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ascii(<span class="string">&#x27;a&#x27;</span>) <span class="keyword">from</span> dual;ASCII() è¿”å›å­—ç¬¦çš„åè¿›åˆ¶æ•°;</span><br><span class="line"><span class="keyword">select</span> chr(<span class="number">97</span>) <span class="keyword">from</span> dual; chr() è¿”å›åè¿›åˆ¶æ•°çš„å¯¹åº”çš„å­—ç¬¦;</span><br><span class="line"><span class="keyword">select</span> concat(<span class="string">&#x27;aa&#x27;</span>,<span class="string">&#x27;bb&#x27;</span>) <span class="keyword">from</span> dual; æ‹¼æ¥ä¸¤ä¸ªå­—ç¬¦ä¸² <span class="operator">||</span> </span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;aa&#x27;</span> <span class="operator">||</span> <span class="string">&#x27;bb&#x27;</span> <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> initcap(<span class="string">&#x27;string&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> instr(<span class="string">&#x27;adbc&#x27;</span>,<span class="string">&#x27;a&#x27;</span>) <span class="keyword">from</span> dual; æ‰¾å‡ºæŸä¸ªå­—ç¬¦çš„ä½ç½®</span><br><span class="line"><span class="keyword">select</span> instrb(<span class="string">&#x27;abc&#x27;</span>,<span class="string">&#x27;a&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> length(<span class="string">&#x27;asdfgh&#x27;</span>) <span class="keyword">from</span> dual; ç»™å‡ºå­—ç¬¦ä¸²çš„é•¿åº¦</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">lower</span>(<span class="string">&#x27;HELLO&#x27;</span>) <span class="keyword">from</span> dual;å°†å­—ç¬¦è½¬åŒ–æˆå°å†™</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">upper</span>(<span class="string">&#x27;apple&#x27;</span>) <span class="keyword">from</span> dual;å°†å­—ç¬¦ä¸²è½¬åŒ–æˆå°å†™</span><br><span class="line">#å»é™¤æŒ‡å®šçš„å­—ç¬¦ä¸²</span><br><span class="line"><span class="keyword">select</span> ltrim(<span class="string">&#x27;##apple&#x27;</span>,<span class="string">&#x27;#&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> rtrim(<span class="string">&#x27;apple@@&#x27;</span>,<span class="string">&#x27;@&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">trim</span>(<span class="string">&#x27;p&#x27;</span> <span class="keyword">from</span> <span class="string">&#x27;apple&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> lpad(<span class="string">&#x27;apple&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;*&#x27;</span>) <span class="keyword">from</span> dual;åœ¨å­—ç¬¦ä¸²c1çš„å·¦è¾¹ç”¨å­—ç¬¦ä¸²c2å¡«å……ï¼Œç›´åˆ°é•¿åº¦ä¸º<span class="number">10</span>æ—¶ä¸ºæ­¢</span><br><span class="line"><span class="keyword">select</span> rpad(<span class="string">&#x27;apple&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;#&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> replace(<span class="string">&#x27;apple&#x27;</span>,<span class="string">&#x27;p&#x27;</span>,<span class="string">&#x27;bb&#x27;</span>) <span class="keyword">from</span> dual;æ›¿æ¢æŒ‡å®šçš„å­—ç¬¦ä¸²ã€‚</span><br><span class="line"><span class="keyword">select</span> substr(<span class="string">&#x27;apple&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="number">2</span>) <span class="keyword">from</span> dual;ä»ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹æˆªå–ï¼Œæˆªå–ä¸¤ä½</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="æ—¥æœŸå‡½æ•°"><a href="#æ—¥æœŸå‡½æ•°" class="headerlink" title="æ—¥æœŸå‡½æ•°"></a>æ—¥æœŸå‡½æ•°</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sysdate è¿”å›ç³»ç»Ÿå½“å‰æ—¶é—´</span><br><span class="line"><span class="keyword">select</span> sysdate <span class="keyword">from</span> dual;</span><br><span class="line">add_months ç»™ç³»ç»Ÿè¿”å›çš„æ—¶é—´åŠ ä¸€å¤©</span><br><span class="line"><span class="keyword">select</span> add_months(sysdate,<span class="number">1</span>) <span class="keyword">from</span> dual;</span><br><span class="line">last_day è¿”å›æœˆä»½çš„æœ€åä¸€å¤©</span><br><span class="line"><span class="keyword">select</span> last_day(add_months(sysdate,<span class="number">2</span>)) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> months_between(sysdate,to_date(<span class="string">&#x27;2023-04-30&#x27;</span>,<span class="string">&#x27;yyyy-MM-dd&#x27;</span>)) <span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">localtimestamp</span> <span class="keyword">from</span> dual;è¿”å›ä¼šè¯ä¸­çš„æ—¥æœŸå’Œæ—¶é—´ </span><br><span class="line"><span class="keyword">select</span> <span class="built_in">current_timestamp</span> <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> greatest(sysdate,add_months(sysdate,<span class="number">2</span>)) <span class="keyword">from</span> dual; è¿”å›ä¸¤ä¸ªæ—¶é—´ä¸­æœ€æ™šçš„ã€‚æ—¶é—´æˆ³æœ€å¤§çš„ã€‚</span><br></pre></td></tr></table></figure><h4 id="æ•°å€¼å‡½æ•°"><a href="#æ•°å€¼å‡½æ•°" class="headerlink" title="æ•°å€¼å‡½æ•°"></a>æ•°å€¼å‡½æ•°</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  <span class="built_in">abs</span>(<span class="keyword">value</span>) <span class="keyword">from</span> dual;ç»å¯¹å€¼</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">ceil</span>(<span class="keyword">value</span>) <span class="keyword">from</span> dual;å¤§äºæˆ–ç­‰äº <span class="keyword">value</span> çš„æœ€å°æ•´æ•°</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">cos</span>(<span class="keyword">value</span>) <span class="keyword">from</span> dual; ä½™å¼¦</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">cosh</span>(<span class="keyword">value</span>) <span class="keyword">from</span> dual;åä½™å¼¦</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">exp</span>(<span class="keyword">value</span>) <span class="keyword">from</span> dual;eçš„<span class="keyword">value</span>æ¬¡å¹‚</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">floor</span>(<span class="keyword">value</span>) <span class="keyword">from</span> dual;å°äºæˆ–ç­‰äº <span class="keyword">value</span> çš„æœ€å¤§æ•´æ•°</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">ln</span>(<span class="keyword">value</span>) <span class="keyword">from</span> dual;<span class="keyword">value</span> çš„è‡ªç„¶å¯¹æ•°</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">log</span>(<span class="keyword">value</span>) <span class="keyword">from</span> dual;<span class="keyword">value</span> çš„ä»¥ <span class="number">10</span> ä¸ºåº•çš„å¯¹æ•°</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">mod</span>(<span class="keyword">value</span>) <span class="keyword">from</span> dual;æ±‚æ¨¡</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">power</span>(v,p) <span class="keyword">from</span> dual;vçš„pæ¬¡å¹‚</span><br><span class="line"><span class="keyword">select</span> round(v,p) <span class="keyword">from</span> dual;æŒ‰ <span class="keyword">precision</span> ç²¾åº¦<span class="number">4</span>èˆ<span class="number">5</span>å…¥</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sin</span>(<span class="keyword">value</span>) <span class="keyword">from</span> dual;<span class="keyword">value</span>çš„æ­£å¼¦</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sinh</span>(<span class="keyword">value</span>) <span class="keyword">from</span> dual;<span class="keyword">value</span>çš„åæ­£å¼¦</span><br><span class="line"><span class="keyword">select</span> sign(<span class="keyword">value</span>) <span class="keyword">from</span> dual;<span class="keyword">value</span> ä¸ºæ­£è¿”å› <span class="number">1</span>;ä¸ºè´Ÿè¿”å›<span class="number">-1</span>;ä¸º <span class="number">0</span> è¿”å› <span class="number">0.</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">tan</span>(<span class="keyword">value</span>) <span class="keyword">from</span> dual;<span class="keyword">value</span>çš„æ­£åˆ‡</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">tanh</span>(<span class="keyword">value</span>) <span class="keyword">from</span> dual;<span class="keyword">value</span>çš„åæ­£åˆ‡</span><br><span class="line"><span class="keyword">select</span> vsize(<span class="keyword">value</span>) <span class="keyword">from</span> dual;è¿”å›<span class="keyword">value</span>åœ¨ORACLEçš„å­˜å‚¨ç©ºé—´å¤§å°</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sqrt</span>(<span class="keyword">value</span>) <span class="keyword">from</span> dual;<span class="keyword">value</span>çš„å¹³æ–¹æ ¹</span><br></pre></td></tr></table></figure><h2 id="6ã€è¡¨ç©ºé—´å·¡æ£€"><a href="#6ã€è¡¨ç©ºé—´å·¡æ£€" class="headerlink" title="6ã€è¡¨ç©ºé—´å·¡æ£€"></a>6ã€è¡¨ç©ºé—´å·¡æ£€</h2><h4 id="æŸ¥è¯¢è§†å›¾dba-data-files"><a href="#æŸ¥è¯¢è§†å›¾dba-data-files" class="headerlink" title="æŸ¥è¯¢è§†å›¾dba_data_files"></a>æŸ¥è¯¢è§†å›¾dba_data_files</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">file_name:è¡¨ç©ºé—´æ•°æ®æ–‡ä»¶çš„ä½ç½®</span><br><span class="line">file_id:æ•°æ®æ–‡ä»¶çš„ID</span><br><span class="line">tablespace_nameï¼šè¡¨ç©ºé—´åç§°</span><br><span class="line">bytes:è¡¨ç©ºé—´å¤§å° å­—èŠ‚æ˜¾ç¤º</span><br><span class="line">blocks:è¡¨ç¤ºæ•°æ®å—æ•°é‡</span><br><span class="line">status:è¡¨ç¤ºå½“å‰æ–‡ä»¶æ˜¯å¦å¯ç”¨</span><br><span class="line">relative_fno:ç›¸å¯¹æ–‡ä»¶å·</span><br><span class="line">autoextensible:æ˜¯å¦è‡ªåŠ¨æ‰©å±•</span><br><span class="line">maxbytes:å¦‚æœæ‰©å±•ï¼Œæœ€å¤§æ‰©å±•çš„å¤§å°</span><br><span class="line">maxblocksï¼šå¦‚æœæ‰©å±•ï¼Œæœ€å¤§çš„æ•°æ®å—æ•°</span><br><span class="line">increment_byï¼šæœ€å¤§å¢åŠ çš„æ•°æ®å—æ•°</span><br><span class="line">user_bytes:æ–‡ä»¶ä¸­å®é™…æœ‰ç”¨çš„å­—èŠ‚æ•°</span><br><span class="line">user_blocks:æ–‡ä»¶ä¸­å®é™…æœ‰ç”¨çš„æ•°æ®å—æ•°</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> file_name,tablespace_name,bytes<span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span> <span class="keyword">from</span> dba_data_files;</span><br><span class="line"><span class="keyword">select</span> file_name,tablespace_name,<span class="built_in">sum</span>(bytes)<span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span> <span class="keyword">from</span> dba_data_files <span class="keyword">group</span> <span class="keyword">by</span> file_name,tablespace_name;</span><br><span class="line"></span><br><span class="line">#æŸ¥çœ‹è¡¨ç©ºé—´æ€»å®¹é‡å’Œå‰©ä½™å®¹é‡å’Œä½¿ç”¨é‡ã€‚</span><br><span class="line"><span class="keyword">select</span> df.tablespace_name,<span class="built_in">SUM</span>(df.bytes)<span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span> total,<span class="built_in">SUM</span>(fs.bytes)<span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span> <span class="keyword">free</span>,<span class="built_in">SUM</span>(df.bytes<span class="operator">-</span>fs.bytes)<span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span> used <span class="keyword">from</span> dba_data_files df,dba_free_space fs</span><br><span class="line"><span class="keyword">where</span> df.tablespace_name <span class="operator">=</span> fs.tablespace_name</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> df.tablespace_name <span class="keyword">having</span> df.tablespace_name<span class="operator">=</span><span class="string">&#x27;WATERBOSS&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="æŸ¥è¯¢è§†å›¾dba-free-space"><a href="#æŸ¥è¯¢è§†å›¾dba-free-space" class="headerlink" title="æŸ¥è¯¢è§†å›¾dba_free_space"></a>æŸ¥è¯¢è§†å›¾dba_free_space</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tablespace_name:è¡¨ç©ºé—´åç§°</span><br><span class="line">file_idï¼šè¡¨ç©ºé—´ID</span><br><span class="line">block_id:å¼€å§‹å—çš„ID</span><br><span class="line">bytes:è¡¨ç¤ºç©ºé—²çš„å­—èŠ‚æ•°</span><br><span class="line">blocks:è¡¨ç¤ºç©ºé—²çš„æ•°æ®å—æ•°</span><br><span class="line">relative_fno:ç›¸å¯¹æ–‡ä»¶çš„id</span><br><span class="line">#æŸ¥çœ‹è¡¨ç©ºé—´æ€»å®¹é‡å’Œå‰©ä½™å®¹é‡å’Œä½¿ç”¨é‡ã€‚</span><br><span class="line"><span class="keyword">select</span> ds.tablespace_name,<span class="built_in">sum</span>(ds.bytes)<span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span> total,<span class="built_in">sum</span>(fs.bytes)<span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span> <span class="keyword">free</span>,<span class="built_in">sum</span>(ds.bytes)<span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span><span class="operator">-</span><span class="built_in">sum</span>(fs.bytes)<span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span> used <span class="keyword">from</span> dba_data_files ds,dba_free_space fs <span class="keyword">where</span> ds.tablespace_name<span class="operator">=</span>fs.tablespace_name <span class="keyword">group</span> <span class="keyword">by</span> ds.tablespace_name;</span><br></pre></td></tr></table></figure><h2 id="7ã€è§†å›¾"><a href="#7ã€è§†å›¾" class="headerlink" title="7ã€è§†å›¾"></a>7ã€è§†å›¾</h2><p>æ¦‚å¿µï¼šè§†å›¾æ˜¯ä¸€ç§æ•°æ®åº“å¯¹è±¡ï¼Œæ˜¯ä»ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ•°æ®è¡¨æˆ–è§†å›¾ä¸­å¯¼å‡ºçš„è™šè¡¨ï¼Œè§†å›¾æ‰€å¯¹åº”çš„æ•°æ®å¹¶ä¸çœŸæ­£åœ°å­˜å‚¨åœ¨è§†å›¾ä¸­ï¼Œè€Œæ˜¯å­˜å‚¨åœ¨æ‰€å¼•ç”¨çš„æ•°æ®è¡¨ä¸­ï¼Œè§†å›¾çš„ç»“æ„å’Œæ•°æ®æ˜¯å¯¹æ•°æ®è¡¨è¿›è¡ŒæŸ¥è¯¢çš„ç»“æœã€‚</p><p>ä¼˜ç‚¹ï¼š</p><ul><li>ç®€åŒ–æ•°æ®æ“ä½œï¼šè§†å›¾å¯ä»¥ç®€åŒ–ç”¨æˆ·å¤„ç†æ•°æ®çš„æ–¹å¼ã€‚</li><li>ç€é‡äºç‰¹å®šæ•°æ®ï¼šä¸å¿…è¦çš„æ•°æ®æˆ–æ•æ„Ÿæ•°æ®å¯ä»¥ä¸å‡ºç°åœ¨è§†å›¾ä¸­ã€‚</li><li>è§†å›¾æä¾›äº†ä¸€ä¸ªç®€å•è€Œæœ‰æ•ˆçš„å®‰å…¨æœºåˆ¶ï¼Œå¯ä»¥å®šåˆ¶ä¸åŒç”¨æˆ·å¯¹æ•°æ®çš„è®¿é—®æƒé™ã€‚</li><li>æä¾›å‘åå…¼å®¹æ€§ï¼šè§†å›¾ä½¿ç”¨æˆ·èƒ½å¤Ÿåœ¨è¡¨çš„æ¶æ„æ›´æ”¹æ—¶ä¸ºè¡¨åˆ›å»ºå‘åå…¼å®¹æ¥å£ã€‚</li></ul><h4 id="åˆ›å»ºå’Œä¿®æ”¹è§†å›¾"><a href="#åˆ›å»ºå’Œä¿®æ”¹è§†å›¾" class="headerlink" title="åˆ›å»ºå’Œä¿®æ”¹è§†å›¾"></a>åˆ›å»ºå’Œä¿®æ”¹è§†å›¾</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> [<span class="keyword">or</span> replace] [force] <span class="keyword">view</span> view_name</span><br><span class="line"><span class="keyword">as</span> subquery</span><br><span class="line">[<span class="keyword">with</span> <span class="keyword">check</span> option]</span><br><span class="line">[<span class="keyword">with</span> read <span class="keyword">only</span>]</span><br><span class="line"></span><br><span class="line">[<span class="keyword">or</span> replace]:è‹¥å·²ç»å­˜åœ¨è¯¥è§†å›¾ï¼Œoracleè‡ªåŠ¨é‡æ„è¯¥è§†å›¾</span><br><span class="line">[force]:ä¸ç®¡åŸºè¡¨æ˜¯å¦å­˜åœ¨ï¼Œoracleéƒ½ä¼šè‡ªåŠ¨åˆ›å»ºè¯¥è§†å›¾</span><br><span class="line">suquery:å­æŸ¥è¯¢</span><br><span class="line">[<span class="keyword">with</span> <span class="keyword">check</span> option]:æ’å…¥å’Œä¿®æ”¹çš„æ•°æ®è¡Œå¿…é¡»æ»¡è¶³å®šä¹‰è§†å›¾çš„çº¦æŸ</span><br><span class="line">[<span class="keyword">with</span> read <span class="keyword">only</span>]:è¯¥è§†å›¾ä¸Šä¸èƒ½è¿›è¡Œä»»ä½• DML æ“ä½œã€‚</span><br><span class="line"></span><br><span class="line">#<span class="keyword">create</span> <span class="keyword">view</span> dba_data_files_v1 <span class="keyword">as</span> <span class="keyword">select</span> file_name,tablespace_name, <span class="keyword">from</span> dba_data_files;</span><br><span class="line"><span class="keyword">create</span> [<span class="keyword">or</span> replace] <span class="keyword">view</span> t_account_v1 <span class="keyword">as</span> <span class="keyword">select</span> id,ownerid,ownertypeid,areaid <span class="keyword">from</span> t_account;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_account_v1;</span><br><span class="line">#ç®€å•è§†å›¾ï¼Œå¯ä»¥è¿›è¡Œå¢åˆ æ”¹æŸ¥è®°å½•</span><br><span class="line">#<span class="keyword">update</span> view_name <span class="keyword">set</span> <span class="keyword">column</span><span class="operator">=</span>æ–°å€¼ <span class="keyword">where</span> æ¡ä»¶</span><br><span class="line"><span class="keyword">update</span> t_account_v1 <span class="keyword">set</span> areaid<span class="operator">=</span><span class="number">1002</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">5</span>;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_account_v1;</span><br></pre></td></tr></table></figure><p>è§†å›¾å…¶å®æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„è¡¨ï¼Œå®ƒçš„æ•°æ®å…¶å®æ¥è‡ªäºè¡¨ã€‚å¦‚æœæ›´æ”¹äº†è§†å›¾çš„æ•°æ®ï¼Œè¡¨çš„æ•°æ®ä¹Ÿè‡ªç„¶ä¼šå˜åŒ–ï¼Œæ›´æ”¹äº†<br>è¡¨çš„æ•°æ®ï¼Œè§†å›¾ä¹Ÿè‡ªç„¶ä¼šå˜åŒ–ã€‚</p><h4 id="åˆ é™¤è§†å›¾"><a href="#åˆ é™¤è§†å›¾" class="headerlink" title="åˆ é™¤è§†å›¾"></a>åˆ é™¤è§†å›¾</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> view_name;</span><br></pre></td></tr></table></figure><h4 id="å¸¦æ£€æŸ¥çº¦æŸçš„è§†å›¾"><a href="#å¸¦æ£€æŸ¥çº¦æŸçš„è§†å›¾" class="headerlink" title="å¸¦æ£€æŸ¥çº¦æŸçš„è§†å›¾"></a>å¸¦æ£€æŸ¥çº¦æŸçš„è§†å›¾</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> t_account_v2 </span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> id,ownerid,ownertypeid,areaid <span class="keyword">from</span> t_account <span class="keyword">where</span> areaid<span class="operator">=</span><span class="number">1001</span></span><br><span class="line"><span class="keyword">with</span> <span class="keyword">check</span> option;</span><br><span class="line"></span><br><span class="line">#<span class="keyword">update</span> t_account_v2 <span class="keyword">set</span> areaid<span class="operator">=</span><span class="number">1002</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">#ä¼šæŠ¥é”™<span class="keyword">view</span> <span class="keyword">WITH</span> <span class="keyword">CHECK</span> OPTION <span class="keyword">where</span><span class="operator">-</span>clause violation</span><br></pre></td></tr></table></figure><h4 id="åªè¯»è§†å›¾çš„åˆ›å»ºä¸ä½¿ç”¨"><a href="#åªè¯»è§†å›¾çš„åˆ›å»ºä¸ä½¿ç”¨" class="headerlink" title="åªè¯»è§†å›¾çš„åˆ›å»ºä¸ä½¿ç”¨"></a>åªè¯»è§†å›¾çš„åˆ›å»ºä¸ä½¿ç”¨</h4><p>æŒ‡å®š WITH READ ONLY é€‰é¡¹ï¼Œè¿™æ ·åˆ›å»ºçš„è§†å›¾å°±æ˜¯ä¸€ä¸ªåªè¯»è§†å›¾</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> t_account_v2</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> id,ownerid,ownertypeid,areaid <span class="keyword">from</span> t_account <span class="keyword">where</span> areaid<span class="operator">=</span><span class="number">1001</span></span><br><span class="line"><span class="keyword">with</span> read <span class="keyword">only</span>;</span><br><span class="line"><span class="keyword">update</span> t_account_v2 <span class="keyword">set</span> areaid<span class="operator">=</span><span class="number">1002</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">#ä¿®æ”¹åªè¯»è§†å›¾å‡ºç°ï¼šcannot perform a DML operation <span class="keyword">on</span> a read<span class="operator">-</span><span class="keyword">only</span> <span class="keyword">view</span></span><br></pre></td></tr></table></figure><h4 id="åˆ›å»ºä¸å­˜åœ¨åŸºè¡¨çš„è§†å›¾"><a href="#åˆ›å»ºä¸å­˜åœ¨åŸºè¡¨çš„è§†å›¾" class="headerlink" title="åˆ›å»ºä¸å­˜åœ¨åŸºè¡¨çš„è§†å›¾"></a>åˆ›å»ºä¸å­˜åœ¨åŸºè¡¨çš„è§†å›¾</h4><p>æœ‰çš„æ—¶å€™ï¼Œåˆ›å»ºè§†å›¾æ—¶çš„è¡¨å¯èƒ½å¹¶ä¸å­˜åœ¨ï¼Œä½†æ˜¯ä»¥åå¯èƒ½ä¼šå­˜åœ¨ï¼Œæ­¤æ—¶éœ€è¦åˆ›å»ºè¿™æ ·çš„è§†å›¾ï¼Œéœ€è¦æ·»åŠ  FORCE é€‰é¡¹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace force <span class="keyword">view</span> t_temp_vi </span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_temp;</span><br></pre></td></tr></table></figure><h4 id="æŸ¥è¯¢æ‰€æœ‰çš„è§†å›¾"><a href="#æŸ¥è¯¢æ‰€æœ‰çš„è§†å›¾" class="headerlink" title="æŸ¥è¯¢æ‰€æœ‰çš„è§†å›¾"></a>æŸ¥è¯¢æ‰€æœ‰çš„è§†å›¾</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> user_views;</span><br></pre></td></tr></table></figure><h4 id="å¤æ‚è§†å›¾çš„åˆ›å»ºä¸ä½¿ç”¨"><a href="#å¤æ‚è§†å›¾çš„åˆ›å»ºä¸ä½¿ç”¨" class="headerlink" title="å¤æ‚è§†å›¾çš„åˆ›å»ºä¸ä½¿ç”¨"></a>å¤æ‚è§†å›¾çš„åˆ›å»ºä¸ä½¿ç”¨</h4><p>å¤æ‚è§†å›¾ï¼Œå°±æ˜¯è§†å›¾çš„ SQL è¯­å¥ä¸­ï¼Œæœ‰èšåˆå‡½æ•°æˆ–å¤šè¡¨å…³è”æŸ¥è¯¢ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#<span class="number">1</span>ã€å¤šè¡¨å…³è”æŸ¥è¯¢çš„è§†å›¾</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace force <span class="keyword">view</span> twn_tt_v1</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> twn.<span class="operator">*</span>,tt.name <span class="keyword">as</span> ownertypename <span class="keyword">from</span> t_owners twn,t_ownertype tt <span class="keyword">where</span> twn.ownertypeid<span class="operator">=</span>tt.id(<span class="operator">+</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="keyword">check</span> option;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> twn_tt_v1;</span><br><span class="line"><span class="keyword">update</span> twn_tt_v1 <span class="keyword">set</span> name<span class="operator">=</span><span class="string">&#x27;suhe&#x27;</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1002</span>;</span><br><span class="line">#å¯ä»¥ä¿®æ”¹ä¸»è¡¨çš„æ•°æ®ä¸å¯ä»¥ä¿®æ”¹å…³è”è¡¨çš„æ•°æ®</span><br><span class="line">#<span class="number">2</span>ã€åˆ†ç»„èšåˆç»Ÿè®¡æŸ¥è¯¢çš„è§†å›¾</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_account;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace force <span class="keyword">view</span> month_per_num_2023</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">year</span>,<span class="keyword">month</span>,<span class="built_in">sum</span>(usenum) sumuse <span class="keyword">from</span> t_account <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">year</span>,<span class="keyword">month</span> <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">year</span>,<span class="keyword">month</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> month_per_num_2023;</span><br></pre></td></tr></table></figure><h4 id="ç‰©åŒ–è§†å›¾"><a href="#ç‰©åŒ–è§†å›¾" class="headerlink" title="ç‰©åŒ–è§†å›¾"></a>ç‰©åŒ–è§†å›¾</h4><p>â€‹è§†å›¾æ˜¯ä¸€ä¸ªè™šæ‹Ÿè¡¨ï¼ˆä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯ä¸€æ¡è¯­å¥ï¼‰ï¼ŒåŸºäºå®ƒåˆ›å»ºæ—¶æŒ‡å®šçš„æŸ¥è¯¢è¯­å¥è¿”å›çš„ç»“æœé›†ã€‚æ¯æ¬¡è®¿é—®å®ƒéƒ½ä¼šå¯¼è‡´è¿™ä¸ªæŸ¥è¯¢è¯­å¥è¢«æ‰§è¡Œä¸€æ¬¡ã€‚ä¸ºäº†é¿å…æ¯æ¬¡è®¿é—®éƒ½æ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ï¼Œå¯ä»¥å°†è¿™ä¸ªæŸ¥è¯¢ç»“æœé›†å­˜å‚¨åˆ°ä¸€ä¸ªç‰©åŒ–è§†å›¾ï¼ˆä¹Ÿå«å®ä½“åŒ–è§†å›¾ï¼‰ã€‚ç‰©åŒ–è§†å›¾ä¸æ™®é€šçš„è§†å›¾ç›¸æ¯”çš„åŒºåˆ«æ˜¯ç‰©åŒ–è§†å›¾æ˜¯å»ºç«‹çš„å‰¯æœ¬ï¼Œå®ƒç±»ä¼¼äºä¸€å¼ è¡¨ï¼Œéœ€è¦å ç”¨å­˜å‚¨ç©ºé—´ã€‚è€Œå¯¹ä¸€ä¸ªç‰©åŒ–è§†å›¾æŸ¥è¯¢çš„æ‰§è¡Œæ•ˆç‡ä¸æŸ¥è¯¢ä¸€ä¸ªè¡¨æ˜¯ä¸€æ ·çš„ã€‚</p><ul><li>åˆ›å»ºç‰©åŒ–è§†å›¾è¯­æ³•</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> meterialized <span class="keyword">view</span> view_name</span><br><span class="line">[build immediate <span class="operator">|</span> build deferred]</span><br><span class="line">refresh [fast <span class="operator">|</span> complete <span class="operator">|</span> force]</span><br><span class="line">[</span><br><span class="line"> <span class="keyword">on</span> [<span class="keyword">commit</span> <span class="operator">|</span> demand]    <span class="operator">|</span> <span class="keyword">start</span> <span class="keyword">with</span> (start_time) next (next_time)</span><br><span class="line">]</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line">subquery</span><br><span class="line"></span><br><span class="line">build immediate:æ˜¯åœ¨åˆ›å»ºç‰©åŒ–è§†å›¾çš„æ—¶å€™å°±ç”Ÿæˆæ•°æ®ã€‚</span><br><span class="line">build dererred:åˆ™åœ¨åˆ›å»ºæ—¶ä¸ç”Ÿæˆæ•°æ®ï¼Œä»¥åæ ¹æ®éœ€è¦å†ç”Ÿæˆæ•°æ®ã€‚é»˜è®¤ä¸º build immediateã€‚</span><br><span class="line">refresh:æŒ‡å½“åŸºè¡¨å‘ç”Ÿäº† DML æ“ä½œåï¼Œç‰©åŒ–è§†å›¾ä½•æ—¶é‡‡ç”¨å“ªç§æ–¹å¼å’ŒåŸºè¡¨è¿›è¡ŒåŒæ­¥ã€‚[fast <span class="operator">|</span> complete<span class="operator">|</span>force] fasté‡‡ç”¨å¢é‡åˆ·æ–°ï¼Œåªåˆ·æ–°è‡ªä¸Šæ¬¡åˆ·æ–°ä»¥åè¿›è¡Œçš„ä¿®æ”¹ã€‚completeåˆ·æ–°å¯¹æ•´ä¸ªç‰©åŒ–è§†å›¾è¿›è¡Œå®Œå…¨çš„åˆ·æ–°ã€‚forceæ–¹å¼ï¼Œåˆ™ Oracle åœ¨åˆ·æ–°æ—¶ä¼šå»åˆ¤æ–­æ˜¯å¦å¯ä»¥è¿›è¡Œå¿«é€Ÿåˆ·æ–°ï¼Œå¦‚æœå¯ä»¥åˆ™é‡‡ç”¨ fast æ–¹å¼ï¼Œå¦åˆ™é‡‡ç”¨ completeçš„æ–¹å¼ï¼Œforce æ˜¯é»˜è®¤çš„æ–¹å¼ã€‚</span><br><span class="line">åˆ·æ–°æ¨¡å¼ï¼š<span class="keyword">on</span> <span class="keyword">commit</span>å’Œ<span class="keyword">on</span> demandä¸¤ç§ï¼Œ <span class="keyword">on</span> demandæŒ‡éœ€è¦æ‰‹åŠ¨åˆ·æ–°ç‰©åŒ–è§†å›¾ï¼ˆé»˜è®¤ï¼‰ã€‚<span class="keyword">on</span> <span class="keyword">commit</span>æŒ‡åœ¨åŸºè¡¨å‘ç”Ÿ<span class="keyword">commit</span>æ“ä½œæ—¶è‡ªåŠ¨åˆ·æ–°.</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>åˆ›å»ºæ‰‹åŠ¨åˆ·æ–°çš„ç‰©åŒ–è§†å›¾</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> meterialized <span class="keyword">view</span> mv_v1</span><br><span class="line">[build immediate</span><br><span class="line">refresh force <span class="keyword">on</span> demand]</span><br><span class="line"><span class="keyword">as</span> </span><br><span class="line"><span class="keyword">select</span> twn.<span class="operator">*</span>,ta.name <span class="keyword">as</span> addressname <span class="keyword">from</span> t_owners twn,t_address ta <span class="keyword">where</span> twn.addressid<span class="operator">=</span>ta.id(<span class="operator">+</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_owners <span class="keyword">VALUES</span> (<span class="number">1004</span>,<span class="string">&#x27;lili&#x27;</span>,<span class="number">1003</span>,<span class="string">&#x27;6-1&#x27;</span>,<span class="string">&#x27;7895&#x27;</span>,sysdate,<span class="number">1002</span>);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> mv_v2;</span><br><span class="line">#ç‰©åŒ–è§†å›¾ä¸­æ²¡æœ‰æ–°æ’å…¥çš„æ•°æ®ã€‚</span><br><span class="line">#PL<span class="operator">/</span><span class="keyword">SQL</span>æ‰§è¡Œ</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">DBMS_MVIEW.refresh(<span class="string">&#x27;mv_v2&#x27;</span>,<span class="string">&#x27;C&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">#æˆ–è€…åœ¨å‘½ä»¤è¡Œæ‰§è¡Œ</span><br><span class="line"><span class="keyword">EXEC</span> DBMS_MVIEW.refresh(<span class="string">&#x27;mv_v2&#x27;</span>,<span class="string">&#x27;C&#x27;</span>);</span><br><span class="line">#DBMS_MVIEW.refresh å®é™…ä¸Šæ˜¯ç³»ç»Ÿå†…ç½®çš„å­˜å‚¨è¿‡ç¨‹</span><br></pre></td></tr></table></figure><ul><li>åˆ›å»ºè‡ªåŠ¨åˆ·æ–°çš„ç‰©åŒ–è§†å›¾</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> materialized <span class="keyword">view</span> mv_v3</span><br><span class="line">build immediate</span><br><span class="line">refresh force</span><br><span class="line"><span class="keyword">on</span> <span class="keyword">commit</span></span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> twn.<span class="operator">*</span>,ta.name <span class="keyword">as</span> addressname <span class="keyword">from</span> t_owners twn,t_address ta <span class="keyword">where</span> twn.addressid<span class="operator">=</span>ta.id(<span class="operator">+</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_owners <span class="keyword">VALUES</span> (<span class="number">1005</span>,<span class="string">&#x27;longlong&#x27;</span>,<span class="number">1002</span>,<span class="string">&#x27;6-2&#x27;</span>,<span class="string">&#x27;1234&#x27;</span>,sysdate,<span class="number">1001</span>);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> mv_v3;</span><br></pre></td></tr></table></figure><ul><li>åˆ›å»ºæ—¶ä¸ç”Ÿæˆæ•°æ®çš„ç‰©åŒ–è§†å›¾</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> materailized <span class="keyword">view</span> mv_v4</span><br><span class="line">build deferred</span><br><span class="line">refresh force <span class="keyword">on</span> <span class="keyword">commit</span></span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> twn.<span class="operator">*</span>,ta.name <span class="keyword">as</span> addressname <span class="keyword">from</span> t_owners twn,t_address ta <span class="keyword">where</span> twn.addressid<span class="operator">=</span>ta.id(<span class="operator">+</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> mv_v4;</span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">DBMS_MVIEW.refresh(<span class="string">&#x27;mv_v4&#x27;</span>,<span class="string">&#x27;C&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_owners <span class="keyword">VALUES</span> (<span class="number">1006</span>,<span class="string">&#x27;chuan&#x27;</span>,<span class="number">1001</span>,<span class="string">&#x27;7-2&#x27;</span>,<span class="string">&#x27;7534&#x27;</span>,sysdate,<span class="number">1003</span>);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> mv_v4;</span><br></pre></td></tr></table></figure><ul><li>åˆ é™¤ç‰©åŒ–è§†å›¾</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop materialized view view_name;</span><br></pre></td></tr></table></figure><ul><li>åˆ›å»ºå¢é‡åˆ·æ–°çš„ç‰©åŒ–è§†å›¾</li></ul><p>å¦‚æœåˆ›å»ºå¢é‡åˆ·æ–°çš„ç‰©åŒ–è§†å›¾ï¼Œå¿…é¡»é¦–å…ˆåˆ›å»ºç‰©åŒ–è§†å›¾æ—¥å¿—</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#åˆ›å»ºç‰©åŒ–è§†å›¾æ—¥å¿—</span><br><span class="line"><span class="keyword">create</span> materialized <span class="keyword">view</span> log <span class="keyword">on</span> t_owners <span class="keyword">with</span> rowid;</span><br><span class="line"><span class="keyword">create</span> materialized <span class="keyword">view</span> log <span class="keyword">on</span> t_address <span class="keyword">with</span> rowid;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> materialized <span class="keyword">view</span> mv_v5</span><br><span class="line">build immediate</span><br><span class="line">refresh fast</span><br><span class="line"><span class="keyword">on</span> <span class="keyword">commit</span></span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> twn.<span class="operator">*</span>,twn.rowid <span class="keyword">as</span> twnrowid,ta.rowid <span class="keyword">as</span> tarowid,ta.name <span class="keyword">as</span> addressname <span class="keyword">from</span> t_owners twn,t_address ta <span class="keyword">where</span> twn.addressid<span class="operator">=</span>ta.id(<span class="operator">+</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_owners <span class="keyword">VALUES</span> (<span class="number">1007</span>,<span class="string">&#x27;su&#x27;</span>,<span class="number">1002</span>,<span class="string">&#x27;8-2&#x27;</span>,<span class="string">&#x27;3455&#x27;</span>,sysdate,<span class="number">1002</span>);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line">#åˆ›å»ºå¢é‡åˆ·æ–°çš„ç‰©åŒ–è§†å›¾ï¼Œå¿…é¡»ï¼š</span><br><span class="line">#<span class="number">1</span>ã€åˆ›å»ºç‰©åŒ–è§†å›¾ä¸­æ¶‰åŠè¡¨çš„ç‰©åŒ–è§†å›¾æ—¥å¿—ã€‚</span><br><span class="line">#<span class="number">2</span>ã€åœ¨æŸ¥è¯¢è¯­å¥ä¸­ï¼Œå¿…é¡»åŒ…å«æ‰€æœ‰è¡¨çš„rowid(ä»¥rowidæ–¹å¼å»ºç«‹ç‰©åŒ–è§†å›¾æ—¥å¿—)</span><br></pre></td></tr></table></figure><h2 id="8ã€åºåˆ—"><a href="#8ã€åºåˆ—" class="headerlink" title="8ã€åºåˆ—"></a>8ã€åºåˆ—</h2><p>åºåˆ—æ˜¯ ORACLE æä¾›çš„ç”¨äºäº§ç”Ÿä¸€ç³»åˆ—å”¯ä¸€æ•°å­—çš„æ•°æ®åº“å¯¹è±¡ã€‚</p><h4 id="åˆ›å»ºåºåˆ—è¯­æ³•"><a href="#åˆ›å»ºåºåˆ—è¯­æ³•" class="headerlink" title="åˆ›å»ºåºåˆ—è¯­æ³•"></a>åˆ›å»ºåºåˆ—è¯­æ³•</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> sequence sequence_name;</span><br></pre></td></tr></table></figure><p>é€šè¿‡åºåˆ—çš„ä¼ªåˆ—æ¥è®¿é—®åºåˆ—çš„å€¼,NEXTVAL è¿”å›åºåˆ—çš„ä¸‹ä¸€ä¸ªå€¼,CURRVAL è¿”å›åºåˆ—çš„å½“å‰å€¼</p><blockquote><p>æ³¨æ„ï¼šæˆ‘ä»¬åœ¨åˆšå»ºç«‹åºåˆ—åï¼Œæ— æ³•æå–å½“å‰å€¼ï¼Œåªæœ‰å…ˆæå–ä¸‹ä¸€ä¸ªå€¼æ—¶æ‰èƒ½å†æ¬¡æå–å½“å‰å€¼ã€‚</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> sequence sequence_one;</span><br><span class="line"><span class="keyword">select</span> sequence_one.nextval <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> sequence_one.currval <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure><h4 id="åˆ›å»ºå¤æ‚åºåˆ—"><a href="#åˆ›å»ºå¤æ‚åºåˆ—" class="headerlink" title="åˆ›å»ºå¤æ‚åºåˆ—"></a>åˆ›å»ºå¤æ‚åºåˆ—</h4><ul><li>è¯­æ³•ï¼š</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> sequence sequence_one</span><br><span class="line">[increment <span class="keyword">by</span> n] #é€’å¢çš„åºåˆ—å€¼æ˜¯n å¦‚æœnæ˜¯æ­£æ•°å°±é€’å¢,å¦‚æœæ˜¯è´Ÿæ•°å°±é€’å‡ é»˜è®¤æ˜¯<span class="number">1</span></span><br><span class="line">[<span class="keyword">start</span> <span class="keyword">with</span> n] #å¼€å§‹çš„å€¼,é€’å¢é»˜è®¤æ˜¯ minvalue é€’å‡æ˜¯ maxvalue</span><br><span class="line">[&#123;maxvalue n<span class="operator">|</span>nomaxvalue&#125;] #æœ€å¤§å€¼</span><br><span class="line">[&#123;minvalue n<span class="operator">|</span>nominvalue&#125;]#æœ€å°å€¼</span><br><span class="line">[&#123;<span class="keyword">cycle</span> <span class="operator">|</span> nocycle&#125;] #å¾ªç¯</span><br><span class="line">[&#123;cache n <span class="operator">|</span> nocache&#125;] #åˆ†é…å¹¶å­˜å…¥åˆ°å†…å­˜ä¸­</span><br></pre></td></tr></table></figure><ul><li>åˆ›å»ºæœ‰æœ€å¤§å€¼çš„éå¾ªç¯åºåˆ—</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> sequence seq_1</span><br><span class="line">increment <span class="keyword">by</span> <span class="number">20</span></span><br><span class="line">maxvalue <span class="number">100</span></span><br><span class="line">minvalue <span class="number">20</span></span><br><span class="line">nocycle;</span><br><span class="line"><span class="keyword">select</span> seq_1.nextval <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure><ul><li>æœ‰æœ€å¤§å€¼çš„å¾ªç¯åºåˆ—</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> sequence seq_2</span><br><span class="line">increment <span class="keyword">by</span> <span class="number">20</span></span><br><span class="line">maxvalue <span class="number">100</span></span><br><span class="line">minvalue <span class="number">20</span></span><br><span class="line"><span class="keyword">cycle</span></span><br><span class="line">cache <span class="number">4</span>;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šCACHE &lt;&#x3D; CEIL((MAXVALUE - MINVALUE) &#x2F; ABS(INCREMENT))<br>ä¾‹å¦‚ï¼šcache &lt;&#x3D;ceil(100-20)&#x2F;abs(20)</p></blockquote><h4 id="ä¿®æ”¹å’Œåˆ é™¤åºåˆ—"><a href="#ä¿®æ”¹å’Œåˆ é™¤åºåˆ—" class="headerlink" title="ä¿®æ”¹å’Œåˆ é™¤åºåˆ—"></a>ä¿®æ”¹å’Œåˆ é™¤åºåˆ—</h4><p>ä¿®æ”¹åºåˆ—ï¼šä½¿ç”¨ ALTER SEQUENCE è¯­å¥ä¿®æ”¹åºåˆ—ï¼Œä¸èƒ½æ›´æ”¹åºåˆ—çš„ STARTWITH å‚æ•°</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> SEQUENCE åºåˆ—åç§° MAXVALUE <span class="number">5000</span> <span class="keyword">CYCLE</span>;</span><br><span class="line"><span class="keyword">alter</span> sequence seq_1 maxvalue <span class="number">300</span> <span class="keyword">cycle</span> cache <span class="number">14</span>;</span><br></pre></td></tr></table></figure><p>åˆ é™¤åºåˆ—</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> SEQUENCE åºåˆ—åç§°;</span><br><span class="line"><span class="keyword">drop</span> sequence seq_1;</span><br></pre></td></tr></table></figure><h2 id="9ã€åŒä¹‰è¯"><a href="#9ã€åŒä¹‰è¯" class="headerlink" title="9ã€åŒä¹‰è¯"></a>9ã€åŒä¹‰è¯</h2><p>â€‹åŒä¹‰è¯å®è´¨ä¸Šæ˜¯æŒ‡å®šæ–¹æ¡ˆå¯¹è±¡çš„ä¸€ä¸ªåˆ«åã€‚é€šè¿‡å±è”½å¯¹è±¡çš„åç§°å’Œæ‰€æœ‰è€…ä»¥åŠå¯¹åˆ†å¸ƒå¼æ•°æ®åº“çš„è¿œç¨‹å¯¹è±¡æä¾›ä½ç½®é€æ˜æ€§ï¼ŒåŒä¹‰è¯å¯ä»¥æä¾›ä¸€å®šç¨‹åº¦çš„å®‰å…¨æ€§ã€‚åŒæ—¶ï¼ŒåŒä¹‰è¯çš„æ˜“ç”¨æ€§è¾ƒå¥½ï¼Œé™ä½äº†æ•°æ®åº“ç”¨æˆ·çš„ SQL è¯­å¥å¤æ‚åº¦ã€‚</p><p>â€‹åŒä¹‰è¯å…è®¸åŸºå¯¹è±¡é‡å‘½åæˆ–è€…ç§»åŠ¨ï¼Œè¿™æ—¶ï¼Œåªéœ€å¯¹åŒä¹‰è¯è¿›è¡Œé‡å®šä¹‰ï¼ŒåŸºäºåŒä¹‰è¯çš„åº”ç”¨ç¨‹åºå¯ä»¥ç»§ç»­è¿è¡Œè€Œæ— éœ€ä¿®æ”¹ã€‚</p><p>â€‹åŒä¹‰è¯æœ¬èº«ä¸æ¶‰åŠå®‰å…¨ï¼Œå½“ä½ èµ‹äºˆä¸€ä¸ªåŒä¹‰è¯å¯¹è±¡æƒé™æ—¶ï¼Œä½ å®è´¨ä¸Šæ˜¯åœ¨ç»™åŒä¹‰è¯çš„åŸºå¯¹è±¡èµ‹äºˆæƒé™ï¼ŒåŒä¹‰è¯åªæ˜¯åŸºå¯¹è±¡çš„ä¸€ä¸ªåˆ«åã€‚</p><h4 id="åˆ›å»ºä¸ä½¿ç”¨åŒä¹‰è¯"><a href="#åˆ›å»ºä¸ä½¿ç”¨åŒä¹‰è¯" class="headerlink" title="åˆ›å»ºä¸ä½¿ç”¨åŒä¹‰è¯"></a>åˆ›å»ºä¸ä½¿ç”¨åŒä¹‰è¯</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> [public] SYNONYM synonym <span class="keyword">for</span> object</span><br><span class="line">synonym:åˆ›å»ºçš„åŒä¹‰è¯çš„åç§°</span><br><span class="line">object:è¡¨ç¤ºè¡¨ï¼Œè§†å›¾ï¼Œåºåˆ—ç­‰æˆ‘ä»¬è¦åˆ›å»ºåŒä¹‰è¯çš„å¯¹è±¡çš„åç§°.åˆ›å»ºå…±æœ‰çš„åŒä¹‰è¯ï¼Œä»¥å¦å¤–çš„ç”¨æˆ·ç™»é™†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¬æœ‰åŒä¹‰è¯</span><br><span class="line"><span class="keyword">create</span> public SYNONYM twn <span class="keyword">for</span> t_owners;</span><br><span class="line">åˆ›å»ºç§æœ‰çš„åŒä¹‰è¯</span><br><span class="line"><span class="keyword">create</span> SYNONYM twn1 <span class="keyword">for</span> t_owners;</span><br></pre></td></tr></table></figure><h2 id="10ã€ç´¢å¼•"><a href="#10ã€ç´¢å¼•" class="headerlink" title="10ã€ç´¢å¼•"></a>10ã€ç´¢å¼•</h2><p>ç´¢å¼•æ˜¯ç”¨äºåŠ é€Ÿæ•°æ®å­˜å–çš„æ•°æ®å¯¹è±¡ã€‚åˆç†çš„ä½¿ç”¨ç´¢å¼•å¯ä»¥å¤§å¤§é™ä½ i&#x2F;o æ¬¡æ•°,ä»è€Œæé«˜æ•°æ®è®¿é—®æ€§èƒ½ã€‚</p><p>ç´¢å¼•æ˜¯éœ€è¦å æ®å­˜å‚¨ç©ºé—´çš„ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ•°æ®ã€‚å½¢å¼ç±»ä¼¼äºä¸‹å›¾çš„ä¸€æ£µâ€œæ ‘â€ï¼Œè€Œæ ‘çš„èŠ‚ç‚¹å­˜å‚¨çš„å°±æ˜¯æ¯æ¡è®°å½•çš„ç‰©ç†åœ°å€ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æåˆ°çš„ä¼ªåˆ—ï¼ˆROWIDï¼‰</p><h4 id="æ™®é€šç´¢å¼•"><a href="#æ™®é€šç´¢å¼•" class="headerlink" title="æ™®é€šç´¢å¼•"></a>æ™®é€šç´¢å¼•</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> index index_name <span class="keyword">on</span> table_name(column_name);#æ ¹æ®æŸå¼ è¡¨çš„æŸåˆ—æ¥åˆ›å»ºç´¢å¼•ã€‚</span><br><span class="line"><span class="keyword">create</span> index t_owners_name <span class="keyword">on</span> t_owners(name);</span><br><span class="line"></span><br><span class="line">#ç´¢å¼•æ€§èƒ½æµ‹è¯•</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> T_INDEXTEST (</span><br><span class="line">ID NUMBER,</span><br><span class="line">NAME VARCHAR2(<span class="number">30</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">FOR</span> i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.1000000</span></span><br><span class="line">loop</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> T_INDEXTEST <span class="keyword">VALUES</span>(i,<span class="string">&#x27;AA&#x27;</span><span class="operator">||</span>i);</span><br><span class="line"><span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> index t_indextest_name <span class="keyword">on</span> t_indextest(name);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_indextest <span class="keyword">where</span> id<span class="operator">=</span><span class="number">765432</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_indextest <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;AA765432&#x27;</span>;</span><br></pre></td></tr></table></figure><h4 id="å”¯ä¸€ç´¢å¼•"><a href="#å”¯ä¸€ç´¢å¼•" class="headerlink" title="å”¯ä¸€ç´¢å¼•"></a>å”¯ä¸€ç´¢å¼•</h4><p>å¦‚æœæˆ‘ä»¬éœ€è¦åœ¨æŸä¸ªè¡¨æŸä¸ªåˆ—åˆ›å»ºç´¢å¼•ï¼Œè€Œè¿™åˆ—çš„å€¼æ˜¯ä¸ä¼šé‡å¤çš„ã€‚è¿™æ˜¯æˆ‘ä»¬å¯ä»¥åˆ›å»ºå”¯ä¸€ç´¢å¼•ã€‚</p><p>è¯­æ³•</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">unique</span> index index_name <span class="keyword">on</span> table_name(column_name);</span><br></pre></td></tr></table></figure><h4 id="å¤åˆç´¢å¼•"><a href="#å¤åˆç´¢å¼•" class="headerlink" title="å¤åˆç´¢å¼•"></a>å¤åˆç´¢å¼•</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> index index_name <span class="keyword">on</span> table_name(column_name,column_name);</span><br></pre></td></tr></table></figure><h4 id="åå‘é”®ç´¢å¼•"><a href="#åå‘é”®ç´¢å¼•" class="headerlink" title="åå‘é”®ç´¢å¼•"></a>åå‘é”®ç´¢å¼•</h4><p>â€‹åº”ç”¨åœºæ™¯ï¼šå½“æŸä¸ªå­—æ®µçš„å€¼ä¸ºè¿ç»­å¢é•¿çš„å€¼ï¼Œå¦‚æœæ„å»ºæ ‡å‡†ç´¢å¼•ï¼Œä¼šå½¢æˆæ­ªè„–å­æ ‘ã€‚è¿™æ ·ä¼šå¢åŠ æŸ¥è¯¢çš„å±‚æ•°ï¼Œæ€§èƒ½ä¼šä¸‹é™ã€‚å»ºç«‹åå‘é”®ç´¢å¼•ï¼Œå¯ä»¥ä½¿ç´¢å¼•çš„å€¼å˜å¾—ä¸è§„åˆ™ï¼Œä»è€Œä½¿ç´¢å¼•æ ‘èƒ½å¤Ÿå‡åŒ€åˆ†å¸ƒã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> index ç´¢å¼•åç§° <span class="keyword">on</span> è¡¨å(åˆ—å) reverse;</span><br><span class="line"><span class="keyword">create</span> index t_indextest_name_reverse <span class="keyword">on</span> t_indextest(id) reverse;</span><br></pre></td></tr></table></figure><h4 id="ä½å›¾ç´¢å¼•"><a href="#ä½å›¾ç´¢å¼•" class="headerlink" title="ä½å›¾ç´¢å¼•"></a>ä½å›¾ç´¢å¼•</h4><ul><li>ä½¿ç”¨åœºæ™¯ï¼šä½å›¾ç´¢å¼•é€‚åˆåˆ›å»ºåœ¨ä½åŸºæ•°åˆ—ä¸Š</li><li>ä½å›¾ç´¢å¼•ä¸ç›´æ¥å­˜å‚¨ ROWIDï¼Œè€Œæ˜¯å­˜å‚¨å­—èŠ‚ä½åˆ° ROWID çš„æ˜ å°„</li><li>ä¼˜ç‚¹ï¼šå‡å°‘å“åº”æ—¶é—´ï¼ŒèŠ‚çœç©ºé—´å ç”¨</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> bitmap index index_name table_name(column_name);</span><br></pre></td></tr></table></figure><h2 id="11ã€PL-SQL"><a href="#11ã€PL-SQL" class="headerlink" title="11ã€PL&#x2F;SQL"></a>11ã€PL&#x2F;SQL</h2><p>PL&#x2F;SQLï¼ˆProcedure Language&#x2F;SQLï¼‰æ˜¯ Oracle å¯¹ sql è¯­è¨€çš„è¿‡ç¨‹åŒ–æ‰©å±•ï¼ŒæŒ‡åœ¨ SQL å‘½ä»¤è¯­è¨€ä¸­å¢åŠ äº†è¿‡ç¨‹å¤„ç†è¯­å¥ï¼ˆå¦‚åˆ†æ”¯ã€å¾ªç¯ç­‰ï¼‰ï¼Œä½¿ SQL è¯­è¨€å…·æœ‰è¿‡ç¨‹å¤„ç†èƒ½åŠ›ã€‚æŠŠ SQL è¯­è¨€çš„æ•°æ®æ“çºµèƒ½åŠ›ä¸è¿‡ç¨‹è¯­è¨€çš„æ•°æ®å¤„ç†èƒ½åŠ›ç»“åˆèµ·æ¥ï¼Œä½¿å¾— PLSQL é¢å‘è¿‡ç¨‹ä½†æ¯”è¿‡ç¨‹è¯­è¨€ç®€å•ã€é«˜æ•ˆã€çµæ´»å’Œå®ç”¨ã€‚</p><h4 id="åŸºæœ¬è¯­æ³•ç»“æ„"><a href="#åŸºæœ¬è¯­æ³•ç»“æ„" class="headerlink" title="åŸºæœ¬è¯­æ³•ç»“æ„"></a>åŸºæœ¬è¯­æ³•ç»“æ„</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">declare</span>  <span class="comment">--å£°æ˜å˜é‡]</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">é€»è¾‘ä»£ç </span><br><span class="line">[exception <span class="comment">--å¼‚å¸¸å¤„ç†]</span></span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h4 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">å£°æ˜å˜é‡çš„è¯­æ³•</span><br><span class="line">å˜é‡å ç±»å‹(é•¿åº¦)</span><br><span class="line">å˜é‡èµ‹å€¼è¯­æ³•</span><br><span class="line">å˜é‡å:<span class="operator">=</span>å˜é‡å€¼</span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">v_price number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">v_usenum number;</span><br><span class="line">v_usenum2 number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">v_money(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">v_price:<span class="operator">=</span><span class="number">2.45</span>;</span><br><span class="line">v_usenum:<span class="operator">=</span><span class="number">8012</span>;</span><br><span class="line">v_usenum2:<span class="operator">=</span>round(v_usenum<span class="operator">/</span><span class="number">1000</span>,<span class="number">2</span>);</span><br><span class="line">v_money:<span class="operator">=</span>round(v_price<span class="operator">*</span>v_usenum2,<span class="number">2</span>);</span><br><span class="line">dbms_output.put_line(<span class="string">&#x27;å•ä»·ï¼š&#x27;</span><span class="operator">||</span>v_price<span class="operator">||</span><span class="string">&#x27;å¨æ•°:&#x27;</span><span class="operator">||</span>v_usenum2<span class="operator">||</span><span class="string">&#x27;é‡‘é¢ï¼š&#x27;</span><span class="operator">||</span>v_money);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><p>select intoæ–¹å¼èµ‹å€¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> åˆ—å <span class="keyword">into</span> å˜é‡å <span class="keyword">from</span> è¡¨å <span class="keyword">where</span> æ¡ä»¶;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šç»“æœå¿…é¡»æ˜¯ä¸€æ¡è®°å½• ï¼Œæœ‰å¤šæ¡è®°å½•å’Œæ²¡æœ‰è®°å½•éƒ½ä¼šæŠ¥é”™</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> usenum,num0,num1 <span class="keyword">from</span> t_account <span class="keyword">where</span> <span class="keyword">year</span><span class="operator">=</span><span class="number">2023</span> <span class="keyword">and</span> id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">v_price number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">v_usenum number;</span><br><span class="line">v_usenum2 number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">v_num0 number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">v_num1 number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">v_money number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">v_price:<span class="operator">=</span><span class="number">2.45</span>;</span><br><span class="line"><span class="keyword">select</span> usenum,num0,num1 <span class="keyword">into</span> v_usenum,v_num0,v_num1 <span class="keyword">from</span> t_account <span class="keyword">where</span> <span class="keyword">year</span><span class="operator">=</span><span class="number">2023</span> <span class="keyword">and</span> id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">v_usenum2:<span class="operator">=</span>round(v_usenum<span class="operator">/</span><span class="number">1000</span>,<span class="number">2</span>);</span><br><span class="line">v_money:<span class="operator">=</span>round(v_price<span class="operator">*</span>v_usenum2,<span class="number">2</span>);</span><br><span class="line">dbms_output.put_line(<span class="string">&#x27;å•ä»·ï¼š&#x27;</span><span class="operator">||</span>v_price<span class="operator">||</span><span class="string">&#x27;å¨æ•°ï¼š&#x27;</span><span class="operator">||</span>v_usenum2<span class="operator">||</span><span class="string">&#x27;é‡‘é¢ï¼š&#x27;</span><span class="operator">||</span>v_money<span class="operator">||</span><span class="string">&#x27;ä¸Šæœˆå­—æ•°ï¼š&#x27;</span><span class="operator">||</span>v_num0<span class="operator">||</span><span class="string">&#x27;æœ¬æœˆå­—æ•°&#x27;</span><span class="operator">||</span>v_num1);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h4 id="å±æ€§ç±»å‹"><a href="#å±æ€§ç±»å‹" class="headerlink" title="å±æ€§ç±»å‹"></a>å±æ€§ç±»å‹</h4><p>%TYPE å¼•ç”¨å‹  ä½œç”¨ï¼šå¼•ç”¨æŸè¡¨æŸåˆ—çš„å­—æ®µç±»å‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line">v_price number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">v_usenum t_account.usenum<span class="operator">%</span>TYPE;</span><br><span class="line">v_num0 t_account.num0<span class="operator">%</span>TYPE;</span><br><span class="line">v_num1 t_account.num1<span class="operator">%</span>TYPE;</span><br><span class="line">v_usenum2 number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">v_money number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">v_price:<span class="operator">=</span><span class="number">2.55</span>;</span><br><span class="line"><span class="keyword">select</span> usenum,num0,num1 <span class="keyword">into</span> v_usenum,v_num0,v_num1 <span class="keyword">from</span> t_account <span class="keyword">where</span> <span class="keyword">year</span><span class="operator">=</span><span class="number">2023</span> <span class="keyword">and</span> id<span class="operator">=</span><span class="number">3</span>;</span><br><span class="line">v_usenum2:<span class="operator">=</span>round(v_usenum<span class="operator">/</span><span class="number">1000</span>,<span class="number">2</span>);</span><br><span class="line">v_money:<span class="operator">=</span>v_price<span class="operator">*</span>v_usenum2;</span><br><span class="line">dbms_output.put_line(<span class="string">&#x27;å•ä»·ï¼š&#x27;</span><span class="operator">||</span>v_price<span class="operator">||</span><span class="string">&#x27;å¨æ•°ï¼š&#x27;</span><span class="operator">||</span>v_usenum2<span class="operator">||</span><span class="string">&#x27;é‡‘é¢ï¼š&#x27;</span><span class="operator">||</span>v_money<span class="operator">||</span><span class="string">&#x27;ä¸Šæœˆå­—æ•°ï¼š&#x27;</span><span class="operator">||</span>v_num0<span class="operator">||</span><span class="string">&#x27;æœ¬æœˆå­—æ•°&#x27;</span><span class="operator">||</span>v_num1);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><p>%ROWTYPE è®°å½•å‹ ï¼Œä¸Šä¾‹ä¸­çš„ä¾‹å­å¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç ä»£æ›¿ä½œç”¨: æ ‡è¯†æŸä¸ªè¡¨çš„è¡Œè®°å½•ç±»å‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line">v_price number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">v_account t_account<span class="operator">%</span>ROWTYPE;</span><br><span class="line">v_usenum2 number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">v_money number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">v_price:<span class="operator">=</span><span class="number">3.14</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">into</span> v_account <span class="keyword">from</span> t_account <span class="keyword">where</span> <span class="keyword">year</span><span class="operator">=</span><span class="number">2023</span> <span class="keyword">and</span> id<span class="operator">=</span><span class="number">3</span>;</span><br><span class="line">v_usenum2:<span class="operator">=</span>round(v_account.usenum<span class="operator">/</span><span class="number">1000</span>,<span class="number">2</span>);</span><br><span class="line">v_money:<span class="operator">=</span>v_price<span class="operator">*</span>v_usenum2;</span><br><span class="line">DBMS_OUTPUT.put_line(<span class="string">&#x27;å•ä»·ï¼š&#x27;</span><span class="operator">||</span>v_price<span class="operator">||</span><span class="string">&#x27;å¨æ•°ï¼š&#x27;</span><span class="operator">||</span>v_usenum2<span class="operator">||</span><span class="string">&#x27;é‡‘é¢ï¼š&#x27;</span><span class="operator">||</span>v_money<span class="operator">||</span><span class="string">&#x27;ä¸Šæœˆå­—æ•°ï¼š&#x27;</span><span class="operator">||</span>v_account.num0<span class="operator">||</span><span class="string">&#x27;æœ¬æœˆå­—æ•°&#x27;</span><span class="operator">||</span>v_account.num1);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h4 id="å¼‚å¸¸"><a href="#å¼‚å¸¸" class="headerlink" title="å¼‚å¸¸"></a>å¼‚å¸¸</h4><p>åœ¨è¿è¡Œç¨‹åºæ—¶å‡ºç°çš„é”™è¯¯å«åšå¼‚å¸¸ï¼Œå‘ç”Ÿå¼‚å¸¸åï¼Œè¯­å¥å°†åœæ­¢æ‰§è¡Œï¼Œæ§åˆ¶æƒè½¬ç§»åˆ° PL&#x2F;SQL å—çš„å¼‚å¸¸å¤„ç†éƒ¨åˆ†</p><p>å¼‚å¸¸æœ‰ä¸¤ç§ç±»å‹ï¼š</p><ul><li>é¢„å®šä¹‰å¼‚å¸¸ - å½“ PL&#x2F;SQL ç¨‹åºè¿å Oracle è§„åˆ™æˆ–è¶…è¶Šç³»ç»Ÿé™åˆ¶æ—¶éšå¼å¼•å‘ã€‚</li><li>ç”¨æˆ·å®šä¹‰å¼‚å¸¸ - ç”¨æˆ·å¯ä»¥åœ¨ PL&#x2F;SQL å—çš„å£°æ˜éƒ¨åˆ†å®šä¹‰å¼‚å¸¸ï¼Œè‡ªå®šä¹‰çš„å¼‚å¸¸é€šè¿‡ RAISE è¯­å¥æ˜¾å¼å¼•å‘ã€‚</li></ul><p>oracleé¢„å®šä¹‰çš„å¼‚å¸¸21ä¸ª</p><table><thead><tr><th>ç³»ç»Ÿå¼‚å¸¸</th><th>äº§ç”ŸåŸå› </th></tr></thead><tbody><tr><td>ACCESS_INTO_NULL</td><td>æœªå®šä¹‰å¯¹è±¡</td></tr><tr><td>CASE_NOT_FOUND</td><td>CASE ä¸­è‹¥æœªåŒ…å«ç›¸åº”çš„ WHEN ï¼Œå¹¶ä¸”æ²¡æœ‰è®¾ç½® ELSE æ—¶</td></tr><tr><td>COLLECTION_IS_NULL</td><td>é›†åˆå…ƒç´ æœªåˆå§‹åŒ–</td></tr><tr><td>CURSER_ALREADY_OPEN</td><td>æ¸¸æ ‡å·²ç»æ‰“å¼€</td></tr><tr><td>DUP_VAL_ON_INDEX</td><td>å”¯ä¸€ç´¢å¼•å¯¹åº”çš„åˆ—ä¸Šæœ‰é‡å¤å€¼</td></tr><tr><td>INVALID_CURSOR</td><td>åœ¨ä¸åˆæ³•çš„æ¸¸æ ‡ä¸Šè¿›è¡Œæ“ä½œ</td></tr><tr><td>INVALID_NUMBER</td><td>å†…ç½®çš„SQLè¯­å¥ä¸èƒ½å°†å­—ç¬¦è½¬åŒ–ä¸ºæ•°å­—</td></tr><tr><td><em><strong>NO_DATA_FOUND</strong></em></td><td><em><strong>ä½¿ç”¨select into æ²¡æœ‰è¡Œè¿”å›è¡Œ</strong></em></td></tr><tr><td><em><strong>TOO_MANY_ROWS</strong></em></td><td><em><strong>ä½¿ç”¨select into æœ‰å¤šè¡Œæ•°æ®è¿”å›</strong></em></td></tr><tr><td>ZERO_DIVIDE</td><td>é™¤æ•°ä¸º0</td></tr><tr><td>SUBSCRIPT_BEYOND_COUNT</td><td>å…ƒç´ ä¸‹æ ‡è¶…è¿‡åµŒå¥—è¡¨æˆ– VARRAY çš„æœ€å¤§å€¼</td></tr><tr><td>SUBSCRIPT_OUTSIDE_LIMIT</td><td>ä½¿ç”¨åµŒå¥—è¡¨æˆ– VARRAY æ—¶ï¼Œå°†ä¸‹æ ‡æŒ‡å®šä¸ºè´Ÿæ•°</td></tr><tr><td>VALUE_ERROR</td><td>èµ‹å€¼æ—¶ï¼Œå˜é‡é•¿åº¦ä¸è¶³ä»¥å®¹çº³å®é™…æ•°æ®</td></tr><tr><td>LOGIN_DENIED</td><td>PL&#x2F;SQL åº”ç”¨ç¨‹åºè¿æ¥åˆ° oracle æ•°æ®åº“æ—¶ï¼Œæä¾›äº†ä¸æ­£ç¡®çš„ç”¨æˆ·åæˆ–å¯†ç </td></tr><tr><td>NOT_LOGGED_ON</td><td>PL&#x2F;SQL åº”ç”¨ç¨‹åºåœ¨æ²¡æœ‰è¿æ¥ oralce æ•°æ®åº“çš„æƒ…å†µä¸‹è®¿é—®æ•°æ®</td></tr><tr><td>PROGRAM_ERROR</td><td>PL&#x2F;SQL å†…éƒ¨é—®é¢˜ï¼Œå¯èƒ½éœ€è¦é‡è£…æ•°æ®å­—å…¸ï¼† PL&#x2F;SQL ç³»ç»ŸåŒ…</td></tr><tr><td>ROWTYPE_MISMATCH</td><td>å®¿ä¸»æ¸¸æ ‡å˜é‡ä¸ PL&#x2F;SQL æ¸¸æ ‡å˜é‡çš„è¿”å›ç±»å‹ä¸å…¼å®¹</td></tr><tr><td>SELF_IS_NULL</td><td>ä½¿ç”¨å¯¹è±¡ç±»å‹æ—¶ï¼Œåœ¨ NULLå¯¹è±¡ä¸Šè°ƒç”¨å¯¹è±¡æ–¹æ³•</td></tr><tr><td>STORAGE_ERROR</td><td>è¿è¡Œ PL&#x2F;SQL æ—¶ï¼Œè¶…å‡ºå†…å­˜ç©ºé—´</td></tr><tr><td>SYS_INVALID_ID</td><td>æ— æ•ˆçš„ ROWID å­—ç¬¦ä¸²</td></tr><tr><td>TIMEOUT_ON_RESOURCE</td><td>Oracle åœ¨ç­‰å¾…èµ„æºæ—¶è¶…æ—¶</td></tr><tr><td></td><td></td></tr></tbody></table><p>è¯­æ³•ç»“æ„ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">exception</span><br><span class="line"><span class="keyword">when</span> å¼‚å¸¸ç±»å‹ <span class="keyword">then</span></span><br><span class="line">å¼‚å¸¸å¤„ç†é€»è¾‘</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line">v_price number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">v_usenum t_account.usenum<span class="operator">%</span>TYPE;</span><br><span class="line">v_usenum2 number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">v_money number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">v_price:<span class="operator">=</span><span class="number">3.55</span>;</span><br><span class="line"><span class="keyword">select</span> usenum <span class="keyword">into</span> v_usenum <span class="keyword">from</span> t_account <span class="keyword">where</span> <span class="keyword">year</span><span class="operator">=</span><span class="number">2023</span> <span class="keyword">and</span> id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">v_usenum2:<span class="operator">=</span>round(v_usenum<span class="operator">/</span><span class="number">1000</span>,<span class="number">2</span>);</span><br><span class="line">v_money:<span class="operator">=</span>v_price<span class="operator">*</span>v_usenum2;</span><br><span class="line">dbms_output.put_line(<span class="string">&#x27;å•ä»·ï¼š&#x27;</span><span class="operator">||</span>v_price<span class="operator">||</span><span class="string">&#x27;å¨æ•°:&#x27;</span><span class="operator">||</span>v_usenum2<span class="operator">||</span><span class="string">&#x27;é‡‘é¢ï¼š&#x27;</span><span class="operator">||</span>v_money);</span><br><span class="line">exception</span><br><span class="line"><span class="keyword">when</span> NO_DATA_FOUND <span class="keyword">then</span></span><br><span class="line">dbms_output.put_line(<span class="string">&#x27;æœªæ‰¾åˆ°æ•°æ®ï¼Œè¯·æ ¸å®&#x27;</span>);</span><br><span class="line"><span class="keyword">when</span> TOO_MANY_ROWS <span class="keyword">then</span></span><br><span class="line">dbms_output.put_line(<span class="string">&#x27;æŸ¥è¯¢æ¡ä»¶æœ‰è¯¯ï¼Œè¿”å›å¤šæ¡ä¿¡æ¯ï¼Œè¯·æ ¸å®&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h4 id="æ¡ä»¶åˆ¤æ–­"><a href="#æ¡ä»¶åˆ¤æ–­" class="headerlink" title="æ¡ä»¶åˆ¤æ–­"></a>æ¡ä»¶åˆ¤æ–­</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#åŸºæœ¬è¯­æ³•<span class="number">1</span></span><br><span class="line">if æ¡ä»¶ <span class="keyword">then</span></span><br><span class="line"> ä¸šåŠ¡é€»è¾‘</span><br><span class="line"><span class="keyword">end</span> if;</span><br><span class="line"></span><br><span class="line">#åŸºæœ¬è¯­æ³•<span class="number">2</span></span><br><span class="line">if æ¡ä»¶ <span class="keyword">then</span></span><br><span class="line">ä¸šåŠ¡é€»è¾‘</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">ä¸šåŠ¡é€»è¾‘</span><br><span class="line"><span class="keyword">end</span> if;</span><br><span class="line"></span><br><span class="line">#åŸºæœ¬è¯­æ³•<span class="number">3</span></span><br><span class="line">if æ¡ä»¶ <span class="keyword">then</span></span><br><span class="line">ä¸šåŠ¡é€»è¾‘</span><br><span class="line">elseif æ¡ä»¶ <span class="keyword">then</span></span><br><span class="line">ä¸šåŠ¡é€»è¾‘</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">ä¸šåŠ¡é€»è¾‘</span><br><span class="line"><span class="keyword">end</span> if;</span><br></pre></td></tr></table></figure><p>éœ€æ±‚ï¼šè®¾ç½®ä¸‰ä¸ªç­‰çº§çš„æ°´è´¹ 5 å¨ä»¥ä¸‹ 2.45 å…ƒ&#x2F;å¨ 5 å¨åˆ° 10 å¨éƒ¨åˆ† 3.45 å…ƒ&#x2F;å¨ ï¼Œè¶…è¿‡ 10 å¨éƒ¨åˆ† 4.45 ï¼Œæ ¹æ®ä½¿ç”¨æ°´è´¹çš„é‡æ¥è®¡ç®—é˜¶æ¢¯æ°´è´¹ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line">v_price1 number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">v_price2 number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">v_price3 number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">v_account t_account<span class="operator">%</span>ROWTYPE;</span><br><span class="line">v_usenum2 number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">v_money number(<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">into</span> v_account <span class="keyword">from</span> t_account <span class="keyword">where</span> <span class="keyword">year</span><span class="operator">=</span><span class="number">2023</span> <span class="keyword">and</span> id<span class="operator">=</span><span class="number">3</span>;</span><br><span class="line">v_usenum2:<span class="operator">=</span>round(v_account.usenum<span class="operator">/</span><span class="number">1000</span>,<span class="number">2</span>);</span><br><span class="line">v_price1:<span class="operator">=</span><span class="number">2.45</span>;</span><br><span class="line">v_price2:<span class="operator">=</span><span class="number">3.45</span>;</span><br><span class="line">v_price3:<span class="operator">=</span><span class="number">4.45</span>;</span><br><span class="line">if v_usenum2<span class="operator">&lt;</span><span class="number">5</span> <span class="keyword">then</span></span><br><span class="line">v_money:<span class="operator">=</span>v_price1<span class="operator">*</span>v_usenum2;</span><br><span class="line">elsif <span class="number">5</span><span class="operator">&lt;</span>v_usenum2 <span class="keyword">and</span> v_usenum2<span class="operator">&lt;</span><span class="number">10</span> <span class="keyword">then</span></span><br><span class="line">v_money:<span class="operator">=</span>v_price1<span class="operator">*</span><span class="number">5</span><span class="operator">+</span>v_price2<span class="operator">*</span>(v_usenum2<span class="number">-5</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">v_money:<span class="operator">=</span>v_price1<span class="operator">*</span><span class="number">5</span><span class="operator">+</span>v_price2<span class="operator">*</span><span class="number">5</span><span class="operator">+</span>v_price3<span class="operator">*</span>(v_usenum2<span class="number">-5</span>);</span><br><span class="line"><span class="keyword">end</span> if;</span><br><span class="line">dbms_output.put_line(<span class="string">&#x27;å¨æ•°ï¼š&#x27;</span><span class="operator">||</span>v_usenum2<span class="operator">||</span><span class="string">&#x27;é‡‘é¢ï¼š&#x27;</span><span class="operator">||</span>v_money<span class="operator">||</span><span class="string">&#x27;ä¸Šæœˆå­—æ•°ï¼š&#x27;</span><span class="operator">||</span>v_account.num0<span class="operator">||</span><span class="string">&#x27;æœ¬æœˆå­—æ•°&#x27;</span><span class="operator">||</span>v_account.num1);</span><br><span class="line">exception</span><br><span class="line"><span class="keyword">when</span> NO_DATA_FOUND <span class="keyword">then</span></span><br><span class="line">dbms_output.put_line(<span class="string">&#x27;æœªæ‰¾åˆ°æ•°æ®ï¼Œè¯·æ ¸å®&#x27;</span>);</span><br><span class="line"><span class="keyword">when</span> TOO_MANY_ROWS <span class="keyword">then</span></span><br><span class="line">dbms_output.put_line(<span class="string">&#x27;æœ‰å¤šè¡Œæ•°æ®è¢«æŸ¥è¯¢&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h4 id="å¾ªç¯"><a href="#å¾ªç¯" class="headerlink" title="å¾ªç¯"></a>å¾ªç¯</h4><ol><li>æ— æ¡ä»¶å¾ªç¯</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">loop</span><br><span class="line">å¾ªç¯è¯­å¥</span><br><span class="line"><span class="keyword">end</span> loop;</span><br><span class="line"></span><br><span class="line">#ä¾‹å­</span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">v_num number;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">v_num:<span class="operator">=</span><span class="number">0</span>;</span><br><span class="line">loop</span><br><span class="line">dbms_output.put_line(<span class="string">&#x27;v_num=&#x27;</span><span class="operator">||</span>v_num);</span><br><span class="line">v_num:<span class="operator">=</span>v_num<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">if v_num<span class="operator">=</span><span class="number">100</span> <span class="keyword">then</span></span><br><span class="line">exit;</span><br><span class="line"><span class="keyword">end</span> if;</span><br><span class="line"><span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line">#å¾ªç¯éƒ¨åˆ†å¯ä»¥æ”¹å†™æˆ</span><br><span class="line">loop</span><br><span class="line">dbms_output.put_line(<span class="string">&#x27;v_num=&#x27;</span><span class="operator">||</span>v_num);</span><br><span class="line">v_num:<span class="operator">=</span>v_num<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">exit <span class="keyword">when</span> v_num<span class="operator">&gt;</span><span class="number">100</span>;</span><br><span class="line"><span class="keyword">end</span> loop;</span><br></pre></td></tr></table></figure><pre><code> 2.æ¡ä»¶å¾ªç¯</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">while æ¡ä»¶</span><br><span class="line">loop</span><br><span class="line">å¾ªç¯ä½“</span><br><span class="line"><span class="keyword">end</span> loop;</span><br><span class="line"></span><br><span class="line">#èŒƒä¾‹ï¼šè¾“å‡ºä»<span class="number">1</span>å¼€å§‹çš„<span class="number">100</span>ä¸ªæ•°</span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">v_num number;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">v_num:<span class="operator">=</span><span class="number">0</span>;</span><br><span class="line">while v_num<span class="operator">&lt;</span><span class="number">101</span></span><br><span class="line">loop</span><br><span class="line">dbms_output.put_line(<span class="string">&#x27;v_num=&#x27;</span><span class="operator">||</span>v_num);</span><br><span class="line">v_num:<span class="operator">=</span>v_num<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><p>â€‹3.forå¾ªç¯</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#åŸºæœ¬è¯­æ³•</span><br><span class="line"><span class="keyword">for</span> å˜é‡ <span class="keyword">in</span> èµ·å§‹å€¼..ç»ˆå€¼</span><br><span class="line">loop </span><br><span class="line">å¾ªç¯ä½“</span><br><span class="line"><span class="keyword">end</span> loop;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">for</span> v_num <span class="keyword">in</span> <span class="number">0.</span><span class="number">.100</span></span><br><span class="line">loop</span><br><span class="line">dbms_output.put_line(<span class="string">&#x27;v_num=&#x27;</span><span class="operator">||</span>v_num);</span><br><span class="line"><span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h4 id="æ¸¸æ ‡"><a href="#æ¸¸æ ‡" class="headerlink" title="æ¸¸æ ‡"></a>æ¸¸æ ‡</h4><p>æ¸¸æ ‡æ˜¯ç³»ç»Ÿä¸ºç”¨æˆ·å¼€è®¾çš„ä¸€ä¸ªæ•°æ®ç¼“å†²åŒº,å­˜æ”¾ SQL è¯­å¥çš„æ‰§è¡Œç»“æœã€‚æˆ‘ä»¬å¯ä»¥æŠŠæ¸¸æ ‡ç†è§£ä¸º PL&#x2F;SQL ä¸­çš„ç»“æœé›†ã€‚</p><p>åœ¨å£°æ˜åŒºå£°æ˜æ¸¸æ ‡ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cursor</span> æ¸¸æ ‡åç§° <span class="keyword">is</span> <span class="keyword">SQL</span> è¯­å¥;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ¸¸æ ‡è¯­æ³•</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> æ¸¸æ ‡åç§°</span><br><span class="line">loop</span><br><span class="line"><span class="keyword">fetch</span> æ¸¸æ ‡åç§° <span class="keyword">into</span> å˜é‡;</span><br><span class="line">exit <span class="keyword">when</span> æ¸¸æ ‡åç§°<span class="operator">%</span>notfound;</span><br><span class="line"><span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">close</span> æ¸¸æ ‡åç§°;</span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">curr_jylsh varchar2(<span class="number">50</span>);</span><br><span class="line"><span class="keyword">cursor</span> lyjsh_cursor <span class="keyword">is</span> <span class="keyword">select</span> jylsh <span class="keyword">from</span> jylsh_table;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">open</span> lyjsh_cursor;</span><br><span class="line">loop</span><br><span class="line"><span class="keyword">fetch</span> lyjsh_cursor <span class="keyword">into</span> curr_jylsh;</span><br><span class="line">exit <span class="keyword">when</span> lyjsh_cursor<span class="operator">%</span>notfound;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_sbf_sb_cxjm_sbbc_fail <span class="keyword">values</span>(curr_jylsh,sysdate,<span class="string">&#x27;ljh&#x27;</span>,<span class="string">&#x27;00&#x27;</span>);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">update</span> sbf_sb_cxjmhdxx <span class="keyword">set</span> sjclzt<span class="operator">=</span><span class="string">&#x27;00&#x27;</span>,xgrq<span class="operator">=</span>sysdate,xgr_dm<span class="operator">=</span><span class="string">&#x27;ljh&#x27;</span> <span class="keyword">where</span> cxjmhd_id <span class="keyword">in</span> (<span class="keyword">select</span> lymx_id <span class="keyword">from</span> sbf_sb_wyxx <span class="keyword">where</span> jylsh<span class="operator">=</span>curr_jylsh);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> sbf_sb_cxjmwyxx e <span class="keyword">where</span> e.jylsh<span class="operator">=</span>curr_jylsh;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> sbf_sb_cxjm_sbwyxx e <span class="keyword">where</span> e.jylsh<span class="operator">=</span>curr_jylsh;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> sbf_sb_wyxx e <span class="keyword">where</span> e.jylsh<span class="operator">=</span>curr_jylsh;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">update</span> sbf_sb </span><br><span class="line"><span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">close</span> lyjsh_cursor;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>éœ€æ±‚ï¼šæ‰“å°ä¸šä¸»ç±»å‹ä¸º 1 çš„ä»·æ ¼è¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> </span><br><span class="line">v_pricetable t_pricetable<span class="operator">%</span>ROWTYPE;</span><br><span class="line"><span class="keyword">cursor</span> cur_pricetable <span class="keyword">is</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_pricetable <span class="keyword">where</span> ownertypeid<span class="operator">=</span><span class="number">1001</span>;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">open</span> cur_pricetable;</span><br><span class="line">loop</span><br><span class="line"><span class="keyword">fetch</span>  cur_pricetable <span class="keyword">into</span> v_pricetable;</span><br><span class="line">exit <span class="keyword">when</span> cur_pricetable<span class="operator">%</span>notfound;</span><br><span class="line">dbms_output.put_line( <span class="string">&#x27;ä»·æ ¼:&#x27;</span><span class="operator">||</span>v_pricetable.price <span class="operator">||</span><span class="string">&#x27;å¨ä½ï¼š&#x27;</span><span class="operator">||</span>v_pricetable.minnum<span class="operator">||</span><span class="string">&#x27;-&#x27;</span><span class="operator">||</span>v_pricetable.maxnum );</span><br><span class="line"><span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">close</span> cur_pricetable;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><p>å¸¦å‚æ•°çš„æ¸¸æ ‡</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line">v_pricetable t_pricetable<span class="operator">%</span>ROWTYPE;</span><br><span class="line"><span class="keyword">cursor</span> cur_pricetable(v_ownertypeid number) <span class="keyword">is</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_pricetable <span class="keyword">where</span> ownertypeid<span class="operator">=</span>v_ownertypeid;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">open</span> cur_pricetable(<span class="number">1001</span>);</span><br><span class="line">loop</span><br><span class="line"><span class="keyword">fetch</span> cur_pricetable <span class="keyword">into</span> v_pricetable;</span><br><span class="line">exit <span class="keyword">when</span> cur_pricetable<span class="operator">%</span>notfound;</span><br><span class="line">dbms_output.put_line(<span class="string">&#x27;ä»·æ ¼:&#x27;</span><span class="operator">||</span>v_pricetable.price <span class="operator">||</span><span class="string">&#x27;å¨ä½ï¼š&#x27;</span><span class="operator">||</span>v_pricetable.minnum<span class="operator">||</span><span class="string">&#x27;-&#x27;</span><span class="operator">||</span>v_pricetable.maxnum );</span><br><span class="line"><span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">close</span> cur_pricetable;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><p>for å¾ªç¯æå–æ¸¸æ ‡å€¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line"><span class="keyword">cursor</span> cur_pricetable(v_ownertypeid number) <span class="keyword">is</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_pricetable <span class="keyword">where</span> ownertypeid<span class="operator">=</span>v_ownertypeid;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">for</span> cur_pricetable <span class="keyword">in</span> cur_pricetable(<span class="number">1001</span>)</span><br><span class="line">loop</span><br><span class="line">dbms_output.put_line(<span class="string">&#x27;ä»·æ ¼:&#x27;</span><span class="operator">||</span>cur_pricetable.price <span class="operator">||</span><span class="string">&#x27;å¨ä½ï¼š&#x27;</span><span class="operator">||</span>cur_pricetable.minnum<span class="operator">||</span><span class="string">&#x27;-&#x27;</span><span class="operator">||</span>cur_pricetable.maxnum );</span><br><span class="line"><span class="keyword">end</span> loop;</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h2 id="12ã€å­˜å‚¨å‡½æ•°"><a href="#12ã€å­˜å‚¨å‡½æ•°" class="headerlink" title="12ã€å­˜å‚¨å‡½æ•°"></a>12ã€å­˜å‚¨å‡½æ•°</h2><p>å­˜å‚¨å‡½æ•°åˆç§°ä¸ºè‡ªå®šä¹‰å‡½æ•°ã€‚å¯ä»¥æ¥æ”¶ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªç»“æœã€‚åœ¨å‡½æ•°ä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ PL&#x2F;SQL è¿›è¡Œé€»è¾‘çš„å¤„ç†ã€‚</p><h4 id="å­˜å‚¨å‡½æ•°è¯­æ³•ç»“æ„"><a href="#å­˜å‚¨å‡½æ•°è¯­æ³•ç»“æ„" class="headerlink" title="å­˜å‚¨å‡½æ•°è¯­æ³•ç»“æ„"></a>å­˜å‚¨å‡½æ•°è¯­æ³•ç»“æ„</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">function</span> å‡½æ•°åç§°(å‚æ•°åç§° å‚æ•°ç±»å‹, å‚æ•°åç§° å‚æ•°ç±»å‹, ...)</span><br><span class="line"><span class="keyword">return</span> ç»“æœå˜é‡æ•°æ®ç±»å‹</span><br><span class="line"><span class="keyword">is</span> å˜é‡å£°æ˜éƒ¨åˆ†;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">é€»è¾‘éƒ¨åˆ†;</span><br><span class="line"><span class="keyword">RETURN</span> ç»“æœå˜é‡;</span><br><span class="line">[exception å¼‚å¸¸å¤„ç†éƒ¨åˆ†]</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h4 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span>  <span class="keyword">function</span> pingping(v_name varchar2,v_age number)</span><br><span class="line"><span class="keyword">return</span> varchar2</span><br><span class="line"><span class="keyword">is</span></span><br><span class="line">v_result varchar2(<span class="number">30</span>);</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">v_result:<span class="operator">=</span><span class="string">&#x27;å§“å&#x27;</span><span class="operator">||</span>v_name<span class="operator">||</span><span class="string">&#x27;-å¹´é¾„&#x27;</span><span class="operator">||</span>v_age;</span><br><span class="line">dbms_output.put_line(<span class="string">&#x27;==&#x27;</span><span class="operator">||</span>v_result);</span><br><span class="line"><span class="keyword">return</span> v_result;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">#è°ƒç”¨</span><br><span class="line"><span class="keyword">select</span> pingping(<span class="string">&#x27;suhe&#x27;</span>,<span class="number">18</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure><p>éœ€æ±‚ï¼šæŸ¥è¯¢ä¸šä¸» IDï¼Œä¸šä¸»åç§°ï¼Œä¸šä¸»åœ°å€ï¼Œä¸šä¸»åœ°å€ä½¿ç”¨åˆšæ‰æˆ‘ä»¬åˆ›å»ºçš„å‡½æ•°æ¥å®ç°ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> ss(v_id number) <span class="keyword">return</span> varchar2</span><br><span class="line"><span class="keyword">is</span></span><br><span class="line">address_name varchar2(<span class="number">100</span>);</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">into</span> address_name <span class="keyword">from</span> t_address <span class="keyword">where</span> id<span class="operator">=</span>v_id;</span><br><span class="line"><span class="keyword">return</span> address_name;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> id,name,ss(addressid) <span class="keyword">from</span> t_owners;</span><br></pre></td></tr></table></figure><h2 id="13ã€å­˜å‚¨è¿‡ç¨‹"><a href="#13ã€å­˜å‚¨è¿‡ç¨‹" class="headerlink" title="13ã€å­˜å‚¨è¿‡ç¨‹"></a>13ã€å­˜å‚¨è¿‡ç¨‹</h2><h4 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p>å­˜å‚¨è¿‡ç¨‹æ˜¯è¢«å‘½åçš„ PL&#x2F;SQL å—ï¼Œå­˜å‚¨äºæ•°æ®åº“ä¸­ï¼Œæ˜¯æ•°æ®åº“å¯¹è±¡çš„ä¸€ç§ã€‚åº”ç”¨ç¨‹åºå¯ä»¥è°ƒç”¨å­˜å‚¨è¿‡ç¨‹ï¼Œæ‰§è¡Œç›¸åº”çš„é€»è¾‘ã€‚</p><p>å­˜å‚¨è¿‡ç¨‹ä¸å­˜å‚¨å‡½æ•°éƒ½å¯ä»¥å°è£…ä¸€å®šçš„ä¸šåŠ¡é€»è¾‘å¹¶è¿”å›ç»“æœï¼Œå­˜åœ¨åŒºåˆ«å¦‚ä¸‹ï¼š<br>1ã€å­˜å‚¨å‡½æ•°ä¸­æœ‰è¿”å›å€¼ï¼Œä¸”å¿…é¡»è¿”å›ï¼›è€Œå­˜å‚¨è¿‡ç¨‹æ²¡æœ‰è¿”å›å€¼ï¼Œå¯ä»¥é€šè¿‡ä¼ å‡ºå‚æ•°è¿”å›å¤šä¸ªå€¼ã€‚<br>2ã€å­˜å‚¨å‡½æ•°å¯ä»¥åœ¨ select è¯­å¥ä¸­ç›´æ¥ä½¿ç”¨ï¼Œè€Œå­˜å‚¨è¿‡ç¨‹ä¸èƒ½ã€‚è¿‡ç¨‹å¤šæ•°æ˜¯è¢«åº”ç”¨ç¨‹åºæ‰€è°ƒç”¨ã€‚<br>3ã€å­˜å‚¨å‡½æ•°ä¸€èˆ¬éƒ½æ˜¯å°è£…ä¸€ä¸ªæŸ¥è¯¢ç»“æœï¼Œè€Œå­˜å‚¨è¿‡ç¨‹ä¸€èˆ¬éƒ½å°è£…ä¸€æ®µäº‹åŠ¡ä»£ç ã€‚</p><h4 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">procedure</span> å­˜å‚¨è¿‡ç¨‹åå­—(å‚æ•°<span class="number">1</span> ç±»å‹,å‚æ•°<span class="number">2</span> ç±»å‹)</span><br><span class="line"><span class="keyword">is</span><span class="operator">|</span><span class="keyword">as</span></span><br><span class="line">å˜é‡ç”³æ˜;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">é€»è¾‘éƒ¨åˆ†;</span><br><span class="line">[exception å¼‚å¸¸å¤„ç†éƒ¨åˆ†]</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><blockquote><p>å‚æ•°åªæŒ‡å®šç±»å‹ï¼Œä¸æŒ‡å®šé•¿åº¦</p></blockquote><p>è¿‡ç¨‹å‚æ•°çš„ä¸‰ç§æ¨¡å¼ï¼šIN ä¼ å…¥å‚æ•°ï¼ˆé»˜è®¤ï¼‰,OUT ä¼ å‡ºå‚æ•° ï¼Œä¸»è¦ç”¨äºè¿”å›ç¨‹åºè¿è¡Œç»“æœ,IN OUT ä¼ å…¥ä¼ å‡ºå‚æ•°</p><h4 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h4><p>1ã€åˆ›å»ºä¸å¸¦ä¼ å‡ºå‚æ•°çš„å­˜å‚¨è¿‡ç¨‹ï¼šæ·»åŠ ä¸šä¸»ä¿¡æ¯</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> sequence owner_sequence <span class="keyword">start</span> <span class="keyword">with</span> <span class="number">1010</span>;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">procedure</span> owners_add(v_name varchar2,v_addressid number,v_housenumber varchar2,v_watermeter varchar2,v_type varchar2)</span><br><span class="line"><span class="keyword">is</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_owners <span class="keyword">values</span>(owner_sequence.nextval,v_name,v_addressid,v_housenumber,v_watermeter,sysdate,v_type);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">call</span> owners_add(<span class="string">&#x27;èµµä¼Ÿ&#x27;</span>,<span class="number">1001</span>,<span class="string">&#x27;999-3&#x27;</span>,<span class="string">&#x27;132-7&#x27;</span>,<span class="number">1002</span>);</span><br></pre></td></tr></table></figure><p>2ã€åˆ›å»ºå¸¦ä¼ å‡ºå‚æ•°çš„å­˜å‚¨è¿‡ç¨‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">procedure</span> owners_add_with_out(v_name varchar2,v_addressid number,v_housenumber varchar2,v_watermeter varchar2,v_type varchar2,v_id <span class="keyword">out</span> number)</span><br><span class="line"><span class="keyword">is</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">select</span> owner_sequence.nextval <span class="keyword">into</span> v_id <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_owners <span class="keyword">values</span>(v_id,v_name,v_addressid,v_housenumber,v_watermeter,sysdate,v_type);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span> </span><br><span class="line">v_id number;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">owners_add_with_out(<span class="string">&#x27;ç‹æ—ºæ—º&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;922-3&#x27;</span>,<span class="string">&#x27;133-7&#x27;</span>,<span class="number">1</span>,v_id);</span><br><span class="line">DBMS_OUTPUT.put_line(<span class="string">&#x27;å¢åŠ æˆåŠŸ,ID:&#x27;</span><span class="operator">||</span>v_id);</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><h2 id="14ã€è§¦å‘å™¨"><a href="#14ã€è§¦å‘å™¨" class="headerlink" title="14ã€è§¦å‘å™¨"></a>14ã€è§¦å‘å™¨</h2><h4 id="æ¦‚å¿µ-1"><a href="#æ¦‚å¿µ-1" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p>æ•°æ®åº“è§¦å‘å™¨æ˜¯ä¸€ä¸ªä¸è¡¨ç›¸å…³è”çš„ã€å­˜å‚¨çš„ PL&#x2F;SQL ç¨‹åºã€‚æ¯å½“ä¸€ä¸ªç‰¹å®šçš„æ•°æ®æ“ä½œè¯­å¥(Insert,update,delete)åœ¨æŒ‡å®šçš„è¡¨ä¸Šå‘å‡ºæ—¶ï¼ŒOracle è‡ªåŠ¨åœ°æ‰§è¡Œè§¦å‘å™¨ä¸­å®šä¹‰çš„è¯­å¥åºåˆ—ã€‚</p><p>è§¦å‘å™¨å¯ç”¨äº</p><ul><li>æ•°æ®ç¡®è®¤</li><li>å®æ–½å¤æ‚çš„å®‰å…¨æ€§æ£€æŸ¥</li><li>åšå®¡è®¡ï¼Œè·Ÿè¸ªè¡¨ä¸Šæ‰€åšçš„æ•°æ®æ“ä½œç­‰</li><li>æ•°æ®çš„å¤‡ä»½å’ŒåŒæ­¥</li></ul><p>è§¦å‘å™¨åˆ†ç±»</p><ul><li>å‰ç½®è§¦å‘å™¨ï¼ˆBEFOREï¼‰</li><li>åç½®è§¦å‘å™¨ï¼ˆAFTERï¼‰</li></ul><h4 id="è§¦å‘å™¨è¯­æ³•"><a href="#è§¦å‘å™¨è¯­æ³•" class="headerlink" title="è§¦å‘å™¨è¯­æ³•"></a>è§¦å‘å™¨è¯­æ³•</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">trigger</span> è§¦å‘å™¨åå­—</span><br><span class="line">before<span class="operator">|</span>after</span><br><span class="line">[<span class="keyword">delete</span>][[<span class="keyword">or</span>] <span class="keyword">insert</span>][[<span class="keyword">or</span>]<span class="keyword">update</span> [<span class="keyword">of</span> åˆ—å]]</span><br><span class="line"><span class="keyword">on</span> è¡¨å</span><br><span class="line">[<span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span> ] [<span class="keyword">when</span> [æ¡ä»¶]]</span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">å˜é‡ç”³æ˜;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">PLSQLå—</span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><blockquote><p>ä½œç”¨æ˜¯æ ‡æ³¨æ­¤è§¦å‘å™¨æ˜¯è¡Œçº§è§¦å‘å™¨è¿˜æ˜¯è¯­å¥çº§è§¦å‘å™¨</p></blockquote><p>åœ¨è§¦å‘å™¨ä¸­è§¦å‘è¯­å¥ä¸ä¼ªè®°å½•å˜é‡çš„å€¼</p><table><thead><tr><th>è§¦å‘è¯­å¥</th><th>:old</th><th>:new</th></tr></thead><tbody><tr><td>insert</td><td>æ‰€æœ‰å­—æ®µéƒ½æ˜¯ç©ºçš„ï¼ˆnullï¼‰</td><td>å°†è¦æ’å…¥çš„æ•°æ®</td></tr><tr><td>update</td><td>æ›´æ–°ä»¥å‰è¯¥è¡Œçš„å€¼</td><td>æ›´æ–°åçš„å€¼</td></tr><tr><td>delete</td><td>åˆ é™¤ä»¥å‰è¯¥è¡Œçš„å€¼</td><td>æ‰€æœ‰å­—æ®µéƒ½æ˜¯ç©ºçš„ï¼ˆnullï¼‰</td></tr></tbody></table><h4 id="æ¡ˆä¾‹-1"><a href="#æ¡ˆä¾‹-1" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h4><p>1ã€å‰ç½®è§¦å‘å™¨</p><p>éœ€æ±‚ï¼šå½“ç”¨æˆ·è¾“å…¥æœ¬æœˆç´¯è®¡è¡¨æ•°åï¼Œè‡ªåŠ¨è®¡ç®—å‡ºæœ¬æœˆä½¿ç”¨æ•° ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">trigger</span> tri_account_update</span><br><span class="line">before</span><br><span class="line"><span class="keyword">update</span> <span class="keyword">of</span> num1</span><br><span class="line"><span class="keyword">on</span> t_account</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">:new.usenum:<span class="operator">=</span>:new.num1<span class="operator">-</span>:new.num0;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line">#<span class="keyword">create</span> <span class="keyword">table</span> t_account(id number,ownerid number,ownertypeid number,areaid number,<span class="keyword">year</span> <span class="type">char</span>(<span class="number">4</span>),<span class="keyword">month</span> #<span class="type">char</span>(<span class="number">2</span>),num0 number,num1 number,usenum number,meteruserid number,meterdate <span class="type">date</span>,money number(<span class="number">10</span>,<span class="number">2</span>),isfee #<span class="type">char</span>(<span class="number">1</span>),feedate <span class="type">date</span>,feeuserid number);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_account <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">1001</span>,<span class="number">1001</span>,<span class="number">1001</span>,<span class="number">2023</span>,<span class="number">06</span>,<span class="number">43543</span>,<span class="number">46456</span>,<span class="number">3000</span>,<span class="number">1001</span>,sysdate,<span class="number">3232</span>,<span class="number">0</span>,sysdate,<span class="number">1001</span>);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> t_account <span class="keyword">set</span> num1<span class="operator">=</span><span class="number">100000</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>;</span><br></pre></td></tr></table></figure><p>2ã€åç½®è§¦å‘å™¨</p><p>éœ€æ±‚ï¼šå½“ç”¨æˆ·ä¿®æ”¹äº†ä¸šä¸»ä¿¡æ¯è¡¨çš„æ•°æ®æ—¶è®°å½•ä¿®æ”¹å‰ä¸ä¿®æ”¹åçš„å€¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_owners_log</span><br><span class="line">(</span><br><span class="line">updatetime <span class="type">date</span>,</span><br><span class="line">ownerid number,</span><br><span class="line">oldname varchar2(<span class="number">30</span>),</span><br><span class="line">newname varchar2(<span class="number">30</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">trigger</span> tri_insert_owner</span><br><span class="line">after</span><br><span class="line"><span class="keyword">update</span> <span class="keyword">of</span> name</span><br><span class="line"><span class="keyword">on</span> t_owners</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_owners_log <span class="keyword">values</span>(sysdate,:old.id,:old.name,:new.name);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> t_owners <span class="keyword">set</span> name<span class="operator">=</span><span class="string">&#x27;lililili&#x27;</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1004</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_owners_log;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Oracle </tag>
            
            <tag> å…³ç³»å‹æ•°æ®åº“ </tag>
            
            <tag> è¡¨ </tag>
            
            <tag> è§†å›¾ </tag>
            
            <tag> è¡¨ç©ºé—´ </tag>
            
            <tag> åºåˆ— </tag>
            
            <tag> å‡½æ•° </tag>
            
            <tag> ç´¢å¼• </tag>
            
            <tag> è§¦å‘å™¨ </tag>
            
            <tag> å­˜å‚¨å‡½æ•° </tag>
            
            <tag> å­˜å‚¨è¿‡ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Picgo+Typora+SMMSå›¾åºŠé…ç½®</title>
      <link href="/posts/532806c/"/>
      <url>/posts/532806c/</url>
      
        <content type="html"><![CDATA[<h1 id="Picgo-Typora-SMMSå›¾åºŠé…ç½®"><a href="#Picgo-Typora-SMMSå›¾åºŠé…ç½®" class="headerlink" title="Picgo+Typora+SMMSå›¾åºŠé…ç½®"></a>Picgo+Typora+SMMSå›¾åºŠé…ç½®</h1><h1 id="ğŸ””ç¢ç¢å¿µï¼š"><a href="#ğŸ””ç¢ç¢å¿µï¼š" class="headerlink" title="ğŸ””ç¢ç¢å¿µï¼š"></a>ğŸ””ç¢ç¢å¿µï¼š</h1><p>â€‹ç”±äºæ¯æ¬¡å†™å­¦ä¹ ç¬”è®°éƒ½ä¼šæœ‰ç›¸åº”çš„å›¾ç‰‡ã€‚ä¹‹å‰æœ‰ä½¿ç”¨è¿‡<em><strong>é˜¿é‡Œäº‘çš„OSS</strong></em>ã€‚ä½¿ç”¨èµ·æ¥ä¹Ÿæ˜¯ç›¸å½“ä¸é”™çš„ï¼Œä½†æ˜¯OSSæ˜¯æ”¶è´¹çš„ã€‚å…¶<em><strong>ä»˜è´¹æ¨¡å¼</strong></em>å¯ä»¥åŒ…æœˆï¼Œä¹Ÿå¯ä»¥æŒ‰è®¿é—®æµé‡æ¥ä»˜è´¹ï¼Œè™½ç„¶ä¾¿å®œï¼Œä½†æ˜¯å¯¹äºè¿˜åœ¨å­¦ä¹ çš„å°ä¼™ä¼´æ¥è¯´ä¹Ÿæ˜¯æ²¡å¿…è¦çš„ã€‚ä½¿ç”¨<em><strong>å…è´¹çš„å›¾åºŠ</strong></em>ä¹Ÿå¯ä»¥å®ç°ç›¸åŒçš„åŠŸèƒ½ã€‚æ¯”å¦‚sm.mså›¾åºŠï¼Œæœ‰å…è´¹ç‰ˆæœ¬å’Œä»˜è´¹ç‰ˆæœ¬ï¼Œå…è´¹å®¹é‡æ˜¯50Gã€‚è®¿é—®é€Ÿåº¦æ¥è¯´ä¹Ÿè¿˜ç®—æ˜¯OKã€‚æ‰€ä»¥æœ¬æ¬¡é…ç½®çš„å›¾åºŠé€‰æ‹©sm.msã€‚</p><p>â€‹å†™è¿™ç¯‡é…ç½®æ•™ç¨‹çš„<em><strong>ç›®çš„</strong></em>æ˜¯ï¼Œå°†è‡ªå·±ä»¥å‰çš„å­¦ä¹ åšä¸€ä¸ª<em><strong>è®°å½•</strong></em>ï¼Œå°±æ˜¯æƒ³å¸®åŠ©ä¸€ä¸‹<em><strong>æ›´å¤šçš„</strong></em>ï¼Œæƒ³è¦å®ç°ç›¸åŒåŠŸèƒ½çš„æœ‹å‹ã€‚å…¶æ¬¡ä¹Ÿæ˜¯å¸®åŠ©ä¸€ä¸‹ç‰¹åˆ«å¥½çš„æœ‹å‹é…ç½®å›¾åºŠã€‚</p><h2 id="ä¸€ã€Picgo"><a href="#ä¸€ã€Picgo" class="headerlink" title="ä¸€ã€Picgo"></a>ä¸€ã€Picgo</h2><h3 id="Picgoç®€ä»‹ï¼š"><a href="#Picgoç®€ä»‹ï¼š" class="headerlink" title="Picgoç®€ä»‹ï¼š"></a>Picgoç®€ä»‹ï¼š</h3><ol><li><p>åº”ç”¨æ¦‚è¿°ï¼šä¸€ä¸ªç”¨äºå¿«é€Ÿä¸Šä¼ å›¾ç‰‡å¹¶è·å–å›¾ç‰‡ URL é“¾æ¥çš„å·¥å…·ã€‚</p></li><li><p>picgoæœ¬èº«æ”¯æŒï¼š<code>ä¸ƒç‰›å›¾åºŠ</code> v1.0ã€<code>è…¾è®¯äº‘ COS v4\v5 ç‰ˆæœ¬</code> v1.1 &amp; v1.5.0ã€<code>åˆæ‹äº‘</code> v1.2.0ã€<code>GitHub</code> v1.5.0ã€<code>SM.MS V2</code> v2.3.0-beta.0ã€<code>é˜¿é‡Œäº‘ OSS</code> v1.6.0ã€<code>Imgur</code> v1.6.0ç­‰ã€‚è¿˜å¯ä»¥é€šè¿‡æ’ä»¶æ‰©å±•å…¶ä»–å›¾åºŠã€‚</p></li><li><p>åº”ç”¨ç•Œé¢ï¼š</p><p><img src="https://s2.loli.net/2024/10/20/RAOhWi32Gw496os.png" alt="image-20241020140658220"></p></li></ol><h3 id="Picgoå®‰è£…é…ç½®ï¼š"><a href="#Picgoå®‰è£…é…ç½®ï¼š" class="headerlink" title="Picgoå®‰è£…é…ç½®ï¼š"></a>Picgoå®‰è£…é…ç½®ï¼š</h3><ol><li><p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/Molunerfinn/PicGo%EF%BC%8C%E6%88%96%E8%80%85%E9%80%89%E6%8B%A9%E5%85%B6%E4%BB%96%E9%95%9C%E5%83%8F%E6%BA%90%E4%B8%8B%E8%BD%BD%E4%B9%9F%E5%8F%AF%E3%80%82%E4%B8%8B%E8%BD%BD%E5%B7%B2%E7%BB%8F%E6%89%93%E5%8C%85%E5%A5%BD%E7%9A%84exe%E7%A8%8B%E5%BA%8F%EF%BC%8C%E5%AE%89%E8%A3%85%E7%9B%B4%E6%8E%A5%E7%82%B9%E5%87%BBexe%E5%8F%AF%E6%89%A7%E8%A1%8C%E7%A8%8B%E5%BA%8F%EF%BC%8C%E7%82%B9%E5%87%BB%E4%B8%8B%E4%B8%80%E6%AD%A5%E5%8D%B3%E5%8F%AF%E3%80%82">https://github.com/Molunerfinn/PicGoï¼Œæˆ–è€…é€‰æ‹©å…¶ä»–é•œåƒæºä¸‹è½½ä¹Ÿå¯ã€‚ä¸‹è½½å·²ç»æ‰“åŒ…å¥½çš„exeç¨‹åºï¼Œå®‰è£…ç›´æ¥ç‚¹å‡»exeå¯æ‰§è¡Œç¨‹åºï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥å³å¯ã€‚</a></p></li><li><p>ä¸‹è½½å®Œæˆåã€‚é…ç½®sm.mså›¾åºŠã€‚é…ç½®sm.mså›¾åºŠå‰éœ€è¦æ³¨å†Œå›¾åºŠçš„è´¦æˆ·ã€‚<a href="https://smms.app/">å›¾åºŠåœ°å€</a><a href="https://smms.app/%E3%80%82">https://smms.app/ã€‚</a></p><blockquote><p>è¿™é‡Œä½¿ç”¨picgo-plugin-smms-useræ’ä»¶ï¼Œæ’ä»¶ä¸‹è½½åœ°å€<a href="https://github.com/xlzy520/picgo-plugin-smms-user%E3%80%82%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8git%E6%88%96%E8%80%85%E7%9B%B4%E6%8E%A5%E7%82%B9%E5%87%BB%E4%B8%8B%E8%BD%BD%E5%8E%8B%E7%BC%A9%E5%8C%85%E3%80%82">https://github.com/xlzy520/picgo-plugin-smms-userã€‚å¯ä»¥ä½¿ç”¨gitæˆ–è€…ç›´æ¥ç‚¹å‡»ä¸‹è½½å‹ç¼©åŒ…ã€‚</a></p><ul><li><p>åœ¨çº¿å®‰è£…ç›´æ¥åœ¨æ’ä»¶è®¾ç½®ç•Œé¢æœç´¢ï¼š<strong>smms-user</strong>å®‰è£…ï¼Œå®‰è£…å®Œæˆåé‡å¯åº”ç”¨</p></li><li><p>ç¦»çº¿å®‰è£…ï¼Œä¸‹è½½æ’ä»¶åŒ…ï¼Œå°†æ’ä»¶åŒ…ç§»åŠ¨åˆ°picgoçš„å®‰è£…ç›®å½•ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ã€‚è¿™é‡Œä½¿ç”¨æœ¬åœ°æ’ä»¶å¯¼å…¥çš„æ–¹å¼ä½¿ç”¨ã€‚</p></li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install ./picgo-plugin-smms-user</span><br></pre></td></tr></table></figure></blockquote><p><img src="https://s2.loli.net/2024/10/20/qUmz5ZehK4OaEvS.png" alt="image-20241020142806786"></p></li><li><p>å®‰è£…ä½¿ç”¨å¯¼å…¥æœ¬åœ°æ’ä»¶çš„æ–¹å¼å¦‚ä¸Šå›¾ã€‚å¯¼å…¥åå°±ä¼šåœ¨ã€Šæ’ä»¶è®¾ç½®ã€‹èœå•æ˜¾ç¤ºã€‚</p></li><li><p>ç‚¹å‡»æ’ä»¶çš„è®¾ç½®æŒ‰é’®ï¼Œé€‰æ‹©æœ€åä¸€é¡¹ã€Šé…ç½®uploader-smms-userã€‹é…ç½®smms-userçš„authå€¼ï¼Œauthé€šè¿‡<a href="https://smms.app/">smmså®˜ç½‘</a>çš„API-Tokenè·å–å³å¯ã€‚</p><p><img src="https://s2.loli.net/2024/10/20/gvm97be8cflxLRW.png" alt="image-20241020145626017"></p></li><li><p>é…ç½®å®Œæˆååœ¨ã€Šä¸Šä¼ åŒºã€‹å›¾ç‰‡ä¸Šä¼ å‹¾é€‰SM.MS-ç™»å½•ç”¨æˆ·å°±å®Œæˆäº†picgoå’Œsm.msçš„é…ç½®ã€‚å’Œä¸Šè¿°picgoç®€ä»‹åº”ç”¨å›¾ç‰‡ä½ç½®ä¸€è‡´ã€‚å°†å›¾ç‰‡æ‹–å…¥ç›¸åº”ä½ç½®å°±å¯ä»¥ç›´æ¥å°†å›¾ç‰‡ä¸Šä¼ åˆ°sm.mså›¾åºŠä¸Šäº†ã€‚ç™»å½•<a href="https://smms.app/%E5%8D%B3%E5%8F%AF%E6%9F%A5%E7%9C%8B%E3%80%82">https://smms.app/å³å¯æŸ¥çœ‹ã€‚</a></p></li><li><p>å¯¹äºpicgoçš„å…¶ä»–é…ç½®å¯ä»¥åœ¨è®¾ç½®æ¨¡å—æŸ¥çœ‹ï¼Œå»ºè®®å¼€å¯ä¸Šä¼ å‰é‡å‘½ååŠŸèƒ½ã€‚æ­¤é¡¹åŠŸèƒ½æ–¹ä¾¿ä»¥åç®¡ç†sm.mså›¾åºŠçš„å›¾ç‰‡ã€‚</p></li></ol><h2 id="äºŒã€Typora"><a href="#äºŒã€Typora" class="headerlink" title="äºŒã€Typora"></a>äºŒã€Typora</h2><h3 id="åŠŸèƒ½éœ€æ±‚ï¼š"><a href="#åŠŸèƒ½éœ€æ±‚ï¼š" class="headerlink" title="åŠŸèƒ½éœ€æ±‚ï¼š"></a>åŠŸèƒ½éœ€æ±‚ï¼š</h3><blockquote><p>å°†typoraç¬”è®°ä¸­çš„å›¾ç‰‡ï¼Œåˆ©ç”¨picgoå·¥å…·ç›´æ¥ä¸Šä¼ åˆ°sm.mså›¾åºŠä¸Šå¹¶è¿”å›å›¾ç‰‡åœ°å€ä¾›typoraç¬”è®°æ‰€ä½¿ç”¨ã€‚</p></blockquote><h3 id="Typoraé…ç½®ï¼š"><a href="#Typoraé…ç½®ï¼š" class="headerlink" title="Typoraé…ç½®ï¼š"></a>Typoraé…ç½®ï¼š</h3><p>Typoraæœ¬è½¯ä»¶ä¸å†åšä»‹ç»ï¼Œç›´æ¥ç»™å‡ºé…ç½®æ­¥éª¤ã€‚</p><ol><li>ç‚¹å‡»èœå•æ çš„ã€Šæ–‡ä»¶ã€‹é€‰é¡¹ã€‚</li><li>é€‰æ‹©ã€Šåå¥½è®¾ç½®ã€‹ã€‚</li><li>é€‰æ‹©ã€Šå›¾åƒè®¾ç½®ã€‹ï¼Œæ’å…¥å›¾ç‰‡æ—¶-&gt;<em><strong>ä¸Šä¼ å›¾ç‰‡ã€‚</strong></em></li><li>å‹¾é€‰â˜‘ï¸å¯¹æœ¬åœ°ä½ç½®çš„å›¾ç‰‡åº”ç”¨ä¸Šè¿°è§„åˆ™ã€‚</li><li>ä¸Šä¼ æœåŠ¡é€‰æ‹©<em><strong>Picgo(app)</strong></em></li><li>picgoçš„è·¯å¾„é€‰æ‹©picgoçš„å®‰è£…è·¯å¾„ä¸­çš„picgo.exeå¯æ‰§è¡Œç¨‹åºå³å¯å¦‚ä¸‹å›¾ã€‚</li></ol><p><img src="https://s2.loli.net/2024/10/20/A13RwKLq8Jfxmk9.png" alt="image-20241020151951062"></p><p>å®Œæˆä»¥ä¸Šçš„é…ç½®ï¼Œä½ çš„typoraå°±å®ç°äº†æ’å…¥å›¾ç‰‡è‡ªåŠ¨ä¸Šä¼ åˆ°smmsçš„å›¾åºŠçš„åŠŸèƒ½å•¦ã€‚ğŸ‰ğŸ‰ğŸ‰</p><h2 id="ä¸‰ã€æ‰©å±•"><a href="#ä¸‰ã€æ‰©å±•" class="headerlink" title="ä¸‰ã€æ‰©å±•"></a>ä¸‰ã€æ‰©å±•</h2><p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–çš„å›¾åºŠæˆ–è€…æ˜¯äº‘å­˜å‚¨çš„æœåŠ¡ã€‚å¤§éƒ¨åˆ†çš„äº‘å­˜å‚¨æœåŠ¡éƒ½æ˜¯æ”¶è´¹çš„ï¼Œæ¯”ä¾‹***<a href="https://www.aliyun.com/product/oss">é˜¿é‡Œäº‘OSS</a><em><strong>ï¼Œ</strong></em><a href="https://cloud.tencent.com/product/cos">è…¾è®¯äº‘COS</a><em><strong>ï¼Œ</strong></em><a href="https://www.qiniu.com/products/kodo">ä¸ƒç‰›äº‘</a><em><strong>ï¼Œ<a href="https://www.upyun.com/"><em><strong>åˆæ‹äº‘</strong></em></a>ç­‰ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„ç»æµæƒ…å†µé€‰æ‹©ä¸€æ¬¾äº‘å­˜å‚¨æœåŠ¡ï¼Œå½“ç„¶ç”¨å…è´¹çš„ä¸æ˜¯æ›´å¥½å—ã€‚æ¯•ç«Ÿç™½å«–çš„å°±æ˜¯é¦™ï¼Œä½†æ˜¯ä¾¿å®œçš„å…è´¹çš„å¯èƒ½ä¼šé¢ä¸´å°±æ˜¯</strong></em>æœåŠ¡æä¾›å•†è·‘è·¯***äº†ï¼Œå›¾ç‰‡å°±å¯èƒ½æ‰¾ä¸åˆ°ã€‚é€‰æ‹©å¤§å‚çš„è™½è¯´ä»˜è´¹ï¼Œä¹Ÿä¸ç®—å¤ªè´µä¸æ˜¯ã€‚è‡³å°‘ä¸å¤ªå¯èƒ½å‡ºç°è·‘è·¯çš„æƒ…å†µã€‚</p><p>è¿™é‡Œä»¥<a href="https://www.upyun.com/">åˆæ‹äº‘</a>ä¸ºä¾‹ã€‚</p><p>è¿™é‡Œæ²¡æœ‰å¹¿å‘Šï¼æ²¡æœ‰å¹¿å‘Šï¼æ²¡æœ‰å¹¿å‘Šï¼é‡è¦çš„äº‹æƒ…è¯´ä¸‰éã€‚</p><h3 id="åˆæ‹äº‘"><a href="#åˆæ‹äº‘" class="headerlink" title="åˆæ‹äº‘"></a>åˆæ‹äº‘</h3><ol><li><p>ç™»å½•<a href="https://www.upyun.com/">åˆæ‹äº‘å®˜æ–¹ç½‘ç«™</a>ï¼Œæ³¨å†Œè´¦å·ã€‚</p></li><li><p>è¿›å…¥åˆæ‹äº‘æ§åˆ¶å°ï¼Œåœ¨äº‘æœåŠ¡åˆ—è¡¨ï¼Œåˆ›å»ºæœåŠ¡ã€‚æœåŠ¡åç§°å°±æ˜¯bucketã€‚åœ¨åç»­picgoé…ç½®ä¸­ä¼šä½¿ç”¨åˆ°ï¼Œåº”ç”¨åœºæ™¯-å¡«å†™ç½‘é¡µå›¾ç‰‡ï¼Œå­˜å‚¨ç±»å‹-é€‰æ‹©æ ‡å‡†ç±»å‹ï¼Œè¿™é‡Œæˆæƒè´¦å·å¯ä»¥å…ˆä¸æˆæƒã€‚ä¹Ÿå¯ä»¥ç›´æ¥æˆæƒå·²æœ‰çš„æ“ä½œå‘˜ï¼Œæˆ–è€…æ–°å»ºæˆæƒæ“ä½œå‘˜ã€‚ç„¶åç‚¹å‡»ä¸‹æ–¹çš„åˆ›å»ºã€‚æœåŠ¡åˆ›å»ºå®Œæˆåï¼Œç‚¹å‡»è¿›å…¥é…ç½®ã€‚</p><p><img src="https://s2.loli.net/2024/10/20/kdBGrFfJsajo3qX.png" alt="image-20241020162956667"></p></li><li><p>åœ¨åŠŸèƒ½é…ç½®çš„åŸŸåç®¡ç†æ¨¡å—ï¼ŒåŸŸååŠ é€Ÿæ¨¡å—ç»‘å®šåŸŸåã€‚è¿™é‡Œæ³¨æ„ï¼Œåœ¨ç»‘å®šåŸŸåæ—¶ï¼ŒåŸŸåéœ€è¦<em><strong>å¤‡æ¡ˆ</strong></em>ï¼Œä¸ç„¶<em><strong>å®¡æ ¸ä¸é€šè¿‡</strong></em>ï¼Œç„¶åå»åŸŸåæä¾›å•†ç½‘ç«™å¢åŠ åŸŸåè§£æè®°å½•ã€‚è¿™é‡Œä»¥<em><strong>é˜¿é‡Œäº‘ä¸ºä¾‹</strong></em>ã€‚</p><ul><li><p>åœ¨åŸŸåè§£ææ§åˆ¶å°ï¼Œç‚¹å‡»å·²æœ‰çš„åŸŸåè¿›å…¥è§£æè®¾ç½®ã€‚</p></li><li><p>ç‚¹å‡»æ·»åŠ è®°å½•ï¼Œè®°å½•ç±»å‹é€‰æ‹©***<a href="https://www.aliyun.com/">CNAME</a>***ã€‚CNAMEçš„æ„æ€æ˜¯ä»ä¸€ä¸ªåŸŸåæŒ‡å‘å¦ä¸€ä¸ªåŸŸåï¼Œä¸»æœºè®°å½•å€¼å¯ä»¥éšæ„å¡«å†™ï¼Œå¦‚ä¸‹å›¾è¡¨ç¤ºçš„å†…å®¹ã€‚ä¸€èˆ¬æ¥è¯´è®¾ç½®äºŒçº§åŸŸåæ›´åŠ åˆé€‚ã€‚</p></li><li><p>è§£æè¯·æ±‚æ¥æºè®¾ç½®é»˜è®¤å³å¯ã€‚</p><p>è®°å½•å€¼å¡«å†™åœ¨åˆæ‹äº‘äº‘å­˜å‚¨æœåŠ¡çš„CNAMEå°±å¯ä»¥äº†ã€‚è¯¥å€¼çš„æŸ¥æ‰¾æ–¹å¼ï¼Œåˆæ‹äº‘æ§åˆ¶å°-&gt;äº‘å­˜å‚¨æœåŠ¡-&gt;æœåŠ¡ç®¡ç† äº‘å­˜å‚¨ï¼ˆåœ¨è¯¥é¡µé¢ä¸­ç‚¹å‡»æœåŠ¡åç§°ï¼‰-&gt;åŸŸåç®¡ç†é¡µé¢çš„CNAMEã€‚</p></li></ul><p><img src="https://s2.loli.net/2024/10/20/gQHZYl8sThUXB1v.png" alt="image-20241020165402733"></p></li><li><p>å­˜å‚¨ç®¡ç†æ¨¡å—çš„<em><strong>æ“ä½œå‘˜æˆæƒ</strong></em>ã€‚ç‚¹å‡»æˆæƒæŒ‰é’®ï¼Œæœ‰æ“ä½œå‘˜å°±ç›´æ¥å‹¾é€‰â˜‘ï¸ï¼Œæ²¡æœ‰æ“ä½œå‘˜çš„ç‚¹å‡»æ–°å»ºæˆæƒæ“ä½œå‘˜ã€‚è¾“å…¥æ“ä½œå‘˜åç§°ï¼Œå¯†ç é¡¹åªèƒ½ç‚¹å‡»ç³»ç»Ÿç”Ÿæˆã€‚ç”Ÿæˆå®Œæˆåå¤åˆ¶è¯¥å¯†ç ï¼Œä¿å­˜èµ·æ¥åç»­åœ¨é…ç½®picgoä¸­ä½¿ç”¨ã€‚ç„¶åæƒé™å‹¾é€‰â˜‘ï¸å¯è¯»å–ï¼Œå¯å†™å…¥ï¼Œå¯åˆ é™¤ã€‚æ ¹æ®å®é™…ç”¨é€”å‹¾é€‰æƒé™ã€‚ç‚¹å‡»åˆ›å»ºå³å¯ï¼Œå¦‚ä¸‹å›¾ã€‚</p><p><img src="https://s2.loli.net/2024/10/20/UVnLzu2QtksfFid.png" alt="image-20241020164210706"></p></li><li><p>å®Œæˆä¸Šè¿°æ­¥éª¤ï¼Œä½ çš„åˆæ‹äº‘äº‘å­˜å‚¨æœåŠ¡å°±åˆ›å»ºå¥½äº†ã€‚ğŸ‰ğŸ‰ğŸ‰</p></li></ol><h3 id="Picgoé…ç½®"><a href="#Picgoé…ç½®" class="headerlink" title="Picgoé…ç½®"></a>Picgoé…ç½®</h3><ol><li>åœ¨picgoçš„ç•Œé¢æ‰¾åˆ°å›¾åºŠè®¾ç½®ã€‚åœ¨å›¾åºŠè®¾ç½®ä¸­é€‰æ‹©<em><strong>åˆæ‹äº‘</strong></em>é…ç½®ã€‚</li><li>åœ¨åˆæ‹äº‘çš„è®¾ç½®ç•Œé¢å¡«å†™ç›¸å…³çš„é…ç½®å³å¯ã€‚</li><li>è®¾å®šBucket,è¿™é‡Œçš„<em><strong>bucket</strong></em>å°±æ˜¯å‰é¢åˆ›å»ºçš„<em><strong>äº‘å­˜å‚¨æœåŠ¡çš„åç§°ã€‚</strong></em></li><li>è®¾å®šæ“ä½œå‘˜å°±æ˜¯ä½ ç»™äº‘æœåŠ¡æˆæƒçš„æ“ä½œäººåç§°</li><li>è®¾å®š<em><strong>æ“ä½œå‘˜å¯†ç </strong></em>ï¼Œè¿™ä¸ªå¯†ç å°±æ˜¯åœ¨åˆ›å»ºæ“ä½œå‘˜çš„æ—¶å€™ç”Ÿæˆçš„å¯†ç ã€‚</li><li>è®¾å®šåŠ é€ŸåŸŸåï¼Œè¯¥é¡¹å€¼æ˜¯åœ¨åˆæ‹äº‘æ§åˆ¶å°-&gt;äº‘å­˜å‚¨æœåŠ¡-&gt;æœåŠ¡ç®¡ç† äº‘å­˜å‚¨ï¼ˆåœ¨è¯¥é¡µé¢ä¸­ç‚¹å‡»æœåŠ¡åç§°ï¼‰-&gt;åŸŸåç®¡ç†é¡µé¢çš„åŠ é€ŸåŸŸå</li><li>è®¾å®šç½‘å€åç¼€ï¼ˆé€‰å¡«ï¼‰ï¼Œå¯ä»¥ä¸å¡«ä¸å½±å“ä½¿ç”¨ã€‚</li><li>è®¾å®š<em><strong>å­˜å‚¨è·¯å¾„</strong></em>ï¼Œå°±æ˜¯ä½ åœ¨bucket(äº‘å­˜å‚¨æœåŠ¡)ä¸­çš„<em><strong>æ–‡ä»¶å¤¹è·¯å¾„</strong></em>ã€‚ä¹Ÿå¯ä»¥ä¸å¡«ï¼Œè¿™æ ·å›¾ç‰‡ä¼šä¸Šä¼ åˆ°ä½ çš„bucketçš„æ ¹ç›®å½•ä¸‹ã€‚</li><li>å®Œæˆä»¥ä¸Šè®¾ç½®ä»¥åï¼Œç‚¹å‡»ä¿å­˜ï¼Œåœ¨ä¸Šä¼ åŒºåŸŸé€‰æ‹©åˆæ‹äº‘ã€‚å°±å¯ä»¥å®Œæˆå›¾ç‰‡é€šè¿‡picgoä¸Šä¼ åˆæ‹äº‘äº‘å­˜å‚¨äº†ã€‚</li><li>è¿™æ—¶åœ¨typoraå†™æ–‡ç« å›¾ç‰‡åŒæ ·ä¹Ÿä¼šä¸Šä¼ åˆæ‹äº‘ã€‚</li></ol><p>å…¶ä»–äº‘å­˜å‚¨æœåŠ¡å’Œå›¾åºŠçš„é…ç½®åŸºæœ¬ä¸Šå¤§è‡´ç›¸åŒã€‚è¿™é‡Œå°±ä¸å±•å¼€æè¿°äº†ã€‚åç»­å¯èƒ½ä¼šæ·»åŠ å…¶ä»–çš„å…è´¹çš„å›¾åºŠé…ç½®çš„å†…å®¹ã€‚</p><p>å®Œç»“</p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
          <category> å›¾åºŠ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
            <tag> å›¾åºŠé…ç½® </tag>
            
            <tag> Picgo </tag>
            
            <tag> äº‘å­˜å‚¨æœåŠ¡ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
